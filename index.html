<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ Ø§Ù„Ù…ØªØ·ÙˆØ±</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #1565c0;
      --secondary-color: #0d47a1;
      --accent-color: #ff9800;
      --light-color: #e3f2fd;
      --success-color: #4caf50;
      --error-color: #f44336;
      --warning-color: #ff9800;
      --dark-blue: #0d47a1;
      --light-blue: #e3f2fd;
      --purple: #7b1fa2;
      --pink: #c2185b;
      --teal: #00796b;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Tahoma', 'Arial', sans-serif;
      background: linear-gradient(135deg, #f3f3f3 0%, #e8f4f8 100%);
      color: #222;
      line-height: 1.6;
      min-height: 100vh;
    }
    
    header {
      background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: white;
      padding: 12px 15px;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .header-icon {
      font-size: 28px;
    }
    
    .container {
      padding: 15px;
      max-width: 1200px;
      margin: auto;
    }
    
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 18px;
      margin-bottom: 18px;
      transition: transform 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-3px);
    }
    
    .card-title {
      color: var(--primary-color);
      margin-top: 0;
      border-bottom: 2px solid var(--light-color);
      padding-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .card-title i {
      color: var(--accent-color);
    }
    
    button {
      padding: 10px 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      margin: 6px;
      font-weight: bold;
      transition: all 0.3s ease;
      font-family: inherit;
    }
    
    .btn-primary {
      background: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background: var(--secondary-color);
      transform: scale(1.05);
    }
    
    .btn-secondary {
      background: var(--accent-color);
      color: white;
    }
    
    .btn-secondary:hover {
      background: #e68900;
      transform: scale(1.05);
    }
    
    .btn-success {
      background: var(--success-color);
      color: white;
    }
    
    .btn-success:hover {
      background: #3d8b40;
      transform: scale(1.05);
    }
    
    .btn-warning {
      background: var(--warning-color);
      color: white;
    }
    
    .btn-warning:hover {
      background: #e68900;
      transform: scale(1.05);
    }
    
    .btn-danger {
      background: var(--error-color);
      color: white;
    }
    
    .btn-danger:hover {
      background: #d32f2f;
      transform: scale(1.05);
    }
    
    .btn-purple {
      background: var(--purple);
      color: white;
    }
    
    .btn-purple:hover {
      background: #6a1b9a;
      transform: scale(1.05);
    }
    
    input, textarea, select {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin: 6px 0;
      width: 100%;
      box-sizing: border-box;
      font-size: 16px;
      transition: border-color 0.3s;
      font-family: inherit;
    }
    
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(21, 101, 192, 0.2);
    }
    
    #output {
      background: var(--light-color);
      padding: 12px;
      border-radius: 8px;
      margin-top: 12px;
      min-height: 50px;
      border-right: 4px solid var(--primary-color);
    }
    
    .progress-bar {
      height: 8px;
      background: #ddd;
      border-radius: 4px;
      margin: 10px 0;
      overflow: hidden;
    }
    
    .progress {
      height: 100%;
      background: var(--accent-color);
      width: 0%;
      transition: width 0.5s ease;
    }
    
    .lesson-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      margin-bottom: 8px;
      background: #f9f9f9;
      border-radius: 8px;
      border-right: 3px solid var(--primary-color);
    }
    
    .lesson-item:hover {
      background: #f0f7ff;
    }
    
    .word-container {
      flex-grow: 1;
    }
    
    .word-en {
      font-weight: bold;
      font-size: 18px;
      color: var(--secondary-color);
    }
    
    .word-ar {
      color: #555;
    }
    
    .word-category {
      display: inline-block;
      background: var(--light-color);
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      margin-right: 5px;
      color: var(--primary-color);
    }
    
    .btn-icon {
      background: transparent;
      border: none;
      padding: 8px;
      margin: 0 3px;
      border-radius: 50%;
      font-size: 18px;
    }
    
    .btn-icon:hover {
      background: rgba(0, 0, 0, 0.1);
    }
    
    .score-display {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      color: var(--primary-color);
      margin: 15px 0;
    }
    
    .game-option {
      background: white;
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin: 8px 0;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .game-option:hover {
      border-color: var(--accent-color);
      background: #fff8e1;
    }
    
    .game-option.correct {
      border-color: var(--success-color);
      background: #e8f5e9;
    }
    
    .game-option.wrong {
      border-color: var(--error-color);
      background: #ffebee;
    }
    
    .stats {
      display: flex;
      justify-content: space-between;
      background: #f5f5f5;
      padding: 10px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    .stat-item {
      text-align: center;
      flex: 1;
    }
    
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary-color);
    }
    
    .stat-label {
      font-size: 14px;
      color: #666;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .dashboard-card {
      background: white;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
      transition: transform 0.3s;
    }
    
    .dashboard-card:hover {
      transform: translateY(-5px);
    }
    
    .tab-buttons {
      display: flex;
      border-bottom: 2px solid #eee;
      margin-bottom: 15px;
      flex-wrap: wrap;
      overflow-x: auto;
    }
    
    .tab-btn {
      padding: 10px 15px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-weight: bold;
      color: #666;
      white-space: nowrap;
      flex-shrink: 0;
    }
    
    .tab-btn.active {
      color: var(--primary-color);
      border-bottom-color: var(--primary-color);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .unit-card {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-right: 4px solid var(--primary-color);
    }
    
    .unit-title {
      color: var(--primary-color);
      margin-top: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .unit-lessons {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    
    .lesson-card {
      background: #f9f9f9;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .lesson-card:hover {
      background: #e3f2fd;
      transform: scale(1.02);
    }
    
    .hint {
      background: #fff8e1;
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
      border-right: 3px solid var(--accent-color);
    }
    
    .achievement-badge {
      display: inline-block;
      background: linear-gradient(45deg, #FFD700, #FFA500);
      color: #333;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
      margin: 2px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .notification {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: var(--success-color);
      color: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 1000;
      animation: slideIn 0.5s ease;
      max-width: 300px;
    }
    
    @keyframes slideIn {
      from { transform: translateX(-100%); }
      to { transform: translateX(0); }
    }
    
    .close-notification {
      float: left;
      background: transparent;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
    }
    
    .game-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin: 20px 0;
    }
    
    .match-item {
      padding: 15px;
      margin: 10px 0;
      background: #f5f5f5;
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s;
    }
    
    .match-item:hover {
      background: #e3f2fd;
      transform: scale(1.02);
    }
    
    .match-item.selected {
      background: var(--accent-color);
      color: white;
    }
    
    .match-item.matched {
      background: var(--success-color);
      color: white;
    }
    
    .conversation-item {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .conversation-en {
      color: var(--primary-color);
      font-weight: bold;
      margin-bottom: 10px;
      border-right: 3px solid var(--primary-color);
      padding-right: 10px;
    }
    
    .conversation-ar {
      color: #555;
      border-right: 3px solid var(--accent-color);
      padding-right: 10px;
    }
    
    .grammar-rule {
      background: #e8f5e9;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      border-right: 4px solid var(--success-color);
    }
    
    .example {
      background: #f3e5f5;
      padding: 10px;
      border-radius: 6px;
      margin: 8px 0;
      font-style: italic;
    }
    
    .recording {
      background-color: #ff4444;
      color: white;
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.7; }
      100% { opacity: 1; }
    }
    
    .pronunciation-feedback {
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      text-align: center;
      font-weight: bold;
    }
    
    .pronunciation-good {
      background-color: #e8f5e9;
      color: #2e7d32;
      border-right: 4px solid #2e7d32;
    }
    
    .pronunciation-needs-work {
      background-color: #fff3e0;
      color: #ef6c00;
      border-right: 4px solid #ef6c00;
    }
    
    .voice-settings {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
    }
    
    .voice-controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin: 10px 0;
    }
    
    .voice-slider {
      width: 100%;
      margin: 10px 0;
    }
    
    .speech-status {
      text-align: center;
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
      background: #e3f2fd;
    }
    
    .ipa-transcription {
      font-family: 'Courier New', monospace;
      background: #f5f5f5;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 14px;
      margin: 5px 0;
    }
    
    .phonetic-section {
      background: #f0f8ff;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      border-right: 4px solid #4a90e2;
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ© */
    .avatar-container {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: white;
      border-radius: 10px;
      margin: 15px 0;
    }
    
    .avatar-image {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(45deg, #4a90e2, #7b1fa2);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 40px;
    }
    
    .avatar-info {
      flex-grow: 1;
    }
    
    .avatar-level {
      display: inline-block;
      background: var(--accent-color);
      color: white;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 14px;
    }
    
    .avatar-items {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    
    .avatar-item {
      padding: 5px 10px;
      background: #f0f0f0;
      border-radius: 6px;
      font-size: 12px;
    }
    
    .song-player {
      background: linear-gradient(45deg, #333, #555);
      color: white;
      padding: 20px;
      border-radius: 10px;
      margin: 15px 0;
    }
    
    .lyrics-line {
      margin: 10px 0;
      padding: 8px;
      border-radius: 5px;
      transition: background 0.3s;
    }
    
    .lyrics-line.highlight {
      background: rgba(255, 255, 255, 0.2);
      color: #ffeb3b;
    }
    
    .lyrics-word {
      cursor: pointer;
      padding: 2px 4px;
      border-radius: 3px;
      transition: background 0.3s;
    }
    
    .lyrics-word:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .parent-dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .parent-card {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .profession-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .profession-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    .profession-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .profession-icon {
      font-size: 40px;
      margin-bottom: 10px;
      color: var(--primary-color);
    }
    
    .smart-teacher-feedback {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      border-right: 4px solid var(--purple);
    }
    
    .mistake-item {
      background: #ffebee;
      padding: 10px;
      border-radius: 6px;
      margin: 8px 0;
      border-right: 3px solid var(--error-color);
    }
    
    .ai-assistant {
      background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
    }
    
    .ai-message {
      background: rgba(255, 255, 255, 0.1);
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
    }
    
    .challenge-timer {
      font-size: 48px;
      font-weight: bold;
      text-align: center;
      color: var(--error-color);
      margin: 20px 0;
    }
    
    .challenge-word {
      font-size: 32px;
      text-align: center;
      color: var(--primary-color);
      margin: 20px 0;
      font-weight: bold;
    }
    
    .story-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .story-paragraph {
      margin: 15px 0;
      padding: 10px;
      border-right: 3px solid var(--teal);
    }
    
    .story-choice {
      display: flex;
      gap: 10px;
      margin: 15px 0;
    }
    
    .choice-btn {
      flex: 1;
      padding: 12px;
      text-align: center;
      background: #f0f0f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .choice-btn:hover {
      background: var(--primary-color);
      color: white;
    }
    
    .achievement-wall {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .achievement-card {
      background: white;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    .achievement-icon {
      font-size: 30px;
      color: #FFD700;
      margin-bottom: 10px;
    }
    
    .locked {
      opacity: 0.5;
      filter: grayscale(100%);
    }
    
    .friends-leaderboard {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .leaderboard-item {
      display: flex;
      align-items: center;
      padding: 10px;
      margin: 8px 0;
      background: #f9f9f9;
      border-radius: 8px;
    }
    
    .leaderboard-rank {
      width: 30px;
      height: 30px;
      background: var(--primary-color);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 10px;
    }
    
    .daily-life-categories {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .life-category {
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    .life-category:hover {
      transform: scale(1.05);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .iraqi-translator {
      background: linear-gradient(45deg, #8e2de2, #4a00e0);
      color: white;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }
    
    .translation-result {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .lesson-item {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .unit-lessons {
        grid-template-columns: 1fr;
      }
      
      .tab-buttons {
        overflow-x: auto;
      }
      
      .tab-btn {
        padding: 8px 12px;
        font-size: 14px;
      }
      
      .voice-controls {
        flex-direction: column;
      }
      
      .profession-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .daily-life-categories {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .story-choice {
        flex-direction: column;
      }
      
      .avatar-container {
        flex-direction: column;
        text-align: center;
      }
    }
    
    @media (max-width: 480px) {
      .profession-grid {
        grid-template-columns: 1fr;
      }
      
      .daily-life-categories {
        grid-template-columns: 1fr;
      }
      
      .achievement-wall {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <header>
    <i class="fas fa-graduation-cap header-icon"></i>
    <span>Ù…Ù†Ù‡Ø¬ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ± - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª</span>
  </header>
  
  <div class="container">
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
    <div class="dashboard">
      <div class="dashboard-card">
        <i class="fas fa-book" style="font-size: 36px; color: var(--primary-color); margin-bottom: 10px;"></i>
        <div class="stat-value" id="totalWords">0</div>
        <div class="stat-label">ÙƒÙ„Ù…Ø© ÙˆØ¬Ù…Ù„Ø©</div>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-chart-line" style="font-size: 36px; color: var(--success-color); margin-bottom: 10px;"></i>
        <div class="stat-value" id="quizScore">0%</div>
        <div class="stat-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­</div>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-fire" style="font-size: 36px; color: var(--accent-color); margin-bottom: 10px;"></i>
        <div class="stat-value" id="streakDays">0</div>
        <div class="stat-label">Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©</div>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-trophy" style="font-size: 36px; color: #FFD700; margin-bottom: 10px;"></i>
        <div class="stat-value" id="achievements">0</div>
        <div class="stat-label">Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</div>
      </div>
    </div>
    
    <!-- Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ© ÙˆØ§Ù„Ø´Ø®ØµÙŠØ© -->
    <div class="card" id="avatarSection">
      <h3 class="card-title"><i class="fas fa-user-circle"></i> Ø´Ø®ØµÙŠØªÙƒ Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©</h3>
      <div class="avatar-container">
        <div class="avatar-image" id="avatarImage">
          <i class="fas fa-user-graduate"></i>
        </div>
        <div class="avatar-info">
          <h4 id="avatarName">Ø·Ø§Ù„Ø¨ Ù…Ø¬ØªÙ‡Ø¯</h4>
          <span class="avatar-level" id="avatarLevel">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1</span>
          <p id="avatarProgress">Ø§Ù„ØªÙ‚Ø¯Ù…: <span id="avatarProgressValue">0%</span></p>
          <div class="avatar-items" id="avatarItems">
            <span class="avatar-item">ğŸ‘• Ù‚Ù…ÙŠØµ Ø¹Ø§Ø¯ÙŠ</span>
            <span class="avatar-item">ğŸ“– ÙƒØªØ§Ø¨ Ø£Ø³Ø§Ø³ÙŠ</span>
          </div>
        </div>
      </div>
      <div class="progress-bar">
        <div class="progress" id="avatarProgressBar" style="width: 0%"></div>
      </div>
    </div>
    
    <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="card">
      <div class="tab-buttons">
        <button class="tab-btn active" onclick="showTab('tab1')">
          <i class="fas fa-language"></i> ØªØ±Ø¬Ù…Ø© ÙˆÙ†Ø·Ù‚
        </button>
        <button class="tab-btn" onclick="showTab('tab2')">
          <i class="fas fa-book-open"></i> Ø§Ù„ÙˆØ­Ø¯Ø§Øª ÙˆØ§Ù„Ø¯Ø±ÙˆØ³
        </button>
        <button class="tab-btn" onclick="showTab('tab3')">
          <i class="fas fa-gamepad"></i> Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
        </button>
        <button class="tab-btn" onclick="showTab('tab4')">
          <i class="fas fa-headphones"></i> Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ø³ØªÙ…Ø§Ø¹
        </button>
        <button class="tab-btn" onclick="showTab('tab5')">
          <i class="fas fa-spell-check"></i> Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØªÙ‡Ø¬Ø¦Ø©
        </button>
        <button class="tab-btn" onclick="showTab('tab6')">
          <i class="fas fa-microphone-alt"></i> Ù†Ø·Ù‚ Ù…ØªÙ‚Ø¯Ù…
        </button>
        <button class="tab-btn" onclick="showTab('tab7')">
          <i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰
        </button>
        <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© -->
        <button class="tab-btn" onclick="showTab('tab9')">
          <i class="fas fa-microphone-alt"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØµÙˆØª
        </button>
        <button class="tab-btn" onclick="showTab('tab10')">
          <i class="fas fa-flag"></i> Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©
        </button>
        <button class="tab-btn" onclick="showTab('tab11')">
          <i class="fas fa-music"></i> ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ø£ØºØ§Ù†ÙŠ
        </button>
        <button class="tab-btn" onclick="showTab('tab12')">
          <i class="fas fa-user-md"></i> Ø­Ø³Ø¨ Ø§Ù„Ù…Ù‡Ù†Ø©
        </button>
        <button class="tab-btn" onclick="showTab('tab13')">
          <i class="fas fa-brain"></i> Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ
        </button>
        <button class="tab-btn" onclick="showTab('tab14')">
          <i class="fas fa-trophy"></i> Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª
        </button>
        <button class="tab-btn" onclick="showTab('tab15')">
          <i class="fas fa-users"></i> Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
        </button>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙˆØ§Ù„Ù†Ø·Ù‚ -->
      <div id="tab1" class="tab-content active">
        <h3 class="card-title"><i class="fas fa-language"></i> Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙˆØ§Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
        <div class="hint">
          <i class="fas fa-lightbulb"></i> ÙŠÙ…ÙƒÙ†Ùƒ ØªØ±Ø¬Ù…Ø© Ø£Ùˆ Ù†Ø·Ù‚ Ø£ÙŠ Ù†ØµØŒ Ø£Ùˆ Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©.
        </div>
        <label>Ø§Ø¯Ø®Ù„ Ù†Øµ Ù„Ù„ØªØ±Ø¬Ù…Ø© Ø£Ùˆ Ø§Ù„Ù†Ø·Ù‚:</label>
        <textarea id="textInput" rows="4" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©..."></textarea>
        
        <div class="voice-settings">
          <h4><i class="fas fa-sliders-h"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø·Ù‚</h4>
          <div class="voice-controls">
            <button class="btn-primary" onclick="speakText('en')">
              <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
            </button>
            <button class="btn-secondary" onclick="speakText('ar')">
              <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø¹Ø±Ø¨ÙŠ
            </button>
            <button class="btn-success" onclick="speakSlowly()">
              <i class="fas fa-tachometer-alt"></i> Ù†Ø·Ù‚ Ø¨Ø·ÙŠØ¡
            </button>
          </div>
          
          <div class="voice-controls">
            <label>Ø³Ø±Ø¹Ø© Ø§Ù„Ù†Ø·Ù‚:</label>
            <input type="range" id="rateSlider" min="0.5" max="2" step="0.1" value="1" class="voice-slider" onchange="updateVoiceSettings()">
            <span id="rateValue">1.0</span>
            
            <label>Ù†Ø¨Ø±Ø© Ø§Ù„ØµÙˆØª:</label>
            <input type="range" id="pitchSlider" min="0.5" max="2" step="0.1" value="1" class="voice-slider" onchange="updateVoiceSettings()">
            <span id="pitchValue">1.0</span>
          </div>
        </div>
        
        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© -->
        <div style="text-align: center; margin-top: 15px;">
          <div style="display: flex; justify-content: center; gap: 10px; margin: 15px 0; flex-wrap: wrap;">
            <button class="btn-primary" onclick="translateText()">
              <i class="fas fa-globe"></i> ØªØ±Ø¬Ù…Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
            </button>
            <button class="btn-secondary" onclick="translateWithLocalDatabase()">
              <i class="fas fa-database"></i> ØªØ±Ø¬Ù…Ø© Ù…Ø­Ù„ÙŠØ©
            </button>
            <button class="btn-purple" onclick="translateLongText()">
              <i class="fas fa-file-alt"></i> ØªØ±Ø¬Ù…Ø© Ù†Øµ Ø·ÙˆÙŠÙ„
            </button>
          </div>
          <div style="margin-top: 10px;">
            <button class="btn-primary" onclick="analyzeText()">
              <i class="fas fa-search"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ
            </button>
            <button class="btn-warning" onclick="addToVocabulary()">
              <i class="fas fa-plus"></i> Ø£Ø¶Ù Ù„Ù„Ù…ÙØ±Ø¯Ø§Øª
            </button>
          </div>
        </div>
        
        <div id="output"></div>
        <div id="phoneticOutput"></div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ÙˆØ­Ø¯Ø§Øª ÙˆØ§Ù„Ø¯Ø±ÙˆØ³ -->
      <div id="tab2" class="tab-content">
        <h3 class="card-title"><i class="fas fa-book-open"></i> Ø§Ù„ÙˆØ­Ø¯Ø§Øª ÙˆØ§Ù„Ø¯Ø±ÙˆØ³ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</h3>
        <div style="margin-bottom: 15px;">
          <input type="text" id="searchLessons" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¯Ø±ÙˆØ³..." onkeyup="searchLessons()">
        </div>
        <div id="unitsContent"></div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© -->
      <div id="tab3" class="tab-content">
        <h3 class="card-title"><i class="fas fa-gamepad"></i> Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h3>
        <div style="text-align: center; margin-bottom: 20px;">
          <div class="hint">
            Ø§Ø®ØªØ± Ù„Ø¹Ø¨Ø© Ù„ØªØ­Ø³ÙŠÙ† Ù…Ù‡Ø§Ø±Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù…ØªØ¹Ø©!
          </div>
          <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0;">
            <button class="btn-primary" onclick="startQuiz()">
              <i class="fas fa-question-circle"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª
            </button>
            <button class="btn-primary" onclick="startMatchingGame()">
              <i class="fas fa-puzzle-piece"></i> Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
            </button>
            <button class="btn-secondary" onclick="startListeningGame()">
              <i class="fas fa-headphones"></i> Ù„Ø¹Ø¨Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
            </button>
            <button class="btn-success" onclick="startSpellingGame()">
              <i class="fas fa-spell-check"></i> Ù„Ø¹Ø¨Ø© Ø§Ù„ØªÙ‡Ø¬Ø¦Ø©
            </button>
            <button class="btn-warning" onclick="startPronunciationGame()">
              <i class="fas fa-microphone"></i> Ù†Ø·Ù‚ ØµØ­ÙŠØ­
            </button>
            <button class="btn-purple" onclick="startSentenceBuilder()">
              <i class="fas fa-cubes"></i> Ø§Ø¨Ù†ÙŠ Ø§Ù„Ø¬Ù…Ù„Ø©
            </button>
            <button class="btn-danger" onclick="startSpeedChallenge()">
              <i class="fas fa-stopwatch"></i> ØªØ­Ø¯ÙŠ 60 Ø«Ø§Ù†ÙŠØ©
            </button>
          </div>
        </div>
        <div id="quizArea"></div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ -->
      <div id="tab4" class="tab-content">
        <h3 class="card-title"><i class="fas fa-headphones"></i> Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ø³ØªÙ…Ø§Ø¹ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</h3>
        <div class="hint">
          <i class="fas fa-info-circle"></i> Ø§Ø³ØªÙ…Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆÙƒØ±Ø±Ù‡Ø§ Ù„ØªØ­Ø³ÙŠÙ† Ù†Ø·Ù‚Ùƒ ÙˆÙÙ‡Ù…Ùƒ Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©.
        </div>
        <div id="conversationsContent"></div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„ØªÙ‡Ø¬Ø¦Ø© -->
      <div id="tab5" class="tab-content">
        <h3 class="card-title"><i class="fas fa-spell-check"></i> Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„ØºØ© ÙˆØ§Ù„ØªÙ‡Ø¬Ø¦Ø©</h3>
        <div id="grammarContent"></div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… -->
      <div id="tab6" class="tab-content">
        <h3 class="card-title"><i class="fas fa-microphone-alt"></i> Ù†Ø·Ù‚ Ù…ØªÙ‚Ø¯Ù… ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ù„ÙƒÙ†Ø©</h3>
        
        <div class="hint">
          <i class="fas fa-info-circle"></i> Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø³ÙŠÙ† Ù†Ø·Ù‚Ùƒ Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ù„ÙƒÙ†Ø© Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ© ØµØ­ÙŠØ­Ø©.
        </div>
        
        <div class="phonetic-section">
          <h4><i class="fas fa-volume-up"></i> Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ</h4>
          <div class="voice-controls">
            <select id="britishAccent" class="form-control" onchange="selectBritishAccent()">
              <option value="en-GB">Ù„ÙƒÙ†Ø© Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ© Ù‚ÙŠØ§Ø³ÙŠØ©</option>
              <option value="en-GB-WLS">Ù„ÙƒÙ†Ø© ÙˆÙŠÙ„Ø²ÙŠØ©</option>
              <option value="en-GB-SCT">Ù„ÙƒÙ†Ø© Ø§Ø³ÙƒØªÙ„Ù†Ø¯ÙŠØ©</option>
            </select>
            
            <button class="btn-primary" onclick="speakWithBritishAccent()">
              <i class="fas fa-play-circle"></i> Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ù„ÙƒÙ†Ø© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©
            </button>
          </div>
          
          <div style="margin: 15px 0;">
            <input type="text" id="practiceText" placeholder="Ø§ÙƒØªØ¨ Ù†ØµØ§Ù‹ Ù„Ù…Ù…Ø§Ø±Ø³Ø© Ø§Ù„Ù„ÙƒÙ†Ø© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©..." 
                   value="How now brown cow. The rain in Spain stays mainly in the plain." style="width: 100%;">
          </div>
          
          <div class="voice-controls">
            <button class="btn-success" onclick="startSpeechPractice()" id="practiceButton">
              <i class="fas fa-microphone"></i> Ø¨Ø¯Ø¡ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù†Ø·Ù‚
            </button>
            <button class="btn-secondary" onclick="comparePronunciation()">
              <i class="fas fa-balance-scale"></i> Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ø·Ù‚
            </button>
          </div>
        </div>
        
        <div class="phonetic-section">
          <h4><i class="fas fa-wave-square"></i> ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ØµÙˆØªÙŠØ§Øª (Phonetics)</h4>
          <div id="phoneticsTraining"></div>
        </div>
        
        <div class="phonetic-section">
          <h4><i class="fas fa-chart-line"></i> ØªØªØ¨Ø¹ ØªÙ‚Ø¯Ù… Ø§Ù„Ù†Ø·Ù‚</h4>
          <div id="pronunciationProgress">
            <p>Ø¬ÙˆØ¯Ø© Ø§Ù„Ù†Ø·Ù‚: <span id="pronunciationScore">0%</span></p>
            <div class="progress-bar">
              <div class="progress" id="pronunciationProgressBar" style="width: 0%"></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰ -->
      <div id="tab7" class="tab-content">
        <h3 class="card-title"><i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯</h3>
        
        <div class="hint">
          <i class="fas fa-info-circle"></i> ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø§ØªØŒ Ø¬Ù…Ù„ØŒ Ø£Ùˆ Ø­ØªÙ‰ ÙˆØ­Ø¯Ø§Øª Ø¯Ø±Ø§Ø³ÙŠØ© ÙƒØ§Ù…Ù„Ø©.
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
          <div>
            <label>Ø§Ù„ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©:</label>
            <input type="text" id="newWordEn" placeholder="Ù…Ø«Ø§Ù„: Hello, how are you?">
          </div>
          <div>
            <label>Ø§Ù„ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©:</label>
            <input type="text" id="newWordAr" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ÙƒÙŠÙ Ø­Ø§Ù„ÙƒØŸ">
          </div>
        </div>
        
        <div style="margin-top: 15px;">
          <label>Ø§Ù„ØªØµÙ†ÙŠÙ:</label>
          <select id="newWordCategory">
            <option value="Ù…ÙØ±Ø¯Ø§Øª">Ù…ÙØ±Ø¯Ø§Øª</option>
            <option value="Ù…Ø­Ø§Ø¯Ø«Ø©">Ù…Ø­Ø§Ø¯Ø«Ø©</option>
            <option value="Ù‚Ø§Ø¹Ø¯Ø©">Ù‚Ø§Ø¹Ø¯Ø© Ù†Ø­ÙˆÙŠØ©</option>
            <option value="ÙØ¹Ù„">ÙØ¹Ù„</option>
            <option value="ØµÙØ©">ØµÙØ©</option>
            <option value="Ø¸Ø±Ù">Ø¸Ø±Ù</option>
            <option value="Ù…Ø¯Ø±Ø³Ø©">Ù…Ø¯Ø±Ø³Ø©</option>
            <option value="Ù…Ù†Ø²Ù„">Ù…Ù†Ø²Ù„</option>
            <option value="Ø¹Ø§Ø¦Ù„Ø©">Ø¹Ø§Ø¦Ù„Ø©</option>
          </select>
        </div>
        
        <div style="margin-top: 15px;">
          <label>Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:</label>
          <input type="text" id="newWordUnit" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„ÙˆØ­Ø¯Ø© 1 - Ø§Ù„ØªØ­ÙŠØ§Øª ÙˆØ§Ù„ØªØ¹Ø§Ø±Ù">
        </div>
        
        <div style="margin-top: 15px;">
          <label>Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
          <textarea id="newWordExample" rows="2" placeholder="Ù…Ø«Ø§Ù„: Hello, my name is Ali."></textarea>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
          <button class="btn-primary" onclick="addNewWord()">
            <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯
          </button>
          <button class="btn-secondary" onclick="clearNewWord()">
            <i class="fas fa-eraser"></i> Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
          </button>
          <button class="btn-success" onclick="suggestRandomWord()">
            <i class="fas fa-random"></i> Ø§Ù‚ØªØ±Ø§Ø­ Ù…Ø«Ø§Ù„
          </button>
        </div>
        
        <div id="customWordsList" style="margin-top: 25px;">
          <h4><i class="fas fa-list"></i> Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø°ÙŠ Ø£Ø¶ÙØªÙ‡:</h4>
          <div id="customWordsContent"></div>
        </div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØµÙˆØª -->
      <div id="tab9" class="tab-content">
        <h3 class="card-title"><i class="fas fa-microphone-alt"></i> Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø·Ù‚Ùƒ ğŸ¤</h3>
        
        <div class="hint">
          <i class="fas fa-info-circle"></i> Ø§Ø®ØªØ¨Ø± Ù†Ø·Ù‚Ùƒ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ… ÙÙˆØ±ÙŠ Ù…Ù† 70% Ø¥Ù„Ù‰ 90%!
        </div>
        
        <div class="game-container">
          <div class="challenge-word" id="testWord">Hello</div>
          
          <div style="text-align: center; margin: 20px 0;">
            <button class="btn-primary recording" onclick="startPronunciationTest()" id="testBtn" style="padding: 15px 30px; font-size: 18px;">
              <i class="fas fa-microphone"></i> Ø§Ø¨Ø¯Ø£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø·Ù‚
            </button>
          </div>
          
          <div id="testResult"></div>
          
          <div style="text-align: center; margin-top: 20px;">
            <button class="btn-secondary" onclick="nextTestWord()">
              <i class="fas fa-forward"></i> ÙƒÙ„Ù…Ø© ØªØ§Ù„ÙŠØ©
            </button>
            <button class="btn-warning" onclick="testRandomWord()">
              <i class="fas fa-random"></i> ÙƒÙ„Ù…Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
            </button>
          </div>
          
          <div id="pronunciationHistory" style="margin-top: 20px;"></div>
        </div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ© -->
      <div id="tab10" class="tab-content">
        <h3 class="card-title"><i class="fas fa-flag"></i> ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ© ğŸ‡®ğŸ‡¶â¡ï¸ğŸ‡¬ğŸ‡§</h3>
        
        <div class="iraqi-translator">
          <h4 style="color: white; margin-top: 0;"><i class="fas fa-exchange-alt"></i> Ù…ØªØ±Ø¬Ù… Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©</h4>
          
          <textarea id="iraqiInput" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø¬Ù…Ù„Ø© Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©... Ù…Ø«Ø§Ù„: Ø´Ù„ÙˆÙ†ÙƒØŸ Ø±Ø§Ø­ Ø£Ø±ÙˆØ­ Ù„Ù„Ø³ÙˆÙ‚"></textarea>
          
          <div style="text-align: center; margin: 15px 0;">
            <button class="btn-primary" onclick="translateIraqi()" style="background: white; color: #8e2de2;">
              <i class="fas fa-language"></i> ØªØ±Ø¬Ù… Ù„Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
            </button>
            <button class="btn-secondary" onclick="speakIraqiTranslation()">
              <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø©
            </button>
          </div>
          
          <div id="iraqiResult" class="translation-result"></div>
        </div>
        
        <div class="card" style="margin-top: 20px;">
          <h4><i class="fas fa-book"></i> Ù‚Ø§Ù…ÙˆØ³ Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ© Ø§Ù„Ø´Ø§Ø¦Ø¹</h4>
          <div id="iraqiDictionary"></div>
        </div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ø£ØºØ§Ù†ÙŠ -->
      <div id="tab11" class="tab-content">
        <h3 class="card-title"><i class="fas fa-music"></i> ØªØ¹Ù„Ù… Ù…Ù† Ø§Ù„Ø£ØºØ§Ù†ÙŠ Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ© ğŸµ</h3>
        
        <div class="song-player">
          <h4 style="color: white; margin-top: 0;"><i class="fas fa-play-circle"></i> Ø£ØºÙ†ÙŠØ©: Hello - Adele</h4>
          
          <audio id="songAudio" controls style="width: 100%; margin: 15px 0;">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
            Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª.
          </audio>
          
          <div id="songLyrics" style="max-height: 300px; overflow-y: auto; margin: 15px 0;">
            <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
          </div>
          
          <div style="text-align: center;">
            <button class="btn-primary" onclick="explainSongWords()" style="background: white; color: #333;">
              <i class="fas fa-book"></i> Ø´Ø±Ø­ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØµØ¹Ø¨Ø©
            </button>
            <button class="btn-secondary" onclick="highlightPronunciation()">
              <i class="fas fa-highlighter"></i> ØªÙ„ÙˆÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ù†Ø·Ù‚
            </button>
          </div>
        </div>
        
        <div style="margin-top: 20px;">
          <h4><i class="fas fa-list"></i> Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØºØ§Ù†ÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h4>
          <div id="songList"></div>
        </div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ù…Ù‡Ù†Ø© -->
      <div id="tab12" class="tab-content">
        <h3 class="card-title"><i class="fas fa-user-md"></i> ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ù‡Ù†Ø©</h3>
        
        <div class="hint">
          <i class="fas fa-lightbulb"></i> Ø§Ø®ØªØ± Ù…Ù‡Ù†ØªÙƒ Ù„ØªØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ùƒ!
        </div>
        
        <div class="profession-grid">
          <div class="profession-card" onclick="selectProfession('student')">
            <div class="profession-icon">
              <i class="fas fa-graduation-cap"></i>
            </div>
            <h4>Ø§Ù„Ø·Ø§Ù„Ø¨</h4>
            <p>Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ÙˆØ§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</p>
          </div>
          
          <div class="profession-card" onclick="selectProfession('doctor')">
            <div class="profession-icon">
              <i class="fas fa-user-md"></i>
            </div>
            <h4>Ø§Ù„Ø·Ø¨ÙŠØ¨</h4>
            <p>Ù…ØµØ·Ù„Ø­Ø§Øª Ø·Ø¨ÙŠØ© ÙˆØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø¶Ù‰</p>
          </div>
          
          <div class="profession-card" onclick="selectProfession('business')">
            <div class="profession-icon">
              <i class="fas fa-briefcase"></i>
            </div>
            <h4>Ù…ÙˆØ¸Ù Ø£Ø¹Ù…Ø§Ù„</h4>
            <p>Ø§Ø¬ØªÙ…Ø§Ø¹Ø§ØªØŒ Ø¥ÙŠÙ…ÙŠÙ„Ø§ØªØŒ Ø¹Ø±ÙˆØ¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠØ©</p>
          </div>
          
          <div class="profession-card" onclick="selectProfession('engineer')">
            <div class="profession-icon">
              <i class="fas fa-cogs"></i>
            </div>
            <h4>Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³</h4>
            <p>Ù…ØµØ·Ù„Ø­Ø§Øª ØªÙ‚Ù†ÙŠØ© ÙˆØªÙ‚Ø§Ø±ÙŠØ± ÙÙ†ÙŠØ©</p>
          </div>
          
          <div class="profession-card" onclick="selectProfession('teacher')">
            <div class="profession-icon">
              <i class="fas fa-chalkboard-teacher"></i>
            </div>
            <h4>Ø§Ù„Ù…Ø¹Ù„Ù…</h4>
            <p>Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ</p>
          </div>
          
          <div class="profession-card" onclick="selectProfession('tourist')">
            <div class="profession-icon">
              <i class="fas fa-passport"></i>
            </div>
            <h4>Ø§Ù„Ø³Ø§Ø¦Ø­</h4>
            <p>Ø­Ø¬ÙˆØ²Ø§ØªØŒ Ù…Ø·Ø§Ø¹Ù…ØŒ ØªØ³ÙˆÙ‚ØŒ ØªÙˆØ¬ÙŠÙ‡Ø§Øª</p>
          </div>
        </div>
        
        <div id="professionContent" style="margin-top: 20px;"></div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ -->
      <div id="tab13" class="tab-content">
        <h3 class="card-title"><i class="fas fa-brain"></i> Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ AI ğŸ¤–</h3>
        
        <div class="ai-assistant">
          <h4 style="color: white; margin-top: 0;"><i class="fas fa-robot"></i> Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡ Ø¹Ù† Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©!</h4>
          
          <textarea id="aiQuestion" rows="3" placeholder="Ø§Ø³Ø£Ù„ Ø£ÙŠ Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©... Ù…Ø«Ø§Ù„: Ù…Ø§ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† present perfect Ùˆ past simpleØŸ"></textarea>
          
          <div style="text-align: center; margin: 15px 0;">
            <button class="btn-primary" onclick="askAI()" style="background: white; color: #667eea;">
              <i class="fas fa-paper-plane"></i> Ø£Ø±Ø³Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„
            </button>
            <button class="btn-secondary" onclick="voiceAskAI()">
              <i class="fas fa-microphone"></i> Ø³Ø¤Ø§Ù„ ØµÙˆØªÙŠ
            </button>
          </div>
          
          <div id="aiResponse" class="ai-message"></div>
          
          <div style="margin-top: 15px; text-align: center;">
            <button class="btn-warning" onclick="askExample()">
              <i class="fas fa-lightbulb"></i> Ø§Ø·Ù„Ø¨ Ù…Ø«Ø§Ù„Ø§Ù‹
            </button>
            <button class="btn-success" onclick="askPractice()">
              <i class="fas fa-dumbbell"></i> ØªÙ…Ø±ÙŠÙ† Ø¹Ù…Ù„ÙŠ
            </button>
          </div>
        </div>
        
        <div class="card" style="margin-top: 20px;">
          <h4><i class="fas fa-history"></i> Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</h4>
          <div id="aiHistory"></div>
        </div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª -->
      <div id="tab14" class="tab-content">
        <h3 class="card-title"><i class="fas fa-trophy"></i> Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
        
        <div class="hint">
          <i class="fas fa-gamepad"></i> Ø§Ø®ØªØ¨Ø± Ù…Ù‡Ø§Ø±Ø§ØªÙƒ ÙÙŠ ØªØ­Ø¯ÙŠØ§Øª Ù…Ù…ØªØ¹Ø© ÙˆÙ…Ø«ÙŠØ±Ø©!
        </div>
        
        <div class="game-container">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
            <div class="lesson-card" onclick="startStoryGame()">
              <div class="profession-icon">
                <i class="fas fa-book-open"></i>
              </div>
              <h4>Ø§Ù„Ù‚ØµØµ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h4>
              <p>Ø§Ø®ØªØ± Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù‚ØµØ© Ø¨Ù†ÙØ³Ùƒ</p>
            </div>
            
            <div class="lesson-card" onclick="startPictureGame()">
              <div class="profession-icon">
                <i class="fas fa-camera"></i>
              </div>
              <h4>ØªØ­Ø¯ÙŠ Ø§Ù„ØµÙˆØ±</h4>
              <p>ØµÙ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</p>
            </div>
            
            <div class="lesson-card" onclick="startFriendsChallenge()">
              <div class="profession-icon">
                <i class="fas fa-users"></i>
              </div>
              <h4>ØªØ­Ø¯ÙŠ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</h4>
              <p>Ø·Ø§Ù„Ø¨ Ø¶Ø¯ Ø·Ø§Ù„Ø¨</p>
            </div>
            
            <div class="lesson-card" onclick="showAchievements()">
              <div class="profession-icon">
                <i class="fas fa-award"></i>
              </div>
              <h4>Ø¬Ø¯Ø§Ø± Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</h4>
              <p>Ø£ÙˆØ³Ù…Ø© ÙˆÙ…Ø³ØªÙˆÙŠØ§Øª</p>
            </div>
          </div>
          
          <div id="challengeArea"></div>
          
          <div class="friends-leaderboard" id="leaderboardSection">
            <h4><i class="fas fa-crown"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</h4>
            <div id="leaderboardContent"></div>
          </div>
        </div>
      </div>
      
      <!-- ØªØ¨ÙˆÙŠØ¨ Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± -->
      <div id="tab15" class="tab-content">
        <h3 class="card-title"><i class="fas fa-users"></i> Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦</h3>
        
        <div class="parent-dashboard">
          <div class="parent-card">
            <h4><i class="fas fa-chart-line"></i> Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ø§Ù„Ø¨</h4>
            <div class="stat-value" id="parentLevel">Ù…Ø¨ØªØ¯Ø¦</div>
            <div class="progress-bar">
              <div class="progress" id="parentLevelBar" style="width: 30%"></div>
            </div>
          </div>
          
          <div class="parent-card">
            <h4><i class="fas fa-exclamation-triangle"></i> Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h4>
            <div id="commonMistakesList"></div>
          </div>
          
          <div class="parent-card">
            <h4><i class="fas fa-clock"></i> Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h4>
            <div class="stat-value" id="studyTime">0 Ø³Ø§Ø¹Ø©</div>
            <p>Ø¢Ø®Ø± Ø²ÙŠØ§Ø±Ø©: <span id="lastVisit">Ø§Ù„ÙŠÙˆÙ…</span></p>
          </div>
          
          <div class="parent-card">
            <h4><i class="fas fa-medal"></i> Ø¢Ø®Ø± Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</h4>
            <div id="recentAchievements"></div>
          </div>
        </div>
        
        <div class="card" style="margin-top: 20px;">
          <h4><i class="fas fa-lightbulb"></i> ØªÙˆØµÙŠØ§Øª Ù„Ù„ØªØ­Ø³ÙŠÙ†</h4>
          <div id="parentRecommendations"></div>
          <button class="btn-primary" onclick="generateReport()" style="margin-top: 10px;">
            <i class="fas fa-file-pdf"></i> Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„
          </button>
        </div>
        
        <div class="card" style="margin-top: 20px;">
          <h4><i class="fas fa-calendar"></i> Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­</h4>
          <div id="studySchedule"></div>
        </div>
      </div>
    </div>
    
    <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ù„Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© -->
    <div class="card">
      <h3 class="card-title"><i class="fas fa-shopping-cart"></i> Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ù„Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
      
      <div class="daily-life-categories">
        <div class="life-category" onclick="showLifeCategory('restaurant')">
          <i class="fas fa-utensils" style="font-size: 30px; color: var(--primary-color); margin-bottom: 10px;"></i>
          <h4>Ø¨Ø§Ù„Ù…Ø·Ø¹Ù… ğŸ”</h4>
        </div>
        
        <div class="life-category" onclick="showLifeCategory('hospital')">
          <i class="fas fa-hospital" style="font-size: 30px; color: var(--error-color); margin-bottom: 10px;"></i>
          <h4>Ø¨Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ ğŸ¥</h4>
        </div>
        
        <div class="life-category" onclick="showLifeCategory('school')">
          <i class="fas fa-school" style="font-size: 30px; color: var(--success-color); margin-bottom: 10px;"></i>
          <h4>Ø¨Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ğŸ«</h4>
        </div>
        
        <div class="life-category" onclick="showLifeCategory('market')">
          <i class="fas fa-shopping-cart" style="font-size: 30px; color: var(--accent-color); margin-bottom: 10px;"></i>
          <h4>Ø¨Ø§Ù„Ø³ÙˆÙ‚ ğŸ›’</h4>
        </div>
        
        <div class="life-category" onclick="showLifeCategory('airport')">
          <i class="fas fa-plane" style="font-size: 30px; color: var(--purple); margin-bottom: 10px;"></i>
          <h4>Ø¨Ø§Ù„Ù…Ø·Ø§Ø± âœˆï¸</h4>
        </div>
        
        <div class="life-category" onclick="showLifeCategory('hotel')">
          <i class="fas fa-hotel" style="font-size: 30px; color: var(--teal); margin-bottom: 10px;"></i>
          <h4>Ø¨Ø§Ù„ÙÙ†Ø¯Ù‚ ğŸ¨</h4>
        </div>
      </div>
      
      <div id="lifeCategoryContent" style="margin-top: 20px;"></div>
    </div>
    
    <!-- Ø¬Ø¯Ø§Ø± Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª -->
    <div class="card" id="achievementsWall">
      <h3 class="card-title"><i class="fas fa-trophy"></i> Ø¬Ø¯Ø§Ø± Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</h3>
      <div class="achievement-wall" id="achievementsContent"></div>
    </div>
  </div>
  
  <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
  <div id="notificationArea"></div>

  <script>
    // ==================== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„Ø© ====================
    
    // Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ù„Ø¬Ù…Ù„ Ù„ÙƒÙ„ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
    const allLessons = {
      3: {
        difficulty: 'Ø³Ù‡Ù„',
        lessons: [
          {en:'Hello', ar:'Ù…Ø±Ø­Ø¨Ø§', category:'ØªØ­ÙŠØ§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„ØªØ­ÙŠØ§Øª', example: 'Hello, my name is Ali.', ipa: '/hÉ™ËˆlÉ™ÊŠ/'},
          {en:'Goodbye', ar:'Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø©', category:'ØªØ­ÙŠØ§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„ØªØ­ÙŠØ§Øª', example: 'Goodbye, see you tomorrow.', ipa: '/ËŒÉ¡ÊŠdËˆbaÉª/'},
          {en:'Thank you', ar:'Ø´ÙƒØ±Ø§Ù‹', category:'ØªØ­ÙŠØ§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„ØªØ­ÙŠØ§Øª', example: 'Thank you for your help.', ipa: '/ËˆÎ¸Ã¦Å‹k juË/'},
          {en:'Please', ar:'Ù…Ù† ÙØ¶Ù„Ùƒ', category:'ØªØ­ÙŠØ§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„ØªØ­ÙŠØ§Øª', example: 'Please sit down.', ipa: '/pliËz/'},
          {en:'Yes', ar:'Ù†Ø¹Ù…', category:'Ø£Ø³Ø§Ø³ÙŠØ§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª', example: 'Yes, I am a student.', ipa: '/jes/'},
          {en:'No', ar:'Ù„Ø§', category:'Ø£Ø³Ø§Ø³ÙŠØ§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª', example: 'No, I am not a teacher.', ipa: '/nÉ™ÊŠ/'},
          {en:'Book', ar:'ÙƒØªØ§Ø¨', category:'Ù…Ø¯Ø±Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', example: 'This is my book.', ipa: '/bÊŠk/'},
          {en:'Pen', ar:'Ù‚Ù„Ù…', category:'Ù…Ø¯Ø±Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', example: 'I have a blue pen.', ipa: '/pen/'},
          {en:'Teacher', ar:'Ù…Ø¹Ù„Ù…', category:'Ù…Ø¯Ø±Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', example: 'The teacher is kind.', ipa: '/ËˆtiËtÊƒÉ™(r)/'},
          {en:'Student', ar:'Ø·Ø§Ù„Ø¨', category:'Ù…Ø¯Ø±Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', example: 'I am a good student.', ipa: '/ËˆstjuËdnt/'}
        ]
      },
      4: {
        difficulty: 'Ø³Ù‡Ù„',
        lessons: [
          {en:'House', ar:'Ù…Ù†Ø²Ù„', category:'Ù…Ù†Ø²Ù„', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…Ù†Ø²Ù„', example: 'Our house has three rooms.', ipa: '/haÊŠs/'},
          {en:'Family', ar:'Ø¹Ø§Ø¦Ù„Ø©', category:'Ø¹Ø§Ø¦Ù„Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©', example: 'My family is big.', ipa: '/ËˆfÃ¦mÉ™li/'},
          {en:'Father', ar:'Ø£Ø¨', category:'Ø¹Ø§Ø¦Ù„Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©', example: 'My father is a doctor.', ipa: '/ËˆfÉ‘ËÃ°É™(r)/'},
          {en:'Mother', ar:'Ø£Ù…', category:'Ø¹Ø§Ø¦Ù„Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©', example: 'My mother cooks food.', ipa: '/ËˆmÊŒÃ°É™(r)/'},
          {en:'Brother', ar:'Ø£Ø®', category:'Ø¹Ø§Ø¦Ù„Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©', example: 'I have one brother.', ipa: '/ËˆbrÊŒÃ°É™(r)/'},
          {en:'Sister', ar:'Ø£Ø®Øª', category:'Ø¹Ø§Ø¦Ù„Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©', example: 'My sister is young.', ipa: '/ËˆsÉªstÉ™(r)/'},
          {en:'Cat', ar:'Ù‚Ø·Ø©', category:'Ø­ÙŠÙˆØ§Ù†Ø§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª', example: 'The cat is black.', ipa: '/kÃ¦t/'},
          {en:'Dog', ar:'ÙƒÙ„Ø¨', category:'Ø­ÙŠÙˆØ§Ù†Ø§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª', example: 'The dog is friendly.', ipa: '/dÉ’É¡/'},
          {en:'Bird', ar:'Ø·Ø§Ø¦Ø±', category:'Ø­ÙŠÙˆØ§Ù†Ø§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª', example: 'The bird can fly.', ipa: '/bÉœËd/'},
          {en:'Fish', ar:'Ø³Ù…ÙƒØ©', category:'Ø­ÙŠÙˆØ§Ù†Ø§Øª', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª', example: 'The fish swims in water.', ipa: '/fÉªÊƒ/'}
        ]
      },
      5: {
        difficulty: 'Ù…ØªÙˆØ³Ø·',
        lessons: [
          {en:'Computer', ar:'Ø­Ø§Ø³ÙˆØ¨', category:'ØªÙ‚Ù†ÙŠØ©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§', example: 'I use a computer for study.', ipa: '/kÉ™mËˆpjuËtÉ™(r)/'},
          {en:'Internet', ar:'Ø¥Ù†ØªØ±Ù†Øª', category:'ØªÙ‚Ù†ÙŠØ©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§', example: 'The internet is fast.', ipa: '/ËˆÉªntÉ™net/'},
          {en:'Mobile', ar:'Ø¬ÙˆØ§Ù„', category:'ØªÙ‚Ù†ÙŠØ©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§', example: 'My mobile is new.', ipa: '/ËˆmÉ™ÊŠbaÉªl/'},
          {en:'Game', ar:'Ù„Ø¹Ø¨Ø©', category:'ØªØ±ÙÙŠÙ‡', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªØ±ÙÙŠÙ‡', example: 'I like to play games.', ipa: '/É¡eÉªm/'},
          {en:'Music', ar:'Ù…ÙˆØ³ÙŠÙ‚Ù‰', category:'ØªØ±ÙÙŠÙ‡', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªØ±ÙÙŠÙ‡', example: 'I listen to music daily.', ipa: '/ËˆmjuËzÉªk/'},
          {en:'Movie', ar:'ÙÙŠÙ„Ù…', category:'ØªØ±ÙÙŠÙ‡', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªØ±ÙÙŠÙ‡', example: 'This movie is interesting.', ipa: '/ËˆmuËvi/'},
          {en:'Sports', ar:'Ø±ÙŠØ§Ø¶Ø©', category:'ØªØ±ÙÙŠÙ‡', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªØ±ÙÙŠÙ‡', example: 'Sports are good for health.', ipa: '/spÉ”Ëts/'},
          {en:'Football', ar:'ÙƒØ±Ø© Ù‚Ø¯Ù…', category:'ØªØ±ÙÙŠÙ‡', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªØ±ÙÙŠÙ‡', example: 'We play football every week.', ipa: '/ËˆfÊŠtbÉ”Ël/'},
          {en:'Basketball', ar:'ÙƒØ±Ø© Ø³Ù„Ø©', category:'ØªØ±ÙÙŠÙ‡', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªØ±ÙÙŠÙ‡', example: 'Basketball is my favorite sport.', ipa: '/ËˆbÉ‘ËskÉªtbÉ”Ël/'},
          {en:'Swimming', ar:'Ø³Ø¨Ø§Ø­Ø©', category:'ØªØ±ÙÙŠÙ‡', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªØ±ÙÙŠÙ‡', example: 'Swimming is fun in summer.', ipa: '/ËˆswÉªmÉªÅ‹/'}
        ]
      },
      6: {
        difficulty: 'Ù…ØªÙˆØ³Ø·',
        lessons: [
          {en:'Science', ar:'Ø¹Ù„ÙˆÙ…', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'Science is my favorite subject.', ipa: '/ËˆsaÉªÉ™ns/'},
          {en:'Mathematics', ar:'Ø±ÙŠØ§Ø¶ÙŠØ§Øª', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'Mathematics is difficult but important.', ipa: '/ËŒmÃ¦Î¸É™ËˆmÃ¦tÉªks/'},
          {en:'History', ar:'ØªØ§Ø±ÙŠØ®', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'We study history every Tuesday.', ipa: '/ËˆhÉªstri/'},
          {en:'Geography', ar:'Ø¬ØºØ±Ø§ÙÙŠØ§', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'Geography teaches about countries.', ipa: '/dÊ’iËˆÉ’É¡rÉ™fi/'},
          {en:'English', ar:'Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'English is an international language.', ipa: '/ËˆÉªÅ‹É¡lÉªÊƒ/'},
          {en:'Arabic', ar:'Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'Arabic is our native language.', ipa: '/ËˆÃ¦rÉ™bÉªk/'},
          {en:'Art', ar:'ÙÙ†', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'Art class is creative and fun.', ipa: '/É‘Ët/'},
          {en:'Music', ar:'Ù…ÙˆØ³ÙŠÙ‚Ù‰', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©', example: 'We have music lessons on Monday.', ipa: '/ËˆmjuËzÉªk/'},
          {en:'Physics', ar:'ÙÙŠØ²ÙŠØ§Ø¡', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©', example: 'Physics explains how things work.', ipa: '/ËˆfÉªzÉªks/'},
          {en:'Chemistry', ar:'ÙƒÙŠÙ…ÙŠØ§Ø¡', category:'Ø¯Ø±Ø§Ø³Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©', example: 'Chemistry is about elements and reactions.', ipa: '/ËˆkemÉªstri/'}
        ]
      },
      7: {
        difficulty: 'Ù…ØªÙ‚Ø¯Ù…',
        lessons: [
          {en:'Environment', ar:'Ø¨ÙŠØ¦Ø©', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ø¨ÙŠØ¦Ø© ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹', example: 'We must protect the environment.', ipa: '/ÉªnËˆvaÉªrÉ™nmÉ™nt/'},
          {en:'Pollution', ar:'ØªÙ„ÙˆØ«', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ø¨ÙŠØ¦Ø© ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹', example: 'Air pollution is a serious problem.', ipa: '/pÉ™ËˆluËÊƒn/'},
          {en:'Recycling', ar:'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯ÙˆÙŠØ±', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ø¨ÙŠØ¦Ø© ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹', example: 'Recycling helps reduce waste.', ipa: '/ËŒriËËˆsaÉªklÉªÅ‹/'},
          {en:'Global warming', ar:'Ø§Ø­ØªØ¨Ø§Ø³ Ø­Ø±Ø§Ø±ÙŠ', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ø¨ÙŠØ¦Ø© ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹', example: 'Global warming affects our planet.', ipa: '/ËŒÉ¡lÉ™ÊŠbÉ™l ËˆwÉ”ËmÉªÅ‹/'},
          {en:'Sustainability', ar:'Ø§Ø³ØªØ¯Ø§Ù…Ø©', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ø¨ÙŠØ¦Ø© ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹', example: 'Sustainability is important for future generations.', ipa: '/sÉ™ËŒsteÉªnÉ™ËˆbÉªlÉ™ti/'},
          {en:'Technology', ar:'ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø­Ø¯ÙŠØ«Ø©', example: 'Modern technology changes quickly.', ipa: '/tekËˆnÉ’lÉ™dÊ’i/'},
          {en:'Innovation', ar:'Ø§Ø¨ØªÙƒØ§Ø±', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø­Ø¯ÙŠØ«Ø©', example: 'Innovation drives progress in society.', ipa: '/ËŒÉªnÉ™ËˆveÉªÊƒn/'},
          {en:'Artificial intelligence', ar:'Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø­Ø¯ÙŠØ«Ø©', example: 'Artificial intelligence is transforming industries.', ipa: '/ËŒÉ‘ËtÉªfÉªÊƒl ÉªnËˆtelÉªdÊ’É™ns/'},
          {en:'Digital transformation', ar:'ØªØ­ÙˆÙ„ Ø±Ù‚Ù…ÙŠ', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø­Ø¯ÙŠØ«Ø©', example: 'Digital transformation affects all businesses.', ipa: '/ËŒdÉªdÊ’Éªtl ËŒtrÃ¦nsfÉ™ËˆmeÉªÊƒn/'},
          {en:'Cybersecurity', ar:'Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', category:'Ù…ÙØ±Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', unit: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø­Ø¯ÙŠØ«Ø©', example: 'Cybersecurity protects our data online.', ipa: '/ËˆsaÉªbÉ™ sÉªËˆkjÊŠÉ™rÉ™ti/'}
        ]
      }
    };
    
    // Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù„ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰
    const conversations = {
      3: [
        {en: "Hello, what's your name?", ar: "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ù…Ø§ Ø§Ø³Ù…ÙƒØŸ", title: "Ø§Ù„ØªØ¹Ø§Ø±Ù"},
        {en: "My name is Ali. How are you?", ar: "Ø§Ø³Ù…ÙŠ Ø¹Ù„ÙŠ. ÙƒÙŠÙ Ø­Ø§Ù„ÙƒØŸ", title: "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø­Ø§Ù„"}
      ],
      4: [
        {en: "Where do you live?", ar: "Ø£ÙŠÙ† ØªØ¹ÙŠØ´ØŸ", title: "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"},
        {en: "I live in Riyadh. What about you?", ar: "Ø£Ø¹ÙŠØ´ ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶. Ù…Ø§Ø°Ø§ Ø¹Ù†ÙƒØŸ", title: "Ø§Ù„Ø±Ø¯ ÙˆØ§Ù„Ø³Ø¤Ø§Ù„"}
      ],
      5: [
        {en: "What's your favorite color?", ar: "Ù…Ø§ Ù‡Ùˆ Ù„ÙˆÙ†Ùƒ Ø§Ù„Ù…ÙØ¶Ù„ØŸ", title: "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ù†"},
        {en: "My favorite color is blue. What's yours?", ar: "Ù„ÙˆÙ†ÙŠ Ø§Ù„Ù…ÙØ¶Ù„ Ù‡Ùˆ Ø§Ù„Ø£Ø²Ø±Ù‚. Ù…Ø§ Ù„ÙˆÙ†Ùƒ Ø§Ù„Ù…ÙØ¶Ù„ØŸ", title: "Ø§Ù„Ø±Ø¯ ÙˆØ§Ù„Ø³Ø¤Ø§Ù„"}
      ],
      6: [
        {en: "What time do you wake up?", ar: "ÙÙŠ Ø£ÙŠ Ø³Ø§Ø¹Ø© ØªØ³ØªÙŠÙ‚Ø¸ØŸ", title: "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø±ÙˆØªÙŠÙ†"},
        {en: "I wake up at 6:30. What about you?", ar: "Ø£Ø³ØªÙŠÙ‚Ø¸ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 6:30. Ù…Ø§Ø°Ø§ Ø¹Ù†ÙƒØŸ", title: "Ø§Ù„Ø±Ø¯ ÙˆØ§Ù„Ø³Ø¤Ø§Ù„"}
      ],
      7: [
        { en: "So, how often do you watch TV?", ar: "Ø¥Ø°Ù†ØŒ ÙƒÙ… Ù…Ø±Ø© ØªØ´Ø§Ù‡Ø¯ Ø§Ù„ØªÙ„ÙØ§Ø²ØŸ", title: "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø¹Ø§Ø¯Ø§Øª" },
        { en: "I seldom watch TV. I have no time.", ar: "Ù†Ø§Ø¯Ø±Ù‹Ø§ Ù…Ø§ Ø£Ø´Ø§Ù‡Ø¯ Ø§Ù„ØªÙ„ÙØ§Ø². Ù„ÙŠØ³ Ù„Ø¯ÙŠ ÙˆÙ‚Øª.", title: "Ø§Ù„Ø­Ø¯ÙŠØ« Ø¹Ù† Ù‚Ù„Ø© Ø§Ù„ÙˆÙ‚Øª" },
        { en: "What activities do you think you overdo?", ar: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ØªÙŠ ØªØ¹ØªÙ‚Ø¯ Ø£Ù†Ùƒ ØªØ¨Ø§Ù„Øº ÙÙŠ Ù…Ù…Ø§Ø±Ø³ØªÙ‡Ø§ØŸ", title: "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø¥ÙØ±Ø§Ø·" }
      ]
    };
    
    // Ù‚ÙˆØ§Ø¹Ø¯ Ù„ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰
    const grammarRules = {
      3: [
        {title: "Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ", rule: "The = Ø§Ù„ (Ù„Ù„ØªØ¹Ø±ÙŠÙ)", examples: ["The book = Ø§Ù„ÙƒØªØ§Ø¨", "The teacher = Ø§Ù„Ù…Ø¹Ù„Ù…"]}
      ],
      4: [
        {title: "Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„ÙØ§Ø¹Ù„", rule: "I = Ø£Ù†Ø§ØŒ You = Ø£Ù†ØªØŒ He = Ù‡ÙˆØŒ She = Ù‡ÙŠ", examples: ["I am a student", "She is a teacher"]}
      ],
      5: [
        {title: "ØµÙŠØºØ© Ø§Ù„Ø£Ù…Ø±", rule: "Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ¹Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ Ù„Ù„Ø£Ù…Ø±", examples: ["Open the door = Ø§ÙØªØ­ Ø§Ù„Ø¨Ø§Ø¨", "Sit down = Ø§Ø¬Ù„Ø³"]}
      ],
      6: [
        {title: "Ø²Ù…Ù† Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„", rule: "Ù†Ø³ØªØ®Ø¯Ù… will Ù‚Ø¨Ù„ Ø§Ù„ÙØ¹Ù„", examples: ["I will go = Ø³Ø£Ø°Ù‡Ø¨", "She will study = Ø³ØªØ¯Ø±Ø³"]}
      ],
      7: [
        {title: "Ø²Ù…Ù† Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ· Ù„Ù„Ø¹Ø§Ø¯Ø§Øª", rule: "Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ· Ù„Ù„Ø­Ø¯ÙŠØ« Ø¹Ù† Ø§Ù„Ø¹Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ø±ÙˆØªÙŠÙ† Ø§Ù„ÙŠÙˆÙ…ÙŠ", examples: ["I work out regularly. = Ø£ØªÙ…Ø±Ù† Ø¨Ø§Ù†ØªØ¸Ø§Ù…", "She always does her homework. = Ù‡ÙŠ Ø¯Ø§Ø¦Ù…Ø§Ù‹ ØªØ¤Ø¯ÙŠ ÙˆØ§Ø¬Ø¨Ø§ØªÙ‡Ø§"]},
        {title: "Ø¸Ø±ÙˆÙ Ø§Ù„ØªÙƒØ±Ø§Ø±", rule: "ØªØ£ØªÙŠ Ø¸Ø±ÙˆÙ Ø§Ù„ØªÙƒØ±Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„ÙØ¹Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙˆÙ„ÙƒÙ† Ø¨Ø¹Ø¯ verb to be", examples: ["I usually eat healthy food. = Ø¹Ø§Ø¯Ø©Ù‹ Ù…Ø§ Ø¢ÙƒÙ„ Ø·Ø¹Ø§Ù…Ù‹Ø§ ØµØ­ÙŠÙ‹Ø§", "He is always busy. = Ù‡Ùˆ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ø´ØºÙˆÙ„"]}
      ]
    };
    
    // ==================== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ====================
    const userData = {
      currentGrade: 7,
      learnedWords: [],
      quizScores: [],
      streak: 0,
      lastVisit: null,
      achievements: [],
      customWords: [],
      voiceSettings: {
        rate: 1,
        pitch: 1,
        volume: 1,
        britishAccent: 'en-GB'
      },
      pronunciationScore: 0,
      avatar: {
        level: 1,
        name: "Ø·Ø§Ù„Ø¨ Ù…Ø¬ØªÙ‡Ø¯",
        progress: 0,
        items: ["ğŸ‘• Ù‚Ù…ÙŠØµ Ø¹Ø§Ø¯ÙŠ", "ğŸ“– ÙƒØªØ§Ø¨ Ø£Ø³Ø§Ø³ÙŠ"],
        unlockedItems: ["ğŸ‘• Ù‚Ù…ÙŠØµ Ø¹Ø§Ø¯ÙŠ", "ğŸ“– ÙƒØªØ§Ø¨ Ø£Ø³Ø§Ø³ÙŠ"],
        avatarColor: "linear-gradient(45deg, #4a90e2, #7b1fa2)"
      },
      mistakes: {
        grammar: [],
        pronunciation: [],
        vocabulary: [],
        translation: []
      },
      profession: null,
      studyTime: 0,
      dailyLifeProgress: {},
      challengeScores: {},
      aiConversations: [],
      parentData: {
        lastReport: null,
        recommendations: []
      }
    };
    
    // ==================== Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© ====================
    
    // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©
    const iraqiDictionary = {
      "Ø´Ù„ÙˆÙ†Ùƒ": {english: "How are you", formal: "How are you doing", category: "ØªØ­ÙŠØ§Øª"},
      "ÙˆØ§Ù„Ù„Ù‡": {english: "Really/By God", formal: "Indeed", category: "ØªØ£ÙƒÙŠØ¯"},
      "ÙŠØ§ Ø±ÙŠØª": {english: "I wish", formal: "I hope", category: "Ø£Ù…Ù†ÙŠØ§Øª"},
      "Ø§ÙƒÙˆ": {english: "There is", formal: "There exists", category: "ÙˆØ¬ÙˆØ¯"},
      "Ù…Ø§ÙƒÙˆ": {english: "There isn't", formal: "There is not", category: "Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯"},
      "Ø´Ù†Ùˆ": {english: "What", formal: "What is it", category: "Ø§Ø³ØªÙÙ‡Ø§Ù…"},
      "Ø±Ø§Ø­": {english: "Will", formal: "Will go", category: "Ù…Ø³ØªÙ‚Ø¨Ù„"},
      "Ù‡Ø³Ù‡": {english: "Now", formal: "Right now", category: "Ø²Ù…Ù†"},
      "Ø¨Ø¹Ø¯ÙŠÙ†": {english: "Later", formal: "Afterwards", category: "Ø²Ù…Ù†"},
      "Ø´ÙƒØ¯": {english: "How much", formal: "How much does it cost", category: "Ø³Ø¤Ø§Ù„"},
      "ÙˆØ§ÙŠØ¯": {english: "Very", formal: "Very much", category: "ØªÙƒØ«ÙŠØ±"},
      "Ø¹ÙˆØ¬": {english: "Wrong", formal: "Incorrect", category: "Ù†ÙÙŠ"},
      "ØµØ­": {english: "Right", formal: "Correct", category: "ØªØ£ÙƒÙŠØ¯"},
      "Ø¨Ø³": {english: "But/Only", formal: "However/Only", category: "Ø±Ø¨Ø·/ØªØ­Ø¯ÙŠØ¯"},
      "Ù‡ÙŠØ©": {english: "She", formal: "She is", category: "Ø¶Ù…Ø§Ø¦Ø±"},
      "Ù‡ÙˆØ©": {english: "He", formal: "He is", category: "Ø¶Ù…Ø§Ø¦Ø±"}
    };
    
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØºØ§Ù†ÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
    const educationalSongs = [
      {
        id: 1,
        title: "Hello - Adele",
        lyrics: [
          "Hello, it's me",
          "I was wondering if after all these years you'd like to meet",
          "To go over everything",
          "They say that time's supposed to heal ya",
          "But I ain't done much healing"
        ],
        difficultWords: [
          {word: "wondering", meaning: "Ø£ØªØ³Ø§Ø¡Ù„", pronunciation: "/ËˆwÊŒndÉ™rÉªÅ‹/"},
          {word: "heal", meaning: "ÙŠØ´ÙÙ‰", pronunciation: "/hiËl/"},
          {word: "supposed", meaning: "Ù…Ù† Ø§Ù„Ù…ÙØªØ±Ø¶", pronunciation: "/sÉ™ËˆpÉ™ÊŠzd/"}
        ],
        colorScheme: "#ff6b6b"
      },
      {
        id: 2,
        title: "Shape of You - Ed Sheeran",
        lyrics: [
          "The club isn't the best place to find a lover",
          "So the bar is where I go",
          "Me and my friends at the table doing shots",
          "Drinking fast and then we talk slow"
        ],
        difficultWords: [
          {word: "lover", meaning: "Ø­Ø¨ÙŠØ¨", pronunciation: "/ËˆlÊŒvÉ™(r)/"},
          {word: "shots", meaning: "Ø¬Ø±Ø¹Ø§Øª ØµØºÙŠØ±Ø©", pronunciation: "/ÊƒÉ’ts/"},
          {word: "bar", meaning: "Ø¨Ø§Ø±", pronunciation: "/bÉ‘Ë(r)/"}
        ],
        colorScheme: "#4ecdc4"
      }
    ];
    
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù†
    const professions = {
      student: {
        name: "Ø§Ù„Ø·Ø§Ù„Ø¨",
        icon: "fas fa-graduation-cap",
        lessons: [
          {en: "May I go to the bathroom?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ù…Ø§Ù…ØŸ", category: "Ù…Ø¯Ø±Ø³Ø©"},
          {en: "I don't understand this lesson", ar: "Ø£Ù†Ø§ Ù„Ø§ Ø£ÙÙ‡Ù… Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø±Ø³", category: "Ù…Ø¯Ø±Ø³Ø©"},
          {en: "When is the exam?", ar: "Ù…ØªÙ‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŸ", category: "Ø§Ù…ØªØ­Ø§Ù†Ø§Øª"},
          {en: "Can you explain it again?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ Ø´Ø±Ø­Ù‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ØŸ", category: "Ù…Ø¯Ø±Ø³Ø©"},
          {en: "I need help with my homework", ar: "Ø£Ø­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ ÙˆØ§Ø¬Ø¨ÙŠ", category: "ÙˆØ§Ø¬Ø¨Ø§Øª"}
        ]
      },
      doctor: {
        name: "Ø§Ù„Ø·Ø¨ÙŠØ¨",
        icon: "fas fa-user-md",
        lessons: [
          {en: "Where does it hurt?", ar: "Ø£ÙŠÙ† ØªØ´Ø¹Ø± Ø¨Ø§Ù„Ø£Ù„Ù…ØŸ", category: "ØªØ´Ø®ÙŠØµ"},
          {en: "Take this medicine three times a day", ar: "Ø®Ø° Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ§Ø¡ Ø«Ù„Ø§Ø« Ù…Ø±Ø§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹", category: "Ø¹Ù„Ø§Ø¬"},
          {en: "You need to rest for a few days", ar: "ØªØ­ØªØ§Ø¬ Ù„Ù„Ø±Ø§Ø­Ø© Ù„Ø¨Ø¶Ø¹Ø© Ø£ÙŠØ§Ù…", category: "Ù†ØµØ§Ø¦Ø­"},
          {en: "Have you had any allergies?", ar: "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø£ÙŠ Ø­Ø³Ø§Ø³ÙŠØ©ØŸ", category: "ØªØ§Ø±ÙŠØ® Ù…Ø±Ø¶ÙŠ"},
          {en: "The surgery was successful", ar: "ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø©", category: "Ø¬Ø±Ø§Ø­Ø©"}
        ]
      },
      business: {
        name: "Ù…ÙˆØ¸Ù Ø§Ù„Ø£Ø¹Ù…Ø§Ù„",
        icon: "fas fa-briefcase",
        lessons: [
          {en: "Let's schedule a meeting", ar: "Ù„Ù†Ø­Ø¯Ø¯ Ù…ÙˆØ¹Ø¯Ø§Ù‹ Ù„Ø§Ø¬ØªÙ…Ø§Ø¹", category: "Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª"},
          {en: "I need the report by Friday", ar: "Ø£Ø­ØªØ§Ø¬ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¬Ù…Ø¹Ø©", category: "ØªÙ‚Ø§Ø±ÙŠØ±"},
          {en: "The deadline is approaching", ar: "Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙŠÙ‚ØªØ±Ø¨", category: "Ù…ÙˆØ§Ø¹ÙŠØ¯"},
          {en: "We need to increase our sales", ar: "Ù†Ø­Ù† Ø¨Ø­Ø§Ø¬Ø© Ù„Ø²ÙŠØ§Ø¯Ø© Ù…Ø¨ÙŠØ¹Ø§ØªÙ†Ø§", category: "Ù…Ø¨ÙŠØ¹Ø§Øª"},
          {en: "Please send me the presentation", ar: "Ø£Ø±Ø¬Ùˆ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ Ù„ÙŠ", category: "Ø¹Ø±ÙˆØ¶"}
        ]
      },
      engineer: {
        name: "Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³",
        icon: "fas fa-cogs",
        lessons: [
          {en: "The measurements need to be precise", ar: "ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø¯Ù‚ÙŠÙ‚Ø©", category: "Ù‚ÙŠØ§Ø³Ø§Øª"},
          {en: "We encountered a technical issue", ar: "ÙˆØ§Ø¬Ù‡Ù†Ø§ Ù…Ø´ÙƒÙ„Ø© ØªÙ‚Ù†ÙŠØ©", category: "Ù…Ø´Ø§ÙƒÙ„"},
          {en: "The blueprint is ready", ar: "Ø§Ù„Ù…Ø®Ø·Ø· Ø¬Ø§Ù‡Ø²", category: "ØªØµØ§Ù…ÙŠÙ…"},
          {en: "Safety regulations must be followed", ar: "ÙŠØ¬Ø¨ Ø§ØªØ¨Ø§Ø¹ Ù„ÙˆØ§Ø¦Ø­ Ø§Ù„Ø³Ù„Ø§Ù…Ø©", category: "Ø³Ù„Ø§Ù…Ø©"},
          {en: "The project is on schedule", ar: "Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¶Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ", category: "Ù…Ø´Ø§Ø±ÙŠØ¹"}
        ]
      },
      teacher: {
        name: "Ø§Ù„Ù…Ø¹Ù„Ù…",
        icon: "fas fa-chalkboard-teacher",
        lessons: [
          {en: "Please open your books to page 10", ar: "Ø§Ø±Ø¬Ø¹ÙˆØ§ Ø§ÙØªØ­ÙˆØ§ ÙƒØªØ¨ÙƒÙ… Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© 10", category: "ØµÙ Ø¯Ø±Ø§Ø³ÙŠ"},
          {en: "Does anyone have a question?", ar: "Ù‡Ù„ Ù„Ø¯Ù‰ Ø£Ø­Ø¯ Ø³Ø¤Ø§Ù„ØŸ", category: "Ø£Ø³Ø¦Ù„Ø©"},
          {en: "You need to practice more", ar: "ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø© Ø£ÙƒØ«Ø±", category: "Ù†ØµØ§Ø¦Ø­"},
          {en: "The assignment is due tomorrow", ar: "Ø§Ù„ÙˆØ§Ø¬Ø¨ Ù…Ø³ØªØ­Ù‚ ØºØ¯Ø§Ù‹", category: "ÙˆØ§Ø¬Ø¨Ø§Øª"},
          {en: "Excellent work!", ar: "Ø¹Ù…Ù„ Ù…Ù…ØªØ§Ø²!", category: "ØªØ´Ø¬ÙŠØ¹"}
        ]
      },
      tourist: {
        name: "Ø§Ù„Ø³Ø§Ø¦Ø­",
        icon: "fas fa-passport",
        lessons: [
          {en: "Where is the nearest hotel?", ar: "Ø£ÙŠÙ† Ø£Ù‚Ø±Ø¨ ÙÙ†Ø¯Ù‚ØŸ", category: "Ø¥Ù‚Ø§Ù…Ø©"},
          {en: "How much does this cost?", ar: "ÙƒÙ… Ø«Ù…Ù† Ù‡Ø°Ø§ØŸ", category: "Ø£Ø³Ø¹Ø§Ø±"},
          {en: "Can you recommend a good restaurant?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªÙ†ØµØ­ Ø¨Ù…Ø·Ø¹Ù… Ø¬ÙŠØ¯ØŸ", category: "Ù…Ø·Ø§Ø¹Ù…"},
          {en: "I'm lost, can you help me?", ar: "Ø£Ù†Ø§ ØªØ§Ø¦Ù‡ØŒ Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø³Ø§Ø¹Ø¯ØªÙŠØŸ", category: "ØªÙˆØ¬ÙŠÙ‡Ø§Øª"},
          {en: "What time does the museum open?", ar: "ÙÙŠ Ø£ÙŠ Ø³Ø§Ø¹Ø© ÙŠÙØªØ­ Ø§Ù„Ù…ØªØ­ÙØŸ", category: "Ø£ÙˆÙ‚Ø§Øª"}
        ]
      }
    };
    
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
    const dailyLifeCategories = {
      restaurant: {
        name: "Ø¨Ø§Ù„Ù…Ø·Ø¹Ù…",
        icon: "fas fa-utensils",
        phrases: [
          {en: "I'd like to see the menu", ar: "Ø£ÙˆØ¯ Ø±Ø¤ÙŠØ© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©", pronunciation: "/aÉªd laÉªk tuË siË Ã°É™ ËˆmenjuË/"},
          {en: "Could we have a table for two?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø·Ø§ÙˆÙ„Ø© Ù„Ø´Ø®ØµÙŠÙ†ØŸ", pronunciation: "/kÊŠd wiË hÃ¦v É™ ËˆteÉªbl fÉ”Ë tuË/"},
          {en: "I'll have the chicken salad", ar: "Ø³Ø¢Ø®Ø° Ø³Ù„Ø·Ø© Ø§Ù„Ø¯Ø¬Ø§Ø¬", pronunciation: "/aÉªl hÃ¦v Ã°É™ ËˆtÊƒÉªkÉªn ËˆsÃ¦lÉ™d/"},
          {en: "The bill, please", ar: "Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù…Ù† ÙØ¶Ù„Ùƒ", pronunciation: "/Ã°É™ bÉªl pliËz/"},
          {en: "Is service charge included?", ar: "Ù‡Ù„ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø®Ø¯Ù…Ø© Ù…Ø´Ù…ÙˆÙ„Ø©ØŸ", pronunciation: "/Éªz ËˆsÉœËvÉªs tÊƒÉ‘ËdÊ’ ÉªnËˆkluËdÉªd/"}
        ]
      },
      hospital: {
        name: "Ø¨Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰",
        icon: "fas fa-hospital",
        phrases: [
          {en: "I need to see a doctor", ar: "Ø£Ø­ØªØ§Ø¬ Ù„Ø±Ø¤ÙŠØ© Ø·Ø¨ÙŠØ¨", pronunciation: "/aÉª niËd tuË siË É™ ËˆdÉ’ktÉ™(r)/"},
          {en: "I have an appointment at 10 AM", ar: "Ù„Ø¯ÙŠ Ù…ÙˆØ¹Ø¯ ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© 10 ØµØ¨Ø§Ø­Ø§Ù‹", pronunciation: "/aÉª hÃ¦v É™n É™ËˆpÉ”ÉªntmÉ™nt Ã¦t ten eÉª Ëˆem/"},
          {en: "Where is the emergency room?", ar: "Ø£ÙŠÙ† ØºØ±ÙØ© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ØŸ", pronunciation: "/weÉ™(r) Éªz Ã°i ÉªËˆmÉœËdÊ’É™nsi ruËm/"},
          {en: "I feel nauseous", ar: "Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„ØºØ«ÙŠØ§Ù†", pronunciation: "/aÉª fiËl ËˆnÉ”ËziÉ™s/"},
          {en: "How often should I take this medicine?", ar: "ÙƒÙ… Ù…Ø±Ø© ÙŠØ¬Ø¨ Ø£Ù† Ø¢Ø®Ø° Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ§Ø¡ØŸ", pronunciation: "/haÊŠ ËˆÉ’fn ÊƒÊŠd aÉª teÉªk Ã°Éªs Ëˆmedsn/"}
        ]
      },
      school: {
        name: "Ø¨Ø§Ù„Ù…Ø¯Ø±Ø³Ø©",
        icon: "fas fa-school",
        phrases: [
          {en: "When does the class start?", ar: "Ù…ØªÙ‰ ÙŠØ¨Ø¯Ø£ Ø§Ù„ØµÙØŸ", pronunciation: "/wen dÊŒz Ã°É™ klÉ‘Ës stÉ‘Ët/"},
          {en: "May I borrow a pen?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ø³ØªØ¹Ø§Ø±Ø© Ù‚Ù„Ù…ØŸ", pronunciation: "/meÉª aÉª ËˆbÉ’rÉ™ÊŠ É™ pen/"},
          {en: "I didn't do my homework", ar: "Ù„Ù… Ø£Ù†Ø¬Ø² ÙˆØ§Ø¬Ø¨ÙŠ", pronunciation: "/aÉª ËˆdÉªdnt duË maÉª ËˆhÉ™ÊŠmwÉœËk/"},
          {en: "Can you repeat that?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙƒØ±Ø§Ø± Ø°Ù„ÙƒØŸ", pronunciation: "/kÃ¦n juË rÉªËˆpiËt Ã°Ã¦t/"},
          {en: "What's the assignment for tomorrow?", ar: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ù„ØºØ¯ØŸ", pronunciation: "/wÉ’ts Ã°i É™ËˆsaÉªnmÉ™nt fÉ™(r) tÉ™ËˆmÉ’rÉ™ÊŠ/"}
        ]
      },
      market: {
        name: "Ø¨Ø§Ù„Ø³ÙˆÙ‚",
        icon: "fas fa-shopping-cart",
        phrases: [
          {en: "How much is this per kilo?", ar: "ÙƒÙ… Ø³Ø¹Ø± Ù‡Ø°Ø§ Ù„Ù„ÙƒÙŠÙ„ÙˆØŸ", pronunciation: "/haÊŠ mÊŒtÊƒ Éªz Ã°Éªs pÉ™(r) ËˆkiËlÉ™ÊŠ/"},
          {en: "Do you have this in a larger size?", ar: "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ù‡Ø°Ø§ Ø¨Ù…Ù‚Ø§Ø³ Ø£ÙƒØ¨Ø±ØŸ", pronunciation: "/duË juË hÃ¦v Ã°Éªs Éªn É™ ËˆlÉ‘ËdÊ’É™(r) saÉªz/"},
          {en: "Can I try it on?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ ØªØ¬Ø±Ø¨ØªÙ‡ØŸ", pronunciation: "/kÃ¦n aÉª traÉª Éªt É’n/"},
          {en: "I'm just looking, thank you", ar: "Ø£Ù†Ø§ ÙÙ‚Ø· Ø£ØªÙØ±Ø¬ØŒ Ø´ÙƒØ±Ø§Ù‹", pronunciation: "/aÉªm dÊ’ÊŒst ËˆlÊŠkÉªÅ‹ Î¸Ã¦Å‹k juË/"},
          {en: "Where can I find the dairy section?", ar: "Ø£ÙŠÙ† ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ù† Ø£Ø¬Ø¯ Ù‚Ø³Ù… Ø§Ù„Ø£Ù„Ø¨Ø§Ù†ØŸ", pronunciation: "/weÉ™(r) kÃ¦n aÉª faÉªnd Ã°É™ ËˆdeÉ™ri ËˆsekÊƒn/"}
        ]
      },
      airport: {
        name: "Ø¨Ø§Ù„Ù…Ø·Ø§Ø±",
        icon: "fas fa-plane",
        phrases: [
          {en: "Where is the check-in counter?", ar: "Ø£ÙŠÙ† Ù…ÙƒØªØ¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ØŸ", pronunciation: "/weÉ™(r) Éªz Ã°É™ tÊƒek Éªn ËˆkaÊŠntÉ™(r)/"},
          {en: "I have one bag to check", ar: "Ù„Ø¯ÙŠ Ø­Ù‚ÙŠØ¨Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„Ù‡Ø§", pronunciation: "/aÉª hÃ¦v wÊŒn bÃ¦É¡ tuË tÊƒek/"},
          {en: "What's the boarding time?", ar: "Ù…Ø§ Ù‡Ùˆ ÙˆÙ‚Øª Ø§Ù„ØµØ¹ÙˆØ¯ØŸ", pronunciation: "/wÉ’ts Ã°É™ ËˆbÉ”ËdÉªng taÉªm/"},
          {en: "Which gate for flight 123?", ar: "Ø£ÙŠ Ø¨ÙˆØ§Ø¨Ø© Ù„Ù„Ø±Ø­Ù„Ø© 123ØŸ", pronunciation: "/wÉªtÊƒ É¡eÉªt fÉ™(r) flaÉªt wÊŒn tuË Î¸riË/"},
          {en: "My luggage is lost", ar: "Ø£Ù…ØªØ¹ØªÙŠ Ø¶Ø§Ø¦Ø¹Ø©", pronunciation: "/maÉª ËˆlÊŒÉ¡ÉªdÊ’ Éªz lÉ’st/"}
        ]
      },
      hotel: {
        name: "Ø¨Ø§Ù„ÙÙ†Ø¯Ù‚",
        icon: "fas fa-hotel",
        phrases: [
          {en: "I have a reservation under Smith", ar: "Ù„Ø¯ÙŠ Ø­Ø¬Ø² ØªØ­Øª Ø§Ø³Ù… Ø³Ù…ÙŠØ«", pronunciation: "/aÉª hÃ¦v É™ rezÉ™ËˆveÉªÊƒn ËˆÊŒndÉ™(r) smÉªÎ¸/"},
          {en: "What time is check-out?", ar: "Ù…Ø§ Ù‡Ùˆ ÙˆÙ‚Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©ØŸ", pronunciation: "/wÉ’t taÉªm Éªz tÊƒek aÊŠt/"},
          {en: "Can I have a wake-up call at 7 AM?", ar: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙƒØ§Ù„Ù…Ø© Ø¥ÙŠÙ‚Ø§Ø¸ ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© 7 ØµØ¨Ø§Ø­Ø§Ù‹ØŸ", pronunciation: "/kÃ¦n aÉª hÃ¦v É™ weÉªk ÊŒp kÉ”Ël Ã¦t ËˆsevÉ™n eÉª Ëˆem/"},
          {en: "The air conditioning isn't working", ar: "Ø§Ù„ØªÙƒÙŠÙŠÙ Ù„Ø§ ÙŠØ¹Ù…Ù„", pronunciation: "/Ã°i eÉ™(r) kÉ™nËˆdÉªÊƒÉ™nÉªÅ‹ ËˆÉªznt ËˆwÉœËkÉªng/"},
          {en: "Is breakfast included?", ar: "Ù‡Ù„ Ø§Ù„ÙØ·ÙˆØ± Ù…Ø´Ù…ÙˆÙ„ØŸ", pronunciation: "/Éªz ËˆbrekfÉ™st ÉªnËˆkluËdÉªd/"}
        ]
      }
    };
    
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
    const achievementsData = [
      {id: 1, name: "Ø§Ù„Ù…Ø¨ØªØ¯Ø¦", description: "ØªØ¹Ù„Ù… 10 ÙƒÙ„Ù…Ø§Øª", icon: "fas fa-seedling", requirement: "words>=10", reward: "ğŸ‘• Ù‚Ù…ÙŠØµ Ø¬Ø¯ÙŠØ¯"},
      {id: 2, name: "Ø§Ù„Ù…Ø¬ØªÙ‡Ø¯", description: "ØªØ¹Ù„Ù… 25 ÙƒÙ„Ù…Ø©", icon: "fas fa-leaf", requirement: "words>=25", reward: "ğŸ“ Ù‚Ø¨Ø¹Ø© ØªØ®Ø±Ø¬"},
      {id: 3, name: "Ø§Ù„Ù…ØªÙ…ÙƒÙ†", description: "ØªØ¹Ù„Ù… 50 ÙƒÙ„Ù…Ø©", icon: "fas fa-tree", requirement: "words>=50", reward: "ğŸ† ÙƒØ£Ø³ Ø§Ù„Ø°Ù‡Ø¨"},
      {id: 4, name: "Ù†Ø·Ø§Ù‚ Ø¬ÙŠØ¯", description: "Ù†Ø·Ù‚ Ø¨Ù†Ø³Ø¨Ø© 80%", icon: "fas fa-volume-up", requirement: "pronunciation>=80", reward: "ğŸ¤ Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† Ø°Ù‡Ø¨ÙŠ"},
      {id: 5, name: "Ù†Ø·Ø§Ù‚ Ù…Ù…ØªØ§Ø²", description: "Ù†Ø·Ù‚ Ø¨Ù†Ø³Ø¨Ø© 90%", icon: "fas fa-trophy", requirement: "pronunciation>=90", reward: "ğŸ‘‘ ØªØ§Ø¬ Ø§Ù„Ù†Ø·Ù‚"},
      {id: 6, name: "Ù…Ø«Ø§Ø¨Ø±", description: "3 Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©", icon: "fas fa-fire", requirement: "streak>=3", reward: "ğŸ”¥ Ø´Ø¹Ù„Ø© Ø§Ù„Ù…Ø«Ø§Ø¨Ø±Ø©"},
      {id: 7, name: "Ù…Ù†ØªØ¸Ù…", description: "Ø£Ø³Ø¨ÙˆØ¹ Ù…ØªØªØ§Ù„ÙŠ", icon: "fas fa-calendar-week", requirement: "streak>=7", reward: "ğŸ“… ØªÙ‚ÙˆÙŠÙ… Ø°Ù‡Ø¨ÙŠ"},
      {id: 8, name: "Ø§Ù„Ù…Ø¨Ø¯Ø¹", description: "Ø¥Ø¶Ø§ÙØ© 5 ÙƒÙ„Ù…Ø§Øª", icon: "fas fa-plus-circle", requirement: "customWords>=5", reward: "âœï¸ Ù‚Ù„Ù… Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ"},
      {id: 9, name: "Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„ØµØºÙŠØ±", description: "Ø¥Ø¶Ø§ÙØ© 10 ÙƒÙ„Ù…Ø§Øª", icon: "fas fa-user-graduate", requirement: "customWords>=10", reward: "ğŸ“š Ù…ÙƒØªØ¨Ø© Ø´Ø®ØµÙŠØ©"},
      {id: 10, name: "Ø¨Ø·Ù„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨", description: "ÙÙˆØ² ÙÙŠ 3 ØªØ­Ø¯ÙŠØ§Øª", icon: "fas fa-gamepad", requirement: "challenges>=3", reward: "ğŸ® Ø¬Ù‡Ø§Ø² Ø£Ù„Ø¹Ø§Ø¨"}
    ];
    
    // Ù‚ØµØµ ØªÙØ§Ø¹Ù„ÙŠØ©
    const interactiveStories = [
      {
        id: 1,
        title: "Ø§Ù„Ù„ØºØ² Ø§Ù„Ù…ÙÙ‚ÙˆØ¯",
        paragraphs: [
          "It was a dark and stormy night. You were walking home when you saw a mysterious box on the street.",
          "The box had a strange symbol on it. What do you do?",
          "Option 1: Open the box immediately",
          "Option 2: Take it to the police station",
          "Option 3: Ignore it and keep walking"
        ],
        choices: [
          {text: "ÙØªØ­ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚", next: "opened", points: 10},
          {text: "Ø£Ø®Ø°Ù‡ Ù„Ù„Ø´Ø±Ø·Ø©", next: "police", points: 20},
          {text: "ØªØ¬Ø§Ù‡Ù„Ù‡", next: "ignore", points: 5}
        ],
        endings: {
          opened: "You found a treasure map! But now you're being followed...",
          police: "The police thanked you. It was evidence in an important case.",
          ignore: "You missed a great adventure, but you're safe at home."
        }
      },
      {
        id: 2,
        title: "Ø±Ø­Ù„Ø© Ø¥Ù„Ù‰ Ù„Ù†Ø¯Ù†",
        paragraphs: [
          "You won a trip to London! Your plane just landed at Heathrow Airport.",
          "You need to find your hotel. You have two options:",
          "Option 1: Take the expensive taxi",
          "Option 2: Try the underground (Tube)",
          "Option 3: Ask for directions"
        ],
        choices: [
          {text: "Ø£Ø®Ø° Ø§Ù„ØªØ§ÙƒØ³ÙŠ", next: "taxi", points: 5},
          {text: "Ø±ÙƒÙˆØ¨ Ø§Ù„Ù…ØªØ±Ùˆ", next: "tube", points: 15},
          {text: "Ø·Ù„Ø¨ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª", next: "ask", points: 10}
        ],
        endings: {
          taxi: "You arrived quickly but spent too much money.",
          tube: "You got lost but met friendly people who helped you.",
          ask: "You practiced your English and found the hotel easily."
        }
      }
    ];
    
    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
    let speechSynthesis = window.speechSynthesis;
    let currentVoices = [];
    let isSpeaking = false;
    let recognition = null;
    let isRecording = false;
    let challengeTimer = null;
    let challengeTimeLeft = 60;
    
    // ==================== Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…ØªØ·ÙˆØ± ====================
    
    // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø·Ù‚
    function initSpeechSystem() {
      if (!speechSynthesis) {
        showNotification('Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø·Ù‚ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù…ØªØµÙØ­Ùƒ. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Chrome Ø£Ùˆ Edge.', 'error');
        return false;
      }
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
      loadVoices();
      
      // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù…
      initSpeechRecognition();
      
      return true;
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
    function loadVoices() {
      // Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª
      speechSynthesis.onvoiceschanged = function() {
        currentVoices = speechSynthesis.getVoices();
        console.log('Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:', currentVoices.length);
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©
        const britishVoices = currentVoices.filter(voice => 
          voice.lang.includes('en-GB') || voice.name.includes('British')
        );
        
        if (britishVoices.length > 0) {
          console.log('ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ØµÙˆØ§Øª Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©:', britishVoices.map(v => v.name));
        }
      };
      
      // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø£ØµÙˆØ§Øª Ù…Ø¨Ø§Ø´Ø±Ø©
      currentVoices = speechSynthesis.getVoices();
      if (currentVoices.length === 0) {
        setTimeout(loadVoices, 1000);
      }
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØµÙˆØª Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ
    function getBritishVoice() {
      if (currentVoices.length === 0) return null;
      
      // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙˆØª Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ
      const britishVoices = currentVoices.filter(voice => 
        voice.lang === 'en-GB' || 
        voice.name.includes('British') || 
        voice.name.includes('United Kingdom')
      );
      
      if (britishVoices.length > 0) {
        return britishVoices[0];
      }
      
      // Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø£ÙŠ ØµÙˆØª Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
      const englishVoices = currentVoices.filter(voice => 
        voice.lang.startsWith('en-')
      );
      
      return englishVoices.length > 0 ? englishVoices[0] : currentVoices[0];
    }
    
    // Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…ØªØ·ÙˆØ±
    function speakAdvanced(text, lang = 'en', options = {}) {
      if (!speechSynthesis) {
        showNotification('Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø·Ù‚ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…', 'error');
        return;
      }
      
      // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ù†Ø·Ù‚ Ø³Ø§Ø¨Ù‚
      speechSynthesis.cancel();
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯
      const utterance = new SpeechSynthesisUtterance(text);
      
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„ØºØ©
      if (options.accent === 'british') {
        utterance.lang = userData.voiceSettings.britishAccent;
        const britishVoice = getBritishVoice();
        if (britishVoice) {
          utterance.voice = britishVoice;
        }
      } else {
        utterance.lang = lang === 'ar' ? 'ar-SA' : 'en-US';
      }
      
      // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª
      utterance.rate = options.rate || userData.voiceSettings.rate;
      utterance.pitch = options.pitch || userData.voiceSettings.pitch;
      utterance.volume = options.volume || userData.voiceSettings.volume;
      
      // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù†Ø·Ù‚
      utterance.onstart = function() {
        isSpeaking = true;
      };
      
      utterance.onend = function() {
        isSpeaking = false;
      };
      
      utterance.onerror = function(event) {
        isSpeaking = false;
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø·Ù‚:', event);
        showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø·Ù‚. Ø¬Ø±Ø¨ Ù†ØµØ§Ù‹ Ø£Ù‚ØµØ±.', 'error');
      };
      
      // Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„Ù†Ø·Ù‚
      speechSynthesis.speak(utterance);
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª
    function updateVoiceSettings() {
      const rate = parseFloat(document.getElementById('rateSlider').value);
      const pitch = parseFloat(document.getElementById('pitchSlider').value);
      
      document.getElementById('rateValue').textContent = rate.toFixed(1);
      document.getElementById('pitchValue').textContent = pitch.toFixed(1);
      
      userData.voiceSettings.rate = rate;
      userData.voiceSettings.pitch = pitch;
      
      saveUserData();
    }
    
    // Ø§Ù„Ù†Ø·Ù‚ Ø¨Ø§Ù„Ù„ÙƒÙ†Ø© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©
    function speakWithBritishAccent() {
      const text = document.getElementById('practiceText').value || document.getElementById('textInput').value;
      if (!text.trim()) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„Ù†Ø·Ù‚', 'warning');
        return;
      }
      
      speakAdvanced(text, 'en', { accent: 'british' });
      showNotification('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø·Ù‚ Ø¨Ù„ÙƒÙ†Ø© Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©...', 'info');
    }
    
    // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ÙƒÙ†Ø© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©
    function selectBritishAccent() {
      const accent = document.getElementById('britishAccent').value;
      userData.voiceSettings.britishAccent = accent;
      saveUserData();
      showNotification(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ÙƒÙ†Ø©: ${accent}`, 'success');
    }
    
    // ==================== Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù… ====================
    
    // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù…
    function initSpeechRecognition() {
      if ('webkitSpeechRecognition' in window) {
        recognition = new webkitSpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.lang = 'en-US';
        
        recognition.onstart = function() {
          isRecording = true;
          document.getElementById('practiceButton').innerHTML = '<i class="fas fa-stop-circle"></i> Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„';
          showNotification('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹... ØªØ­Ø¯Ø« Ø§Ù„Ø¢Ù†', 'info');
        };
        
        recognition.onresult = function(event) {
          const transcript = event.results[0][0].transcript;
          document.getElementById('practiceText').value = transcript;
          
          // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø·Ù‚
          analyzePronunciationPractice(transcript);
        };
        
        recognition.onerror = function(event) {
          console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù…:', event.error);
          isRecording = false;
          document.getElementById('practiceButton').innerHTML = '<i class="fas fa-microphone"></i> Ø¨Ø¯Ø¡ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù†Ø·Ù‚';
        };
        
        recognition.onend = function() {
          isRecording = false;
          document.getElementById('practiceButton').innerHTML = '<i class="fas fa-microphone"></i> Ø¨Ø¯Ø¡ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù†Ø·Ù‚';
        };
      } else {
        console.log('Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­');
      }
    }
    
    // Ø¨Ø¯Ø¡ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù†Ø·Ù‚
    function startSpeechPractice() {
      if (!recognition) {
        showNotification('Ù…ÙŠØ²Ø© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ.', 'error');
        return;
      }
      
      if (isRecording) {
        recognition.stop();
        isRecording = false;
      } else {
        recognition.start();
        isRecording = true;
      }
    }
    
    // ØªØ­Ù„ÙŠÙ„ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù†Ø·Ù‚
    function analyzePronunciationPractice(spokenText) {
      const originalText = document.getElementById('practiceText').value.trim();
      if (!originalText) return;
      
      // Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†ØµÙˆØµ
      const spokenLower = spokenText.toLowerCase().trim();
      const originalLower = originalText.toLowerCase().trim();
      
      let accuracy = calculatePronunciationAccuracy(spokenLower, originalLower);
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªÙŠØ¬Ø©
      userData.pronunciationScore = Math.max(userData.pronunciationScore, accuracy);
      updatePronunciationProgress();
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
      const feedbackDiv = document.getElementById('pronunciationProgress');
      if (feedbackDiv) {
        feedbackDiv.innerHTML += `
          <div class="pronunciation-feedback ${accuracy >= 70 ? 'pronunciation-good' : 'pronunciation-needs-work'}">
            <strong>Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªÙ…Ø±ÙŠÙ†: ${accuracy}%</strong><br>
            <small>Ù†Ø·Ù‚Ùƒ: "${spokenText}"</small><br>
            <small>Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ: "${originalText}"</small>
          </div>
        `;
      }
      
      // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      saveUserData();
    }
    
    // Ø­Ø³Ø§Ø¨ Ø¯Ù‚Ø© Ø§Ù„Ù†Ø·Ù‚
    function calculatePronunciationAccuracy(spoken, original) {
      if (spoken === original) return 100;
      
      // Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ù„ÙŠÙÙ†Ø´ØªØ§ÙŠÙ† Ø§Ù„Ù…Ø¨Ø³Ø·Ø© Ù„Ù„Ù…Ø³Ø§ÙØ©
      const len1 = spoken.length;
      const len2 = original.length;
      const matrix = [];
      
      for (let i = 0; i <= len1; i++) {
        matrix[i] = [i];
      }
      
      for (let j = 0; j <= len2; j++) {
        matrix[0][j] = j;
      }
      
      for (let i = 1; i <= len1; i++) {
        for (let j = 1; j <= len2; j++) {
          const cost = spoken[i - 1] === original[j - 1] ? 0 : 1;
          matrix[i][j] = Math.min(
            matrix[i - 1][j] + 1,      // Ø­Ø°Ù
            matrix[i][j - 1] + 1,      // Ø¥Ø¯Ø±Ø§Ø¬
            matrix[i - 1][j - 1] + cost // Ø§Ø³ØªØ¨Ø¯Ø§Ù„
          );
        }
      }
      
      const distance = matrix[len1][len2];
      const maxLength = Math.max(len1, len2);
      const similarity = ((maxLength - distance) / maxLength) * 100;
      
      return Math.round(similarity);
    }
    
    // ØªØ­Ø¯ÙŠØ« ØªÙ‚Ø¯Ù… Ø§Ù„Ù†Ø·Ù‚
    function updatePronunciationProgress() {
      document.getElementById('pronunciationScore').textContent = userData.pronunciationScore + '%';
      document.getElementById('pronunciationProgressBar').style.width = userData.pronunciationScore + '%';
    }
    
    // Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ø·Ù‚
    function comparePronunciation() {
      const text = document.getElementById('practiceText').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©', 'warning');
        return;
      }
      
      // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ Ø£ÙˆÙ„Ø§Ù‹
      speakAdvanced(text, 'en', { accent: 'british', rate: 0.7 });
      
      // Ø«Ù… Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªÙƒØ±Ø§Ø±Ù‡
      setTimeout(() => {
        showNotification('Ø§Ù„Ø¢Ù† ÙƒØ±Ø± Ø§Ù„Ù†Øµ Ø¨Ø¹Ø¯ÙŠ...', 'info');
        startSpeechPractice();
      }, 2000);
    }
    
    // ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ====================
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    function initApp() {
      // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      const savedData = localStorage.getItem('englishLearnerData');
      if (savedData) {
        const parsed = JSON.parse(savedData);
        Object.assign(userData, parsed);
      }
      
      // ØªØ­Ø¯ÙŠØ« ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©
      const today = new Date().toDateString();
      if (userData.lastVisit !== today) {
        updateStreak(today);
      }
      
      // Ø²ÙŠØ§Ø¯Ø© ÙˆÙ‚Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø©
      userData.studyTime += 1;
      
      // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø·Ù‚
      initSpeechSystem();
      
      // ØªØ¹ÙŠÙŠÙ† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      setupUI();
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      updateStats();
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø®ØµÙŠØ©
      updateAvatar();
      
      // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯Ø§Ø± Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
      updateAchievementsWall();
      
      // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯Ø±ÙˆØ³
      loadAllLessons();
      
      // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      saveUserData();
      
      // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
      setTimeout(() => {
        showNotification('Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ± Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª!', 'info');
      }, 1000);
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯Ø±ÙˆØ³
    function loadAllLessons() {
      renderAllUnits();
      renderAllConversations();
      renderAllGrammar();
      renderPhoneticsTraining();
    }
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function setupUI() {
      // ØªØ­Ø¯ÙŠØ« Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª
      document.getElementById('rateSlider').value = userData.voiceSettings.rate;
      document.getElementById('pitchSlider').value = userData.voiceSettings.pitch;
      document.getElementById('rateValue').textContent = userData.voiceSettings.rate.toFixed(1);
      document.getElementById('pitchValue').textContent = userData.voiceSettings.pitch.toFixed(1);
      document.getElementById('britishAccent').value = userData.voiceSettings.britishAccent;
      
      // ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø¥Ø¶Ø§ÙÙŠ
      loadIraqiDictionary();
      loadSongList();
      loadParentDashboard();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©
    function updateStreak(today) {
      if (userData.lastVisit) {
        const lastVisitDate = new Date(userData.lastVisit);
        const todayDate = new Date(today);
        const diffTime = Math.abs(todayDate - lastVisitDate);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        
        if (diffDays === 1) {
          userData.streak++;
          showNotification(`Ø£Ø­Ø³Ù†Øª! ÙˆØ§ØµÙ„ Ø§Ù„ØªÙ‚Ø¯Ù…. Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©: ${userData.streak}`, 'success');
          checkAchievements();
        } else if (diffDays > 1) {
          userData.streak = 1;
          showNotification('Ù„Ù‚Ø¯ Ø¹Ø¯Øª! Ø§Ø¨Ø¯Ø£ Ø³Ù„Ø³Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø§Ù„ØªØ¹Ù„Ù….', 'warning');
        }
      } else {
        userData.streak = 1;
      }
      
      userData.lastVisit = today;
    }
    
    // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function saveUserData() {
      localStorage.setItem('englishLearnerData', JSON.stringify(userData));
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    function updateStats() {
      // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
      let totalWords = 0;
      for (const grade in allLessons) {
        totalWords += allLessons[grade].lessons.length;
      }
      totalWords += userData.customWords.length;
      document.getElementById('totalWords').textContent = totalWords;
      
      // Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
      const avgScore = userData.quizScores.length > 0 ? 
        Math.round(userData.quizScores.reduce((a, b) => a + b, 0) / userData.quizScores.length) : 0;
      document.getElementById('quizScore').textContent = `${avgScore}%`;
      
      // Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©
      document.getElementById('streakDays').textContent = userData.streak;
      
      // Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
      document.getElementById('achievements').textContent = userData.achievements.length;
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
      const autoTranslations = userData.customWords.filter(word => word.category === 'Ù…ØªØ±Ø¬Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ').length;
      
      // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª
      const dashboardCards = document.querySelector('.dashboard');
      if (dashboardCards && !document.getElementById('translationsCard')) {
        dashboardCards.innerHTML += `
          <div class="dashboard-card" id="translationsCard">
            <i class="fas fa-language" style="font-size: 36px; color: var(--purple); margin-bottom: 10px;"></i>
            <div class="stat-value" id="totalTranslations">${autoTranslations}</div>
            <div class="stat-label">ØªØ±Ø¬Ù…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</div>
          </div>
        `;
      } else if (document.getElementById('totalTranslations')) {
        document.getElementById('totalTranslations').textContent = autoTranslations;
      }
      
      // ØªØ­Ø¯ÙŠØ« ØªÙ‚Ø¯Ù… Ø§Ù„Ù†Ø·Ù‚
      updatePronunciationProgress();
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø®ØµÙŠØ©
      updateAvatar();
      
      // ÙØ­Øµ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
      checkAchievements();
      
      // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©
      updateCustomWordsList();
      
      // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
      updateParentDashboard();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø®ØµÙŠØ©
    function updateAvatar() {
      const avatar = userData.avatar;
      const totalWords = userData.learnedWords.length + userData.customWords.length;
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      const newLevel = Math.min(10, Math.floor(totalWords / 10) + 1);
      if (newLevel > avatar.level) {
        avatar.level = newLevel;
        const newItems = [
          "ğŸ“ Ù‚Ø¨Ø¹Ø© ØªØ®Ø±Ø¬",
          "ğŸ‘” Ø±Ø¨Ø·Ø© Ø¹Ù†Ù‚",
          "ğŸ•¶ï¸ Ù†Ø¸Ø§Ø±Ø§Øª Ø´Ù…Ø³",
          "ğŸ’¼ Ø­Ù‚ÙŠØ¨Ø© Ø¬Ù„Ø¯",
          "âŒš Ø³Ø§Ø¹Ø© Ø°ÙƒÙŠØ©",
          "ğŸ“± Ù‡Ø§ØªÙ Ø­Ø¯ÙŠØ«",
          "ğŸ’» Ù„Ø§Ø¨ØªÙˆØ¨",
          "ğŸš— Ø³ÙŠØ§Ø±Ø© Ø±ÙŠØ§Ø¶ÙŠØ©",
          "ğŸ  Ù…Ù†Ø²Ù„ ÙƒØ¨ÙŠØ±",
          "ğŸ‘‘ ØªØ§Ø¬ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²"
        ];
        
        if (newLevel <= newItems.length) {
          const newItem = newItems[newLevel - 1];
          if (!avatar.unlockedItems.includes(newItem)) {
            avatar.unlockedItems.push(newItem);
            avatar.items.push(newItem);
            showNotification(`ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ù…Ø³ØªÙˆÙ‰ ${newLevel} ÙˆÙØ²Øª Ø¨Ù€ ${newItem}!`, 'success');
          }
        }
      }
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      if (avatar.level >= 5) avatar.name = "Ø·Ø§Ù„Ø¨ Ù…ØªÙ…ÙŠØ²";
      if (avatar.level >= 8) avatar.name = "Ø®Ø¨ÙŠØ± Ø§Ù„Ù„ØºØ©";
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø¯Ù…
      avatar.progress = (totalWords % 10) * 10;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      document.getElementById('avatarName').textContent = avatar.name;
      document.getElementById('avatarLevel').textContent = `Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${avatar.level}`;
      document.getElementById('avatarProgressValue').textContent = `${avatar.progress}%`;
      document.getElementById('avatarProgressBar').style.width = `${avatar.progress}%`;
      document.getElementById('avatarImage').style.background = avatar.avatarColor;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ±
      const itemsContainer = document.getElementById('avatarItems');
      itemsContainer.innerHTML = '';
      avatar.items.slice(-3).forEach(item => {
        const span = document.createElement('span');
        span.className = 'avatar-item';
        span.textContent = item;
        itemsContainer.appendChild(span);
      });
      
      saveUserData();
    }
    
    // ==================== Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯ ====================
    
    // Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª (Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)
    async function translateText() {
      const text = document.getElementById('textInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„ØªØ±Ø¬Ù…Ø©', 'warning');
        return;
      }

      const outputDiv = document.getElementById('output');
      outputDiv.innerHTML = `
        <div style="text-align: center; padding: 20px;">
          <i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ±Ø¬Ù…Ø©...
        </div>
      `;

      try {
        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…ØµØ¯Ø± ÙˆØ§Ù„Ù‡Ø¯Ù
        const isArabic = /[\u0600-\u06FF]/.test(text);
        const sourceLang = isArabic ? 'ar' : 'en';
        const targetLang = isArabic ? 'en' : 'ar';

        // Ø§Ø³ØªØ®Ø¯Ø§Ù… MyMemory API (Ù…Ø¬Ø§Ù†ÙŠ ÙˆÙ„Ø§ ÙŠØ­ØªØ§Ø¬ Ù„Ù…ÙØªØ§Ø­ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©)
        const response = await fetch(
          `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${sourceLang}|${targetLang}`
        );

        if (!response.ok) {
          throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©: ${response.status}`);
        }

        const data = await response.json();

        if (data.responseStatus !== 200) {
          throw new Error(data.responseDetails || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ±Ø¬Ù…Ø©');
        }

        const translatedText = data.responseData.translatedText;

        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
        outputDiv.innerHTML = `
          <div class="pronunciation-good" style="padding: 15px;">
            <strong>Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ (${sourceLang === 'ar' ? 'Ø¹Ø±Ø¨ÙŠ' : 'Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ'}):</strong><br>
            <div style="padding: 8px; background: #f0f0f0; border-radius: 5px; margin: 8px 0;">${text}</div>
            
            <strong>Ø§Ù„ØªØ±Ø¬Ù…Ø© (${targetLang === 'ar' ? 'Ø¹Ø±Ø¨ÙŠ' : 'Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ'}):</strong><br>
            <div style="padding: 8px; background: #e8f5e9; border-radius: 5px; margin: 8px 0; font-weight: bold;">${translatedText}</div>
            
            <div style="margin-top: 15px; text-align: center;">
              <button class="btn-primary" onclick="speakAdvanced('${translatedText.replace(/'/g, "\\'")}', '${targetLang}')">
                <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø©
              </button>
              <button class="btn-secondary" onclick="addTranslationToVocabulary('${text.replace(/'/g, "\\'")}', '${translatedText.replace(/'/g, "\\'")}')">
                <i class="fas fa-save"></i> Ø­ÙØ¸ ÙÙŠ Ù…ÙØ±Ø¯Ø§ØªÙŠ
              </button>
            </div>
            
            <div style="font-size: 12px; color: #666; margin-top: 10px; text-align: center;">
              <i class="fas fa-info-circle"></i> ØªÙ…Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… MyMemory Translation API
            </div>
          </div>
        `;

      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ±Ø¬Ù…Ø©:', error);
        outputDiv.innerHTML = `
          <div class="pronunciation-needs-work" style="padding: 15px;">
            <h4><i class="fas fa-exclamation-triangle"></i> ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</h4>
            <p>${error.message || 'ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø©'}</p>
            <p>Ø¬Ø±Ø¨ Ø£Ø­Ø¯ Ø§Ù„Ø­Ù„ÙˆÙ„:</p>
            <ol style="text-align: right; margin-right: 15px;">
              <li>ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</li>
              <li>Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ù‚Ù„ÙŠÙ„</li>
              <li>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© (Ø³ÙŠØªÙ… Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)</li>
            </ol>
            <button class="btn-warning" onclick="translateWithLocalDatabase()" style="margin-top: 10px;">
              <i class="fas fa-database"></i> Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
            </button>
          </div>
        `;
      }
    }
    
    // ØªØ±Ø¬Ù…Ø© Ø¨Ø¯ÙŠÙ„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    function translateWithLocalDatabase() {
      const text = document.getElementById('textInput').value.trim();
      if (!text) return;

      const isArabic = /[\u0600-\u06FF]/.test(text);
      let foundTranslation = null;
      let foundWord = null;

      // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
      for (const grade in allLessons) {
        for (const lesson of allLessons[grade].lessons) {
          if (isArabic && lesson.ar === text) {
            foundTranslation = lesson.en;
            foundWord = lesson;
            break;
          } else if (!isArabic && lesson.en.toLowerCase() === text.toLowerCase()) {
            foundTranslation = lesson.ar;
            foundWord = lesson;
            break;
          }
        }
        if (foundTranslation) break;
      }

      // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©
      if (!foundTranslation) {
        for (const word of userData.customWords) {
          if (isArabic && word.ar === text) {
            foundTranslation = word.en;
            foundWord = word;
            break;
          } else if (!isArabic && word.en.toLowerCase() === text.toLowerCase()) {
            foundTranslation = word.ar;
            foundWord = word;
            break;
          }
        }
      }

      const output = document.getElementById('output');
      if (foundTranslation) {
        output.innerHTML = `
          <div class="pronunciation-good" style="padding: 15px;">
            <strong>ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØ±Ø¬Ù…Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©:</strong><br>
            <div style="margin: 15px 0; padding: 10px; background: #f0f8ff; border-radius: 8px;">
              <div style="font-size: 18px; font-weight: bold; color: var(--primary-color);">${text}</div>
              <div style="font-size: 20px; color: var(--success-color); margin: 10px 0;">â†’</div>
              <div style="font-size: 18px; font-weight: bold;">${foundTranslation}</div>
            </div>
            
            ${foundWord && foundWord.ipa ? `
              <div class="ipa-transcription" style="text-align: center; margin: 10px 0;">
                <strong>Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµÙˆØªÙŠ:</strong> ${foundWord.ipa}
              </div>
            ` : ''}
            
            ${foundWord && foundWord.example ? `
              <div class="example" style="margin: 10px 0;">
                <strong>Ù…Ø«Ø§Ù„:</strong> ${foundWord.example}
              </div>
            ` : ''}
            
            <div style="text-align: center; margin-top: 15px;">
              <button class="btn-primary" onclick="speakAdvanced('${isArabic ? foundTranslation.replace(/'/g, "\\'") : text.replace(/'/g, "\\'")}', '${isArabic ? 'en' : 'ar'}')">
                <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ ${isArabic ? 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'}
              </button>
              <button class="btn-secondary" onclick="addTranslationToVocabulary('${text.replace(/'/g, "\\'")}', '${foundTranslation.replace(/'/g, "\\'")}')">
                <i class="fas fa-save"></i> Ø­ÙØ¸ ÙÙŠ Ù…ÙØ±Ø¯Ø§ØªÙŠ
              </button>
            </div>
          </div>
        `;
      } else {
        output.innerHTML = `
          <div class="pronunciation-needs-work" style="padding: 15px;">
            <strong>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØ±Ø¬Ù…Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©</strong><br>
            <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„ÙƒÙ„Ù…Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù† Ø®Ù„Ø§Ù„ ØªØ¨ÙˆÙŠØ¨ "Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰"</p>
            <div style="text-align: center; margin-top: 15px;">
              <button class="btn-primary" onclick="showTab('tab7')">
                <i class="fas fa-plus-circle"></i> Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰
              </button>
            </div>
          </div>
        `;
      }
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù„Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
    function addTranslationToVocabulary(originalText, translatedText) {
      const isArabic = /[\u0600-\u06FF]/.test(originalText);
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹
      const alreadyExists = userData.customWords.some(word => 
        word.en === (isArabic ? translatedText : originalText) && 
        word.ar === (isArabic ? originalText : translatedText)
      );
      
      if (alreadyExists) {
        showNotification('Ù‡Ø°Ù‡ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù…ÙØ±Ø¯Ø§ØªÙƒ!', 'warning');
        return;
      }
      
      const newWord = {
        en: isArabic ? translatedText : originalText,
        ar: isArabic ? originalText : translatedText,
        category: 'Ù…ØªØ±Ø¬Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ',
        unit: 'ØªØ±Ø¬Ù…Ø§Øª Ù…Ø¶Ø§ÙØ©',
        example: `${originalText} â†’ ${translatedText}`,
        dateAdded: new Date().toISOString()
      };
      
      userData.customWords.push(newWord);
      updateCustomWordsList();
      updateStats();
      saveUserData();
      
      showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© "${isArabic ? translatedText : originalText}" Ù„Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©!`, 'success');
    }
    
    // ØªØ±Ø¬Ù…Ø© Ù†Øµ Ø·ÙˆÙŠÙ„
    async function translateLongText() {
      const text = document.getElementById('textInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„ØªØ±Ø¬Ù…Ø©', 'warning');
        return;
      }
      
      if (text.length < 50) {
        // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© Ù„Ù„Ù†ØµÙˆØµ Ø§Ù„Ù‚ØµÙŠØ±Ø©
        translateText();
        return;
      }
      
      const outputDiv = document.getElementById('output');
      outputDiv.innerHTML = `
        <div style="text-align: center; padding: 20px;">
          <i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„... Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ø¨Ø¶Ø¹ Ø«ÙˆØ§Ù†Ù
        </div>
      `;
      
      try {
        // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø¬Ù…Ù„
        const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
        const isArabic = /[\u0600-\u06FF]/.test(text);
        const sourceLang = isArabic ? 'ar' : 'en';
        const targetLang = isArabic ? 'en' : 'ar';
        
        let translatedText = '';
        
        // ØªØ±Ø¬Ù…Ø© ÙƒÙ„ Ø¬Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø­Ø¯Ø©
        for (let i = 0; i < sentences.length; i++) {
          const sentence = sentences[i].trim();
          if (sentence) {
            const response = await fetch(
              `https://api.mymemory.translated.net/get?q=${encodeURIComponent(sentence)}&langpair=${sourceLang}|${targetLang}`
            );
            
            if (response.ok) {
              const data = await response.json();
              if (data.responseStatus === 200) {
                translatedText += data.responseData.translatedText + '. ';
              } else {
                translatedText += `[Ø®Ø·Ø£ ÙÙŠ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¬Ù…Ù„Ø© ${i + 1}] `;
              }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            const progress = Math.round(((i + 1) / sentences.length) * 100);
            outputDiv.innerHTML = `
              <div style="text-align: center; padding: 20px;">
                <i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ...<br>
                ${i + 1} / ${sentences.length} Ø¬Ù…Ù„Ø©<br>
                <div class="progress-bar">
                  <div class="progress" style="width: ${progress}%"></div>
                </div>
              </div>
            `;
          }
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
        outputDiv.innerHTML = `
          <div class="pronunciation-good" style="padding: 15px;">
            <strong>Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ (${text.length} Ø­Ø±Ù):</strong><br>
            <div style="padding: 8px; background: #f0f0f0; border-radius: 5px; margin: 8px 0; max-height: 150px; overflow-y: auto;">
              ${text}
            </div>
            
            <strong>Ø§Ù„ØªØ±Ø¬Ù…Ø©:</strong><br>
            <div style="padding: 8px; background: #e8f5e9; border-radius: 5px; margin: 8px 0; max-height: 150px; overflow-y: auto; font-weight: bold;">
              ${translatedText}
            </div>
            
            <div style="margin-top: 15px; text-align: center;">
              <button class="btn-primary" onclick="speakAdvanced('${translatedText.replace(/'/g, "\\'").substring(0, 100)}', '${targetLang}')">
                <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„ØªØ±Ø¬Ù…Ø©
              </button>
              <button class="btn-secondary" onclick="saveLongTranslation('${text.replace(/'/g, "\\'")}', '${translatedText.replace(/'/g, "\\'")}')">
                <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªØ±Ø¬Ù…Ø©
              </button>
            </div>
            
            <div style="font-size: 12px; color: #666; margin-top: 10px; text-align: center;">
              <i class="fas fa-info-circle"></i> ØªÙ…Øª ØªØ±Ø¬Ù…Ø© ${sentences.length} Ø¬Ù…Ù„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… MyMemory API
            </div>
          </div>
        `;
        
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„:', error);
        outputDiv.innerHTML = `
          <div class="pronunciation-needs-work" style="padding: 15px;">
            <h4><i class="fas fa-exclamation-triangle"></i> ÙØ´Ù„ ÙÙŠ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„</h4>
            <p>${error.message || 'ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø©'}</p>
            <button class="btn-warning" onclick="translateText()">
              <i class="fas fa-redo"></i> Ø­Ø§ÙˆÙ„ ØªØ±Ø¬Ù…Ø© Ù†Øµ Ø£Ù‚ØµØ±
            </button>
          </div>
        `;
      }
    }
    
    function saveLongTranslation(originalText, translatedText) {
      // Ø­ÙØ¸ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø·ÙˆÙŠÙ„Ø© ÙƒÙ…Ù„Ù Ù†ØµÙŠ
      const blob = new Blob([
        `Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ:\n${originalText}\n\n`,
        `Ø§Ù„ØªØ±Ø¬Ù…Ø©:\n${translatedText}\n\n`,
        `ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ±Ø¬Ù…Ø©: ${new Date().toLocaleString('ar-SA')}\n`,
        `Ø¨Ø±Ù†Ø§Ù…Ø¬: Ù…Ù†Ù‡Ø¬ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±`
      ], { type: 'text/plain;charset=utf-8' });
      
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `ØªØ±Ø¬Ù…Ø©_${new Date().getTime()}.txt`;
      link.click();
      
      showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙƒÙ…Ù„Ù Ù†ØµÙŠ!', 'success');
    }
    
    // ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ====================
    
    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
    function showTab(tabId) {
      // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
      document.getElementById(tabId).classList.add('active');
      
      // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø²Ø± Ø§Ù„Ù†Ø´Ø·
      event.currentTarget.classList.add('active');
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
      if (tabId === 'tab2') {
        renderAllUnits();
      } else if (tabId === 'tab4') {
        renderAllConversations();
      } else if (tabId === 'tab5') {
        renderAllGrammar();
      } else if (tabId === 'tab6') {
        renderPhoneticsTraining();
      } else if (tabId === 'tab7') {
        updateCustomWordsList();
      } else if (tabId === 'tab9') {
        loadPronunciationHistory();
      } else if (tabId === 'tab10') {
        loadIraqiDictionary();
      } else if (tabId === 'tab11') {
        loadSongLyrics();
      } else if (tabId === 'tab12') {
        if (!userData.profession) {
          document.getElementById('professionContent').innerHTML = `
            <div class="hint">
              <i class="fas fa-info-circle"></i> Ø§Ø®ØªØ± Ù…Ù‡Ù†Ø© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù…ØªØ®ØµØµ.
            </div>
          `;
        }
      } else if (tabId === 'tab13') {
        loadAIHistory();
      } else if (tabId === 'tab14') {
        loadLeaderboard();
      } else if (tabId === 'tab15') {
        loadParentDashboard();
      }
    }
    
    // Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
    function speakText(lang) {
      const text = document.getElementById('textInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„Ù†Ø·Ù‚', 'warning');
        return;
      }
      
      speakAdvanced(text, lang);
    }
    
    // Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø·ÙŠØ¡
    function speakSlowly() {
      const text = document.getElementById('textInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„Ù†Ø·Ù‚', 'warning');
        return;
      }
      
      speakAdvanced(text, 'en', { rate: 0.6 });
    }
    
    // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ
    function analyzeText() {
      const text = document.getElementById('textInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„ØªØ­Ù„ÙŠÙ„', 'warning');
        return;
      }
      
      const isArabic = /[\u0600-\u06FF]/.test(text);
      const words = text.split(/\s+/).length;
      const chars = text.length;
      
      let analysis = `
        <strong>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ:</strong><br>
        - Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª: ${words}<br>
        - Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø­Ø±Ù: ${chars}<br>
        - Ø§Ù„Ù„ØºØ©: ${isArabic ? 'Ø¹Ø±Ø¨ÙŠØ©' : 'Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©'}<br>
      `;
      
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†Øµ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ§Ù‹ØŒ Ø£Ø¶Ù ØªØ­Ù„ÙŠÙ„ ØµÙˆØªÙŠ
      if (!isArabic) {
        analysis += `<br><strong>Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµÙˆØªÙŠ (IPA):</strong><br>`;
        
        // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª ÙˆØªØ­Ù„ÙŠÙ„ ÙƒÙ„ ÙƒÙ„Ù…Ø©
        const englishWords = text.toLowerCase().split(/\s+/);
        englishWords.forEach(word => {
          // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµÙˆØªÙŠ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          let ipa = findIPATranscription(word);
          if (ipa) {
            analysis += `<div class="ipa-transcription">${word} â†’ ${ipa}</div>`;
          }
        });
      }
      
      document.getElementById('output').innerHTML = analysis;
    }
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµÙˆØªÙŠ
    function findIPATranscription(word) {
      for (const grade in allLessons) {
        for (const lesson of allLessons[grade].lessons) {
          if (lesson.en.toLowerCase() === word.toLowerCase()) {
            return lesson.ipa || 'ØºÙŠØ± Ù…ØªÙˆÙØ±';
          }
        }
      }
      return null;
    }
    
    // ==================== Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ====================
    
    // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
    function renderAllUnits() {
      const container = document.getElementById('unitsContent');
      if (!container) return;
      
      container.innerHTML = '';
      
      // Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯Ø±ÙˆØ³ Ù…Ù† ÙƒÙ„ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
      let allLessonsCombined = [];
      for (const grade in allLessons) {
        allLessonsCombined = allLessonsCombined.concat(allLessons[grade].lessons);
      }
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø®ØµØµØ©
      allLessonsCombined = allLessonsCombined.concat(userData.customWords);
      
      const units = [...new Set(allLessonsCombined.map(item => item.unit))];
      
      if (units.length === 0) {
        container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ­Ø¯Ø§Øª Ø¨Ø¹Ø¯.</div>';
        return;
      }
      
      units.forEach(unit => {
        const unitLessons = allLessonsCombined.filter(item => item.unit === unit);
        const unitDiv = document.createElement('div');
        unitDiv.className = 'unit-card';
        
        const learnedInUnit = unitLessons.filter(item => userData.learnedWords.includes(item.en)).length;
        const unitProgress = Math.round((learnedInUnit / unitLessons.length) * 100);
        
        unitDiv.innerHTML = `
          <h4 class="unit-title">
            <i class="fas fa-bookmark"></i> ${unit}
            <span style="margin-right: auto; font-size: 14px; color: ${unitProgress === 100 ? 'var(--success-color)' : 'var(--accent-color)'}">
              ${unitProgress}% Ù…ÙƒØªÙ…Ù„
            </span>
          </h4>
          <div class="progress-bar">
            <div class="progress" style="width: ${unitProgress}%"></div>
          </div>
          <div class="unit-lessons">
            ${unitLessons.map(lesson => {
              const isLearned = userData.learnedWords.includes(lesson.en);
              return `
                <div class="lesson-card" onclick="showLessonDetail('${lesson.en.replace(/'/g, "\\'")}')">
                  <div style="font-weight: bold; color: var(--primary-color);">${lesson.en}</div>
                  <div style="font-size: 14px; color: #666;">${lesson.ar}</div>
                  ${lesson.ipa ? `<div class="ipa-transcription">${lesson.ipa}</div>` : ''}
                  <div style="margin-top: 5px;">
                    ${isLearned ? 
                      '<span style="color: var(--success-color);"><i class="fas fa-check-circle"></i> Ù…ØªÙ…ÙƒÙ†</span>' : 
                      '<span style="color: var(--accent-color);"><i class="fas fa-clock"></i> Ù‚ÙŠØ¯ Ø§Ù„ØªØ¹Ù„Ù…</span>'}
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        `;
        
        container.appendChild(unitDiv);
      });
    }
    
    // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
    function renderAllConversations() {
      const container = document.getElementById('conversationsContent');
      if (!container) return;
      
      container.innerHTML = '';
      
      // Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù…Ù† ÙƒÙ„ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
      let allConversations = [];
      for (const grade in conversations) {
        allConversations = allConversations.concat(conversations[grade]);
      }
      
      if (allConversations.length === 0) {
        container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø¨Ø¹Ø¯.</div>';
        return;
      }
      
      allConversations.forEach((conv, index) => {
        const convDiv = document.createElement('div');
        convDiv.className = 'conversation-item';
        
        convDiv.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <h4 style="margin: 0; color: var(--primary-color);">${conv.title || 'Ù…Ø­Ø§Ø¯Ø«Ø©'}</h4>
            <button class="btn-icon" onclick="playConversation(${index})" title="ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©">
              <i class="fas fa-play-circle"></i>
            </button>
          </div>
          <div class="conversation-en">${conv.en}</div>
          <div class="conversation-ar">${conv.ar}</div>
          <div style="margin-top: 15px; text-align: center;">
            <button class="btn-icon" onclick="speakAdvanced('${conv.en.replace(/'/g, "\\'")}', 'en')" title="Ù†Ø·Ù‚ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©">
              <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø¹Ø§Ø¯ÙŠ
            </button>
            <button class="btn-icon" onclick="speakAdvanced('${conv.en.replace(/'/g, "\\'")}', 'en', {accent: 'british'})" title="Ù†Ø·Ù‚ Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ">
              <i class="fas fa-crown"></i> Ù†Ø·Ù‚ Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ
            </button>
            <button class="btn-primary" onclick="practiceConversation('${conv.en.replace(/'/g, "\\'")}')">
              <i class="fas fa-microphone"></i> ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø·Ù‚
            </button>
          </div>
        `;
        
        container.appendChild(convDiv);
      });
    }
    
    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
    function playConversation(index) {
      // Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
      let allConversations = [];
      for (const grade in conversations) {
        allConversations = allConversations.concat(conversations[grade]);
      }
      
      if (index >= allConversations.length) return;
      
      const conv = allConversations[index];
      
      // Ù†Ø·Ù‚ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø«Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
      speakAdvanced(conv.en, 'en', { accent: 'british' });
      
      setTimeout(() => {
        speakAdvanced(conv.ar, 'ar');
      }, 2000);
    }
    
    // Ø§Ù„ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
    function practiceConversation(text) {
      document.getElementById('textInput').value = text;
      showNotification('Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ù†ÙØ³Ùƒ ÙÙŠ Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙˆØ­Ø§ÙˆÙ„ Ù†Ø·Ù‚Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.', 'info');
      showTab('tab1');
    }
    
    // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯
    function renderAllGrammar() {
      const container = document.getElementById('grammarContent');
      if (!container) return;
      
      container.innerHTML = '';
      
      // Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ù…Ù† ÙƒÙ„ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
      let allGrammar = [];
      for (const grade in grammarRules) {
        allGrammar = allGrammar.concat(grammarRules[grade]);
      }
      
      if (allGrammar.length === 0) {
        container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ÙˆØ§Ø¹Ø¯ Ø¨Ø¹Ø¯.</div>';
        return;
      }
      
      allGrammar.forEach(rule => {
        const ruleDiv = document.createElement('div');
        ruleDiv.className = 'grammar-rule';
        
        ruleDiv.innerHTML = `
          <h4 style="margin-top: 0; color: var(--primary-color);">${rule.title}</h4>
          <div style="font-weight: bold; margin-bottom: 10px;">${rule.rule}</div>
          <div style="font-weight: bold; margin-bottom: 5px;">Ø£Ù…Ø«Ù„Ø©:</div>
          ${rule.examples.map(example => `
            <div class="example">${example}</div>
          `).join('')}
        `;
        
        container.appendChild(ruleDiv);
      });
    }
    
    // Ø¹Ø±Ø¶ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ØµÙˆØªÙŠ
    function renderPhoneticsTraining() {
      const container = document.getElementById('phoneticsTraining');
      if (!container) return;
      
      const phonetics = [
        { sound: 'Î¸', example: 'think', ar: 'Ø«ÙŠÙ†Ùƒ', ipa: '/Î¸ÉªÅ‹k/' },
        { sound: 'Ã°', example: 'this', ar: 'Ø°ÙŠØ³', ipa: '/Ã°Éªs/' },
        { sound: 'Êƒ', example: 'she', ar: 'Ø´ÙŠ', ipa: '/ÊƒiË/' },
        { sound: 'Ê’', example: 'pleasure', ar: 'Ø¨Ù„ÙŠØ²Ø±', ipa: '/ËˆpleÊ’É™(r)/' },
        { sound: 'tÊƒ', example: 'church', ar: 'ØªØ´ÙŠØ±ØªØ´', ipa: '/tÊƒÉœËtÊƒ/' },
        { sound: 'dÊ’', example: 'judge', ar: 'Ø¬Ø§Ø¯Ø¬', ipa: '/dÊ’ÊŒdÊ’/' },
        { sound: 'Å‹', example: 'sing', ar: 'Ø³ÙŠÙ†Ø¬', ipa: '/sÉªÅ‹/' },
        { sound: 'É™', example: 'about', ar: 'Ø£Ø¨Ø§ÙˆØª', ipa: '/É™ËˆbaÊŠt/' }
      ];
      
      container.innerHTML = `
        <p>ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„ØµØ¹Ø¨Ø© ÙÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©:</p>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
          ${phonetics.map(phone => `
            <div class="lesson-card" onclick="speakAdvanced('${phone.example}', 'en', {accent: 'british'})">
              <div style="font-size: 24px; color: var(--primary-color);">${phone.sound}</div>
              <div style="font-weight: bold;">${phone.example}</div>
              <div style="font-size: 12px; color: #666;">${phone.ar}</div>
              <div class="ipa-transcription">${phone.ipa}</div>
            </div>
          `).join('')}
        </div>
        <div style="margin-top: 20px; text-align: center;">
          <button class="btn-primary" onclick="startPhoneticsDrill()">
            <i class="fas fa-play-circle"></i> Ø¨Ø¯Ø¡ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø£ØµÙˆØ§Øª
          </button>
        </div>
      `;
    }
    
    // Ø¨Ø¯Ø¡ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø£ØµÙˆØ§Øª
    function startPhoneticsDrill() {
      const phonetics = [
        'think', 'this', 'she', 'pleasure', 'church', 'judge', 'sing', 'about'
      ];
      
      let currentIndex = 0;
      
      function playNextSound() {
        if (currentIndex >= phonetics.length) {
          showNotification('Ø§Ù†ØªÙ‡Ù‰ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø£ØµÙˆØ§Øª! Ø£Ø­Ø³Ù†Øª!', 'success');
          return;
        }
        
        const word = phonetics[currentIndex];
        speakAdvanced(word, 'en', { accent: 'british', rate: 0.7 });
        
        setTimeout(() => {
          currentIndex++;
          if (currentIndex < phonetics.length) {
            setTimeout(playNextSound, 2000);
          }
        }, 1500);
      }
      
      playNextSound();
      showNotification('Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ©... ÙƒØ±Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ù…Ø§Ø¹', 'info');
    }
    
    // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯Ø±Ø³
    function showLessonDetail(word) {
      let lesson;
      for (const grade in allLessons) {
        const found = allLessons[grade].lessons.find(item => item.en === word);
        if (found) {
          lesson = found;
          break;
        }
      }
      
      if (!lesson) {
        lesson = userData.customWords.find(item => item.en === word);
      }
      
      if (lesson) {
        document.getElementById('textInput').value = lesson.en;
        
        const output = document.getElementById('output');
        output.innerHTML = `
          <strong>ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø©/Ø§Ù„Ø¬Ù…Ù„Ø©:</strong><br><br>
          <div style="margin-bottom: 10px;">
            <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);">${lesson.en}</div>
            <div style="font-size: 18px; color: #555;">${lesson.ar}</div>
            ${lesson.ipa ? `<div class="ipa-transcription" style="font-size: 16px; margin-top: 5px;">Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµÙˆØªÙŠ: ${lesson.ipa}</div>` : ''}
          </div>
          <div style="background: #f9f9f9; padding: 10px; border-radius: 8px;">
            <strong>Ø§Ù„ØªØµÙ†ÙŠÙ:</strong> ${lesson.category}<br>
            <strong>Ø§Ù„ÙˆØ­Ø¯Ø©:</strong> ${lesson.unit || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}<br>
            <strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${userData.learnedWords.includes(lesson.en) ? 'âœ… Ù…ØªÙ…ÙƒÙ†' : 'â³ Ù‚ÙŠØ¯ Ø§Ù„ØªØ¹Ù„Ù…'}
          </div>
          ${lesson.example ? `<div class="example" style="margin-top: 10px;">Ù…Ø«Ø§Ù„: ${lesson.example}</div>` : ''}
          <div style="margin-top: 15px; text-align: center;">
            <button class="btn-icon" onclick="speakAdvanced('${lesson.en.replace(/'/g, "\\'")}', 'en')" title="Ù†Ø·Ù‚ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ">
              <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø¹Ø§Ø¯ÙŠ
            </button>
            <button class="btn-icon" onclick="speakAdvanced('${lesson.en.replace(/'/g, "\\'")}', 'en', {accent: 'british'})" title="Ù†Ø·Ù‚ Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ">
              <i class="fas fa-crown"></i> Ù†Ø·Ù‚ Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ
            </button>
            <button class="btn-primary" onclick="toggleLearned('${lesson.en.replace(/'/g, "\\'")}')">
              ${userData.learnedWords.includes(lesson.en) ? 'Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ØªØ¹Ù„Ù…' : 'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ØªØ¹Ù„Ù…'}
            </button>
          </div>
        `;
        
        showTab('tab1');
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©
    function updateCustomWordsList() {
      const container = document.getElementById('customWordsContent');
      if (!container) return;
      
      if (userData.customWords.length === 0) {
        container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…Ø­ØªÙˆÙ‰ Ø¨Ø¹Ø¯.</div>';
        return;
      }
      
      // ÙØµÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù† Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
      const autoTranslations = userData.customWords.filter(word => word.category === 'Ù…ØªØ±Ø¬Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ');
      const manualAdditions = userData.customWords.filter(word => word.category !== 'Ù…ØªØ±Ø¬Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ');
      
      container.innerHTML = '';
      
      if (manualAdditions.length > 0) {
        container.innerHTML += '<h5><i class="fas fa-pen"></i> Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ§Ù‹:</h5>';
        manualAdditions.forEach((word, index) => {
          const originalIndex = userData.customWords.indexOf(word);
          container.innerHTML += renderCustomWordItem(word, originalIndex);
        });
      }
      
      if (autoTranslations.length > 0) {
        container.innerHTML += '<h5 style="margin-top: 20px;"><i class="fas fa-robot"></i> Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©:</h5>';
        autoTranslations.forEach((word, index) => {
          const originalIndex = userData.customWords.indexOf(word);
          container.innerHTML += renderCustomWordItem(word, originalIndex);
        });
      }
      
      // Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      container.innerHTML += `
        <div class="stats" style="margin-top: 20px;">
          <div class="stat-item">
            <div class="stat-value">${manualAdditions.length}</div>
            <div class="stat-label">ÙŠØ¯ÙˆÙŠØ©</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${autoTranslations.length}</div>
            <div class="stat-label">ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${userData.customWords.length}</div>
            <div class="stat-label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div>
          </div>
        </div>
      `;
    }
    
    function renderCustomWordItem(word, index) {
      return `
        <div class="lesson-item">
          <div class="word-container">
            <div class="word-en">${word.en}</div>
            <div class="word-ar">${word.ar}</div>
            <div>
              <small>${word.unit || 'Ø¨Ø¯ÙˆÙ† ÙˆØ­Ø¯Ø©'} | 
              <span style="color: ${word.category === 'Ù…ØªØ±Ø¬Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ' ? 'var(--purple)' : 'var(--primary-color)'}">
                ${word.category}
              </span>
              ${word.dateAdded ? ` | ${new Date(word.dateAdded).toLocaleDateString('ar-SA')}` : ''}
              </small>
            </div>
            ${word.example ? `<div class="example">Ù…Ø«Ø§Ù„: ${word.example}</div>` : ''}
          </div>
          <div>
            <button class="btn-icon" onclick="speakAdvanced('${word.en.replace(/'/g, "\\'")}', 'en')" title="Ù†Ø·Ù‚ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ">
              <i class="fas fa-volume-up"></i>
            </button>
            <button class="btn-icon" onclick="editCustomWord(${index})" title="ØªØ¹Ø¯ÙŠÙ„">
              <i class="fas fa-edit"></i>
            </button>
            <button class="btn-icon" onclick="deleteCustomWord(${index})" title="Ø­Ø°Ù">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
      `;
    }
    
    // ==================== Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ====================
    
    // ==================== Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØµÙˆØª ====================
    function startPronunciationTest() {
      const testBtn = document.getElementById('testBtn');
      const testWord = document.getElementById('testWord').textContent;
      
      if (!recognition) {
        showNotification('Ù…ÙŠØ²Ø© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ.', 'error');
        return;
      }
      
      if (isRecording) {
        recognition.stop();
        isRecording = false;
        testBtn.innerHTML = '<i class="fas fa-microphone"></i> Ø§Ø¨Ø¯Ø£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø·Ù‚';
        testBtn.classList.remove('recording');
      } else {
        recognition.start();
        isRecording = true;
        testBtn.innerHTML = '<i class="fas fa-stop-circle"></i> ØªÙˆÙ‚Ù ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…';
        testBtn.classList.add('recording');
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
        recognition.onresult = function(event) {
          const transcript = event.results[0][0].transcript;
          evaluatePronunciation(testWord, transcript);
        };
      }
    }
    
    function evaluatePronunciation(correctWord, spokenWord) {
      const accuracy = calculatePronunciationAccuracy(spokenWord.toLowerCase(), correctWord.toLowerCase());
      const score = Math.max(70, Math.min(90, accuracy)); // Ø¨ÙŠÙ† 70 Ùˆ 90
      
      const resultDiv = document.getElementById('testResult');
      resultDiv.innerHTML = `
        <div class="pronunciation-feedback ${score >= 80 ? 'pronunciation-good' : 'pronunciation-needs-work'}">
          <h4>ğŸ¤ Ù†ØªÙŠØ¬Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø·Ù‚</h4>
          <div style="font-size: 48px; font-weight: bold; color: ${score >= 85 ? '#2e7d32' : '#ef6c00'};">
            ${score}%
          </div>
          <p><strong>Ø§Ù„ÙƒÙ„Ù…Ø©:</strong> ${correctWord}</p>
          <p><strong>Ù†Ø·Ù‚Ùƒ:</strong> ${spokenWord}</p>
          <p><strong>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</strong> ${getPronunciationFeedback(score)}</p>
          ${score < 85 ? `<p><strong>Ù†ØµÙŠØ­Ø©:</strong> ${getPronunciationTip(correctWord)}</p>` : ''}
        </div>
      `;
      
      // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©
      userData.pronunciationScore = Math.max(userData.pronunciationScore, score);
      updatePronunciationProgress();
      
      // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù„
      userData.mistakes.pronunciation.push({
        word: correctWord,
        spoken: spokenWord,
        score: score,
        date: new Date().toISOString()
      });
      
      saveUserData();
      loadPronunciationHistory();
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø²Ø±
      document.getElementById('testBtn').innerHTML = '<i class="fas fa-microphone"></i> Ø§Ø¨Ø¯Ø£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø·Ù‚';
      document.getElementById('testBtn').classList.remove('recording');
      isRecording = false;
    }
    
    function getPronunciationFeedback(score) {
      if (score >= 90) return "Ù…Ù…ØªØ§Ø²! Ù†Ø·Ù‚Ùƒ Ù…Ø«Ù„ Ø§Ù„Ù…ØªØ­Ø¯Ø«ÙŠÙ† Ø§Ù„Ø£ØµÙ„ÙŠÙŠÙ†! ğŸ¯";
      if (score >= 85) return "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! Ù†Ø·Ù‚Ùƒ ÙˆØ§Ø¶Ø­ ÙˆØµØ­ÙŠØ­. ğŸ‘";
      if (score >= 80) return "Ø¬ÙŠØ¯! Ù‡Ù†Ø§Ùƒ Ù…Ø¬Ø§Ù„ Ø¨Ø³ÙŠØ· Ù„Ù„ØªØ­Ø³ÙŠÙ†. ğŸ’ª";
      if (score >= 75) return "Ù…Ù‚Ø¨ÙˆÙ„! ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨. ğŸ“š";
      return "ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†! Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ù†Ø·Ù‚ Ø§Ù„ØµØ­ÙŠØ­ ÙˆÙƒØ±Ø±Ù‡. ğŸ§";
    }
    
    function getPronunciationTip(word) {
      const tips = {
        "hello": "Ø­Ø±Ù Ø§Ù„Ù€ H ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙÙ†Ø·Ù‚ Ø¨Ù†ÙØ® Ø§Ù„Ù‡ÙˆØ§Ø¡",
        "thank": "Ø­Ø±Ù Ø§Ù„Ù€ th ÙŠØ¬Ø¨ Ø£Ù† ØªØ¶Ø¹ Ù„Ø³Ø§Ù†Ùƒ Ø¨ÙŠÙ† Ø£Ø³Ù†Ø§Ù†Ùƒ",
        "world": "Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ø±Ù Ø§Ù„Ù€ r Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ",
        "computer": "Ø§Ù†ØªØ¨Ù‡ Ù„Ù†Ø·Ù‚ Ø­Ø±Ù Ø§Ù„Ù€ u ÙƒÙ€ 'ÙŠÙˆ'",
        "environment": "Ù‚Ø³Ù‘Ù… Ø§Ù„ÙƒÙ„Ù…Ø©: en-vi-ron-ment"
      };
      
      return tips[word.toLowerCase()] || "Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ù†Ø·Ù‚ Ø§Ù„ØµØ­ÙŠØ­ ÙˆÙƒØ±Ø±Ù‡ Ø¹Ø¯Ø© Ù…Ø±Ø§Øª";
    }
    
    function nextTestWord() {
      const words = [
        "Hello", "World", "Thank", "Please", "Computer",
        "Environment", "Technology", "Pronunciation", "Beautiful", "Excellent"
      ];
      
      const current = document.getElementById('testWord').textContent;
      let nextWord;
      do {
        nextWord = words[Math.floor(Math.random() * words.length)];
      } while (nextWord === current);
      
      document.getElementById('testWord').textContent = nextWord;
      document.getElementById('testResult').innerHTML = '';
    }
    
    function testRandomWord() {
      const allWords = [];
      for (const grade in allLessons) {
        allWords.push(...allLessons[grade].lessons.map(l => l.en));
      }
      
      if (allWords.length === 0) {
        document.getElementById('testWord').textContent = "Hello";
        return;
      }
      
      const randomWord = allWords[Math.floor(Math.random() * allWords.length)];
      document.getElementById('testWord').textContent = randomWord;
      document.getElementById('testResult').innerHTML = '';
    }
    
    function loadPronunciationHistory() {
      const container = document.getElementById('pronunciationHistory');
      if (!container) return;
      
      const history = userData.mistakes.pronunciation.slice(-5);
      
      if (history.length === 0) {
        container.innerHTML = '<div class="hint">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ø³Ø§Ø¨Ù‚Ø© Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø·Ù‚.</div>';
        return;
      }
      
      container.innerHTML = `
        <h4><i class="fas fa-history"></i> Ù†ØªØ§Ø¦Ø¬ Ø³Ø§Ø¨Ù‚Ø©</h4>
        <div style="max-height: 200px; overflow-y: auto;">
          ${history.reverse().map(item => `
            <div class="lesson-item">
              <div>
                <strong>${item.word}</strong><br>
                <small>Ù†Ø·Ù‚Ùƒ: ${item.spoken}</small>
              </div>
              <div style="color: ${item.score >= 80 ? 'var(--success-color)' : 'var(--warning-color)'}; font-weight: bold;">
                ${item.score}%
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    // ==================== Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ© ====================
    function loadIraqiDictionary() {
      const container = document.getElementById('iraqiDictionary');
      if (!container) return;
      
      container.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; margin-top: 10px;">
          ${Object.entries(iraqiDictionary).slice(0, 12).map(([iraqi, data]) => `
            <div class="lesson-card" onclick="speakAdvanced('${data.english.replace(/'/g, "\\'")}', 'en')">
              <div style="font-weight: bold; color: var(--purple);">${iraqi}</div>
              <div style="font-size: 14px;">${data.english}</div>
              <div style="font-size: 12px; color: #666;">${data.formal}</div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    function translateIraqi() {
      const text = document.getElementById('iraqiInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©', 'warning');
        return;
      }
      
      let translated = text;
      let translations = [];
      
      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©
      for (const [iraqi, data] of Object.entries(iraqiDictionary)) {
        if (text.includes(iraqi)) {
          translated = translated.replace(iraqi, data.english);
          translations.push({
            iraqi: iraqi,
            english: data.english,
            formal: data.formal,
            category: data.category
          });
        }
      }
      
      const resultDiv = document.getElementById('iraqiResult');
      resultDiv.innerHTML = `
        <h5>Ø§Ù„ØªØ±Ø¬Ù…Ø©:</h5>
        <div style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 5px;">
          <strong>Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ù…Ø­Ø§Ø¯Ø«Ø©:</strong> ${translated}<br>
          <strong>Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø±Ø³Ù…ÙŠØ©:</strong> ${translations.length > 0 ? translations.map(t => t.formal).join(' ') : translated}
        </div>
        
        ${translations.length > 0 ? `
          <h5>Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªØ±Ø¬Ù…Ø©:</h5>
          ${translations.map(item => `
            <div style="margin: 5px 0; padding: 5px; background: rgba(255,255,255,0.1); border-radius: 3px;">
              <strong>${item.iraqi}</strong> â†’ ${item.english} (Ø±Ø³Ù…ÙŠ: ${item.formal})<br>
              <small>Ø§Ù„ØªØµÙ†ÙŠÙ: ${item.category}</small>
            </div>
          `).join('')}
        ` : ''}
        
        <div style="text-align: center; margin-top: 15px;">
          <button class="btn-primary" onclick="speakAdvanced('${translated.replace(/'/g, "\\'")}', 'en')">
            <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø©
          </button>
        </div>
      `;
    }
    
    function speakIraqiTranslation() {
      const text = document.getElementById('iraqiInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø£ÙˆÙ„Ø§Ù‹', 'warning');
        return;
      }
      
      // ØªØ±Ø¬Ù…Ø© Ø«Ù… Ù†Ø·Ù‚
      let translated = text;
      for (const [iraqi, data] of Object.entries(iraqiDictionary)) {
        if (text.includes(iraqi)) {
          translated = translated.replace(iraqi, data.english);
        }
      }
      
      speakAdvanced(translated, 'en');
    }
    
    // ==================== ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ø£ØºØ§Ù†ÙŠ ====================
    function loadSongList() {
      const container = document.getElementById('songList');
      if (!container) return;
      
      container.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
          ${educationalSongs.map(song => `
            <div class="lesson-card" onclick="loadSong(${song.id})">
              <div style="font-weight: bold; color: ${song.colorScheme};">${song.title}</div>
              <div style="font-size: 12px; color: #666;">${song.difficultWords.length} ÙƒÙ„Ù…Ø© ØµØ¹Ø¨Ø©</div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    function loadSongLyrics() {
      const container = document.getElementById('songLyrics');
      if (!container) return;
      
      const song = educationalSongs[0];
      container.innerHTML = song.lyrics.map(line => `
        <div class="lyrics-line">
          ${line.split(' ').map(word => `
            <span class="lyrics-word" onclick="explainWord('${word.toLowerCase().replace(/[^a-z]/gi, '')}')">
              ${word}
            </span>
          `).join(' ')}
        </div>
      `).join('');
    }
    
    function loadSong(songId) {
      const song = educationalSongs.find(s => s.id === songId);
      if (!song) return;
      
      const lyricsContainer = document.getElementById('songLyrics');
      lyricsContainer.innerHTML = song.lyrics.map(line => `
        <div class="lyrics-line">
          ${line.split(' ').map(word => `
            <span class="lyrics-word" onclick="explainWord('${word.toLowerCase().replace(/[^a-z]/gi, '')}')">
              ${word}
            </span>
          `).join(' ')}
        </div>
      `).join('');
      
      document.querySelector('.song-player h4').textContent = `Ø£ØºÙ†ÙŠØ©: ${song.title}`;
    }
    
    function explainWord(word) {
      const song = educationalSongs[0];
      const difficultWord = song.difficultWords.find(w => w.word.toLowerCase() === word.toLowerCase());
      
      if (difficultWord) {
        showNotification(`ÙƒÙ„Ù…Ø©: ${difficultWord.word} - Ù…Ø¹Ù†Ù‰: ${difficultWord.meaning} - Ù†Ø·Ù‚: ${difficultWord.pronunciation}`, 'info');
        speakAdvanced(difficultWord.word, 'en');
      } else {
        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        for (const grade in allLessons) {
          const lesson = allLessons[grade].lessons.find(l => l.en.toLowerCase() === word.toLowerCase());
          if (lesson) {
            showNotification(`ÙƒÙ„Ù…Ø©: ${lesson.en} - Ù…Ø¹Ù†Ù‰: ${lesson.ar}${lesson.ipa ? ` - Ù†Ø·Ù‚: ${lesson.ipa}` : ''}`, 'info');
            speakAdvanced(lesson.en, 'en');
            return;
          }
        }
        showNotification(`Ø§Ù„ÙƒÙ„Ù…Ø© "${word}" Ù„ÙŠØ³Øª ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØµØ¹Ø¨Ø©`, 'warning');
      }
    }
    
    function explainSongWords() {
      const song = educationalSongs[0];
      const explanation = song.difficultWords.map(word => `
        <div class="lesson-item">
          <div>
            <strong>${word.word}</strong><br>
            <small>Ù…Ø¹Ù†Ù‰: ${word.meaning}</small><br>
            <small>Ù†Ø·Ù‚: ${word.pronunciation}</small>
          </div>
          <button class="btn-icon" onclick="speakAdvanced('${word.word.replace(/'/g, "\\'")}', 'en')">
            <i class="fas fa-volume-up"></i>
          </button>
        </div>
      `).join('');
      
      document.getElementById('songLyrics').innerHTML = `
        <h5>Ø´Ø±Ø­ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØµØ¹Ø¨Ø©:</h5>
        ${explanation}
        <button class="btn-primary" onclick="loadSongLyrics()" style="margin-top: 10px; width: 100%;">
          <i class="fas fa-arrow-left"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙƒÙ„Ù…Ø§Øª
        </button>
      `;
    }
    
    function highlightPronunciation() {
      const lines = document.querySelectorAll('.lyrics-line');
      lines.forEach(line => {
        line.classList.toggle('highlight');
      });
    }
    
    // ==================== Ø­Ø³Ø¨ Ø§Ù„Ù…Ù‡Ù†Ø© ====================
    function selectProfession(professionId) {
      userData.profession = professionId;
      const profession = professions[professionId];
      
      if (!profession) return;
      
      const container = document.getElementById('professionContent');
      container.innerHTML = `
        <div class="card">
          <h4><i class="${profession.icon}"></i> ${profession.name} - Ø¯Ø±ÙˆØ³ Ù…Ø®ØµØµØ©</h4>
          <div class="unit-lessons">
            ${profession.lessons.map(lesson => `
              <div class="lesson-card" onclick="speakAdvanced('${lesson.en.replace(/'/g, "\\'")}', 'en')">
                <div style="font-weight: bold; color: var(--primary-color);">${lesson.en}</div>
                <div style="font-size: 14px; color: #666;">${lesson.ar}</div>
                <div style="margin-top: 5px; font-size: 12px; color: var(--accent-color);">${lesson.category}</div>
              </div>
            `).join('')}
          </div>
          <div style="text-align: center; margin-top: 15px;">
            <button class="btn-primary" onclick="startProfessionQuiz('${professionId}')">
              <i class="fas fa-question-circle"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù‡Ù†Ø©
            </button>
            <button class="btn-secondary" onclick="saveProfessionProgress('${professionId}')">
              <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù…
            </button>
          </div>
        </div>
      `;
      
      showNotification(`ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ù…Ù‡Ù†Ø© ${profession.name}`, 'success');
      saveUserData();
    }
    
    function startProfessionQuiz(professionId) {
      const profession = professions[professionId];
      if (!profession) return;
      
      document.getElementById('quizArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù‡Ù†Ø© ${profession.name}</h3>
          <div id="professionQuizContent"></div>
        </div>
      `;
      
      showTab('tab3');
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
      const quizQuestions = profession.lessons
        .sort(() => Math.random() - 0.5)
        .slice(0, 5)
        .map((lesson, index) => ({
          question: `Ù…Ø§ ØªØ±Ø¬Ù…Ø©: "${lesson.en}"ØŸ`,
          correctAnswer: lesson.ar,
          wrongAnswers: profession.lessons
            .filter(l => l.ar !== lesson.ar)
            .sort(() => Math.random() - 0.5)
            .slice(0, 3)
            .map(l => l.ar)
        }));
      
      renderProfessionQuiz(quizQuestions);
    }
    
    function renderProfessionQuiz(questions) {
      const container = document.getElementById('professionQuizContent');
      if (!container) return;
      
      let currentQuestion = 0;
      let score = 0;
      
      function showQuestion() {
        if (currentQuestion >= questions.length) {
          container.innerHTML = `
            <div style="text-align: center; padding: 30px;">
              <h4 style="color: var(--primary-color);">Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</h4>
              <div style="font-size: 48px; color: var(--success-color); margin: 20px 0;">${score}/${questions.length}</div>
              <p>${score === questions.length ? 'Ù…Ù…ØªØ§Ø²! Ø£Ù†Øª Ø¬Ø§Ù‡Ø² Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù†Ø©! ğŸ¯' : 
                 score >= questions.length * 0.7 ? 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! ÙˆØ§ØµÙ„ Ø§Ù„ØªØ¯Ø±ÙŠØ¨. ğŸ‘' : 
                 'ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨. ğŸ’ª'}</p>
              <button class="btn-primary" onclick="showTab('tab12')">
                <i class="fas fa-arrow-left"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù‡Ù†Ø©
              </button>
            </div>
          `;
          return;
        }
        
        const q = questions[currentQuestion];
        const allAnswers = [q.correctAnswer, ...q.wrongAnswers]
          .sort(() => Math.random() - 0.5);
        
        container.innerHTML = `
          <div style="text-align: center;">
            <h4>Ø§Ù„Ø³Ø¤Ø§Ù„ ${currentQuestion + 1} Ù…Ù† ${questions.length}</h4>
            <div class="challenge-word">${q.question}</div>
            <div style="margin: 20px 0;">
              ${allAnswers.map(answer => `
                <div class="game-option" onclick="checkAnswer('${answer.replace(/'/g, "\\'")}', '${q.correctAnswer.replace(/'/g, "\\'")}')">
                  ${answer}
                </div>
              `).join('')}
            </div>
            <div style="margin-top: 20px;">
              <span style="color: var(--accent-color);">Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}</span>
            </div>
          </div>
        `;
      }
      
      window.checkAnswer = function(selected, correct) {
        const options = document.querySelectorAll('.game-option');
        options.forEach(option => {
          if (option.textContent === correct) {
            option.classList.add('correct');
          }
          if (option.textContent === selected && selected !== correct) {
            option.classList.add('wrong');
          }
          option.style.pointerEvents = 'none';
        });
        
        if (selected === correct) {
          score++;
          showNotification('Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰', 'success');
        } else {
          showNotification('Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰. ğŸ’ª', 'error');
        }
        
        setTimeout(() => {
          currentQuestion++;
          showQuestion();
        }, 2000);
      };
      
      showQuestion();
    }
    
    function saveProfessionProgress(professionId) {
      if (!userData.professionProgress) userData.professionProgress = {};
      userData.professionProgress[professionId] = new Date().toISOString();
      saveUserData();
      showNotification('ØªÙ… Ø­ÙØ¸ ØªÙ‚Ø¯Ù…Ùƒ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù†Ø©', 'success');
    }
    
    // ==================== Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ ====================
    function askAI() {
      const question = document.getElementById('aiQuestion').value.trim();
      if (!question) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¤Ø§Ù„', 'warning');
        return;
      }
      
      const responseDiv = document.getElementById('aiResponse');
      responseDiv.innerHTML = '<div class="ai-message"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙÙƒÙŠØ± ÙÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©...</div>';
      
      // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
      setTimeout(() => {
        const responses = [
          `Ø³Ø¤Ø§Ù„ Ù…Ù…ØªØ§Ø²! "${question}" Ù‡Ùˆ Ù…ÙˆØ¶ÙˆØ¹ Ù…Ù‡Ù… ÙÙŠ ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©.`,
          `Ø­Ø³Ù†Ø§Ù‹ØŒ Ø¯Ø¹Ù†ÙŠ Ø£Ø´Ø±Ø­ Ù„Ùƒ "${question}" Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø³ÙŠØ·Ø©.`,
          `Ù‡Ø°Ø§ Ø³Ø¤Ø§Ù„ Ø´Ø§Ø¦Ø¹! "${question}" ÙŠØ­ØªØ§Ø¬ Ù„ÙÙ‡Ù… Ø¨Ø¹Ø¶ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©.`,
          `Ø±Ø§Ø¦Ø¹! Ø³Ø¤Ø§Ù„Ùƒ Ø¹Ù† "${question}" ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ Ø¨Ø§Ù„ØªØ¹Ù„Ù‘Ù….`
        ];
        
        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        const detailedResponse = generateAIResponse(question);
        
        responseDiv.innerHTML = `
          <div class="ai-message">
            <strong>Ø³Ø¤Ø§Ù„Ùƒ:</strong> ${question}<br><br>
            <strong>Ø±Ø¯ÙŠ:</strong> ${randomResponse}<br><br>
            ${detailedResponse}
            <div style="margin-top: 15px;">
              <button class="btn-icon" onclick="speakAdvanced('${detailedResponse.split('.')[0].replace(/'/g, "\\'")}', 'en')">
                <i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
              </button>
              <button class="btn-icon" onclick="saveAIResponse('${question.replace(/'/g, "\\'")}', '${detailedResponse.replace(/'/g, "\\'")}')">
                <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
              </button>
            </div>
          </div>
        `;
        
        // Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
        userData.aiConversations.push({
          question: question,
          response: detailedResponse,
          timestamp: new Date().toISOString()
        });
        
        saveUserData();
        loadAIHistory();
      }, 1500);
    }
    
    function generateAIResponse(question) {
      const lowerQuestion = question.toLowerCase();
      
      if (lowerQuestion.includes('ÙØ±Ù‚') || lowerQuestion.includes('difference')) {
        return `Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† present perfect Ùˆ past simple Ù‡Ùˆ Ø£Ù† present perfect ÙŠØ±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„ÙØ¹Ù„ ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠØŒ Ø¨ÙŠÙ†Ù…Ø§ past simple ÙŠØªØ­Ø¯Ø« Ø¹Ù† ÙØ¹Ù„ Ø§Ù†ØªÙ‡Ù‰ ÙÙŠ ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯ ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠ.<br><br>
        <strong>Ø£Ù…Ø«Ù„Ø©:</strong><br>
        â€¢ Present perfect: I have visited London. (Ø²Ø±Øª Ù„Ù†Ø¯Ù† ÙˆØ£Ù†Ø§ Ø§Ù„Ø¢Ù† Ù„Ø¯ÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØªØ¬Ø±Ø¨Ø©)<br>
        â€¢ Past simple: I visited London last year. (Ø²Ø±Øª Ù„Ù†Ø¯Ù† ÙÙŠ ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯ - Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ø¶ÙŠØ©)<br><br>
        <strong>ØªÙ…Ø±ÙŠÙ†:</strong> Ø­Ø§ÙˆÙ„ Ø£Ù† ØªÙƒÙ…Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù…Ù„Ø©: "I ______ (finish) my homework already."`;
      }
      
      if (lowerQuestion.includes('Ù‚ÙˆØ§Ø¹Ø¯') || lowerQuestion.includes('grammar')) {
        return `Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù†Ø­ÙˆÙŠØ© Ù‡ÙŠ Ø£Ø³Ø§Ø³ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©. Ø£Ù‡Ù… Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ ØªØ¹Ù„Ù…Ù‡Ø§:<br><br>
        1. <strong>Ø£Ø²Ù…Ù†Ø© Ø§Ù„Ø£ÙØ¹Ø§Ù„:</strong> Present, Past, Future<br>
        2. <strong>Ø§Ù„ØµÙØ§Øª ÙˆØ§Ù„Ø¸Ø±ÙˆÙ:</strong> Ù„ÙˆØµÙ Ø§Ù„Ø£Ø´Ø®Ø§Øµ ÙˆØ§Ù„Ø£Ø´ÙŠØ§Ø¡<br>
        3. <strong>Ø­Ø±ÙˆÙ Ø§Ù„Ø¬Ø±:</strong> in, on, at, by, with<br>
        4. <strong>Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø´Ø±Ø·ÙŠØ©:</strong> If clauses<br><br>
        <strong>Ù†ØµÙŠØ­Ø©:</strong> Ø§Ø¨Ø¯Ø£ Ø¨ØªØ¹Ù„Ù… present simple ÙÙ‡Ùˆ Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Ù‹.`;
      }
      
      if (lowerQuestion.includes('Ù†Ø·Ù‚') || lowerQuestion.includes('pronunciation')) {
        return `ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†Ø·Ù‚ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰:<br><br>
        1. <strong>Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹:</strong> Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ù…ØªØ­Ø¯Ø«ÙŠÙ† Ø§Ù„Ø£ØµÙ„ÙŠÙŠÙ†<br>
        2. <strong>Ø§Ù„ØªÙƒØ±Ø§Ø±:</strong> ÙƒØ±Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ù…Ø§Ø¹ Ù…Ø¨Ø§Ø´Ø±Ø©<br>
        3. <strong>Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> Ø³Ø¬Ù„ ØµÙˆØªÙƒ ÙˆÙ‚Ø§Ø±Ù†Ù‡ Ø¨Ø§Ù„Ø£ØµÙ„<br>
        4. <strong>Ø§Ù„ØµÙˆØªÙŠØ§Øª:</strong> ØªØ¹Ù„Ù… Ø±Ù…ÙˆØ² IPA Ù„Ù„Ù†Ø·Ù‚ Ø§Ù„ØµØ­ÙŠØ­<br><br>
        <strong>ØªÙ…Ø±ÙŠÙ†:</strong> Ø­Ø§ÙˆÙ„ Ù†Ø·Ù‚ Ù‡Ø°Ù‡ Ø§Ù„ÙƒÙ„Ù…Ø§Øª: "thought, through, although"`;
      }
      
      return `Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„Ùƒ "${question}":<br><br>
      Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ù…Ø§Ø±Ø³Ø© Ù…Ø³ØªÙ…Ø±Ø© ÙÙŠ Ø£Ø±Ø¨Ø¹Ø© Ù…Ù‡Ø§Ø±Ø§Øª:<br>
      1. <strong>Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹:</strong> Listen to English daily<br>
      2. <strong>Ø§Ù„ØªØ­Ø¯Ø«:</strong> Speak even if you make mistakes<br>
      3. <strong>Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©:</strong> Read simple texts regularly<br>
      4. <strong>Ø§Ù„ÙƒØªØ§Ø¨Ø©:</strong> Write short paragraphs<br><br>
      <strong>Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ:</strong> Today I learned new words and practiced pronunciation.`;
    }
    
    function voiceAskAI() {
      if (!recognition) {
        showNotification('Ù…ÙŠØ²Ø© Ø§Ù„ØµÙˆØª ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©', 'error');
        return;
      }
      
      showNotification('Ø§Ø³ØªÙ…Ø¹... Ù‚Ù„ Ø³Ø¤Ø§Ù„Ùƒ Ø§Ù„Ø¢Ù†', 'info');
      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        document.getElementById('aiQuestion').value = transcript;
        askAI();
      };
      recognition.start();
    }
    
    function askExample() {
      const examples = [
        "Ù…Ø§ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† say Ùˆ tellØŸ",
        "ÙƒÙŠÙ Ø£Ø³ØªØ®Ø¯Ù… present perfectØŸ",
        "Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© sophisticatedØŸ",
        "ÙƒÙŠÙ Ø£Ù†Ø·Ù‚ Ø­Ø±Ù th Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ØŸ",
        "Ù…Ø§ Ù‡ÙŠ Ø­Ø±ÙˆÙ Ø§Ù„Ø¬Ø± Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Ù‹ØŸ"
      ];
      
      const randomExample = examples[Math.floor(Math.random() * examples.length)];
      document.getElementById('aiQuestion').value = randomExample;
      showNotification(`Ø¬Ø±Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„: "${randomExample}"`, 'info');
    }
    
    function askPractice() {
      const practices = [
        "Ø§ÙƒØªØ¨ Ø¬Ù…Ù„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… present continuous",
        "Ø­ÙˆÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù…Ù„Ø© Ù„Ù„Ù…Ø§Ø¶ÙŠ: I go to school every day",
        "Ù…Ø§ Ù‡Ùˆ Ø¬Ù…Ø¹ ÙƒÙ„Ù…Ø© childØŸ",
        "Ù…Ø§ Ù‡Ùˆ Ù†Ø·Ù‚ ÙƒÙ„Ù…Ø© psychologyØŸ",
        "Ø§Ø³ØªØ®Ø¯Ù… ÙƒÙ„Ù…Ø© however ÙÙŠ Ø¬Ù…Ù„Ø©"
      ];
      
      const randomPractice = practices[Math.floor(Math.random() * practices.length)];
      document.getElementById('aiQuestion').value = randomPractice;
      showNotification(`ØªÙ…Ø±ÙŠÙ†: ${randomPractice}`, 'info');
    }
    
    function saveAIResponse(question, response) {
      userData.aiConversations.push({
        question: question,
        response: response,
        timestamp: new Date().toISOString(),
        saved: true
      });
      saveUserData();
      showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ÙÙŠ Ø³Ø¬Ù„Ùƒ', 'success');
    }
    
    function loadAIHistory() {
      const container = document.getElementById('aiHistory');
      if (!container) return;
      
      const history = userData.aiConversations.slice(-5);
      
      if (history.length === 0) {
        container.innerHTML = '<div class="hint">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø³Ø§Ø¨Ù‚Ø© Ù…Ø¹ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ.</div>';
        return;
      }
      
      container.innerHTML = `
        <div style="max-height: 300px; overflow-y: auto;">
          ${history.reverse().map((conv, index) => `
            <div class="conversation-item">
              <div class="conversation-en">
                <strong>Ø³Ø¤Ø§Ù„ ${history.length - index}:</strong> ${conv.question}
              </div>
              <div class="conversation-ar">
                ${conv.response.substring(0, 100)}...
              </div>
              <button class="btn-icon" onclick="showFullConversation(${userData.aiConversations.indexOf(conv)})">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    function showFullConversation(index) {
      const conv = userData.aiConversations[index];
      if (!conv) return;
      
      document.getElementById('aiQuestion').value = conv.question;
      document.getElementById('aiResponse').innerHTML = `
        <div class="ai-message">
          <strong>Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</strong><br><br>
          <strong>Ø³Ø¤Ø§Ù„Ùƒ:</strong> ${conv.question}<br><br>
          <strong>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©:</strong> ${conv.response}<br><br>
          <small>${new Date(conv.timestamp).toLocaleString('ar-SA')}</small>
        </div>
      `;
    }
    
    // ==================== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª ====================
    
    // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ù„Ù…
    function toggleLearned(word) {
      const index = userData.learnedWords.indexOf(word);
      if (index === -1) {
        userData.learnedWords.push(word);
        showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© "${word}" Ù„Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªØ¹Ù„Ù…Ø©!`, 'success');
      } else {
        userData.learnedWords.splice(index, 1);
        showNotification(`ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© "${word}" Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªØ¹Ù„Ù…Ø©.`, 'info');
      }
      updateStats();
      saveUserData();
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ Ù„Ù„Ù…ÙØ±Ø¯Ø§Øª
    function addToVocabulary() {
      const text = document.getElementById('textInput').value.trim();
      if (!text) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„Ø¥Ø¶Ø§ÙØ©', 'warning');
        return;
      }
      
      const isArabic = /[\u0600-\u06FF]/.test(text);
      
      if (isArabic) {
        document.getElementById('newWordAr').value = text;
        document.getElementById('newWordEn').value = '';
      } else {
        document.getElementById('newWordEn').value = text;
        document.getElementById('newWordAr').value = '';
      }
      
      showNotification('Ø§Ø³ØªØ®Ø¯Ù… ØªØ¨ÙˆÙŠØ¨ "Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰" Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù…', 'info');
      showTab('tab7');
    }
    
    // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
    function addNewWord() {
      const wordEn = document.getElementById('newWordEn').value.trim();
      const wordAr = document.getElementById('newWordAr').value.trim();
      const category = document.getElementById('newWordCategory').value;
      const unit = document.getElementById('newWordUnit').value.trim();
      const example = document.getElementById('newWordExample').value.trim();
      
      if (!wordEn || !wordAr) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒÙ„ Ù…Ù† Ø§Ù„Ø­Ù‚Ù„ÙŠÙ† Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆØ§Ù„Ø¹Ø±Ø¨ÙŠØ©', 'error');
        return;
      }
      
      const newWord = {
        en: wordEn,
        ar: wordAr,
        category: category,
        unit: unit || `Ù…ÙØ±Ø¯Ø§Øª Ù…Ø¶Ø§ÙØ© - ${category}`,
        example: example
      };
      
      userData.customWords.push(newWord);
      updateStats();
      saveUserData();
      clearNewWord();
      showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© "${wordEn}" Ø¨Ù†Ø¬Ø§Ø­!`, 'success');
      speakAdvanced(wordEn, 'en');
    }
    
    // ØªØ¹Ø¯ÙŠÙ„ ÙƒÙ„Ù…Ø© Ù…Ø¶Ø§ÙØ©
    function editCustomWord(index) {
      const word = userData.customWords[index];
      
      document.getElementById('newWordEn').value = word.en;
      document.getElementById('newWordAr').value = word.ar;
      document.getElementById('newWordCategory').value = word.category;
      document.getElementById('newWordUnit').value = word.unit || '';
      document.getElementById('newWordExample').value = word.example || '';
      
      showNotification('ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¢Ù†', 'info');
      showTab('tab7');
      
      // Ø­Ø°Ù Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
      window.editIndex = index;
    }
    
    // Ø­Ø°Ù ÙƒÙ„Ù…Ø© Ù…Ø¶Ø§ÙØ©
    function deleteCustomWord(index) {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ØŸ')) {
        userData.customWords.splice(index, 1);
        updateCustomWordsList();
        updateStats();
        saveUserData();
        showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ù†Ø¬Ø§Ø­', 'success');
      }
    }
    
    // Ø§Ù‚ØªØ±Ø§Ø­ ÙƒÙ„Ù…Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
    function suggestRandomWord() {
      const categories = {
        'Ù…ÙØ±Ø¯Ø§Øª': ['Notebook', 'Dictionary', 'Calendar', 'Globe', 'Ruler'],
        'Ù…Ø­Ø§Ø¯Ø«Ø©': ['How was your day?', 'What do you think?', 'Can you help me?', 'Let\'s go together', 'See you later'],
        'Ù‚Ø§Ø¹Ø¯Ø©': ['Always use capital I', 'Add s for plural', 'Use a before consonant', 'Use an before vowel', 'Verb comes after subject'],
        'ÙØ¹Ù„': ['Study', 'Learn', 'Practice', 'Remember', 'Understand'],
        'ØµÙØ©': ['Important', 'Difficult', 'Easy', 'Interesting', 'Useful'],
        'Ø¹Ø§Ø¦Ù„Ø©': ['Grandfather', 'Grandmother', 'Uncle', 'Aunt', 'Cousin']
      };
      
      const category = document.getElementById('newWordCategory').value;
      const words = categories[category] || ['Example', 'Sample', 'Practice', 'Exercise', 'Lesson'];
      
      const randomEn = words[Math.floor(Math.random() * words.length)];
      
      const translations = {
        'Notebook': 'Ø¯ÙØªØ±',
        'Dictionary': 'Ù‚Ø§Ù…ÙˆØ³',
        'Calendar': 'ØªÙ‚ÙˆÙŠÙ…',
        'Globe': 'ÙƒØ±Ø© Ø£Ø±Ø¶ÙŠØ©',
        'Ruler': 'Ù…Ø³Ø·Ø±Ø©',
        'How was your day?': 'ÙƒÙŠÙ ÙƒØ§Ù† ÙŠÙˆÙ…ÙƒØŸ',
        'What do you think?': 'Ù…Ø§ Ø±Ø£ÙŠÙƒØŸ',
        'Can you help me?': 'Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø³Ø§Ø¹Ø¯ØªÙŠØŸ',
        'Let\'s go together': 'Ù„Ù†Ø°Ù‡Ø¨ Ù…Ø¹Ø§Ù‹',
        'See you later': 'Ø£Ø±Ø§Ùƒ Ù„Ø§Ø­Ù‚Ø§Ù‹',
        'Always use capital I': 'Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø§Ø³ØªØ®Ø¯Ù… I Ø¨Ø­Ø±Ù ÙƒØ¨ÙŠØ±',
        'Add s for plural': 'Ø£Ø¶Ù s Ù„Ù„Ø¬Ù…Ø¹',
        'Use a before consonant': 'Ø§Ø³ØªØ®Ø¯Ù… a Ù‚Ø¨Ù„ Ø§Ù„Ø­Ø±Ù Ø§Ù„Ø³Ø§ÙƒÙ†',
        'Use an before vowel': 'Ø§Ø³ØªØ®Ø¯Ù… an Ù‚Ø¨Ù„ Ø­Ø±Ù Ø§Ù„Ø¹Ù„Ø©',
        'Verb comes after subject': 'Ø§Ù„ÙØ¹Ù„ ÙŠØ£ØªÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ÙØ§Ø¹Ù„',
        'Study': 'ÙŠØ¯Ø±Ø³',
        'Learn': 'ÙŠØªØ¹Ù„Ù…',
        'Practice': 'ÙŠØªØ¯Ø±Ø¨',
        'Remember': 'ÙŠØªØ°ÙƒØ±',
        'Understand': 'ÙŠÙÙ‡Ù…',
        'Important': 'Ù…Ù‡Ù…',
        'Difficult': 'ØµØ¹Ø¨',
        'Easy': 'Ø³Ù‡Ù„',
        'Interesting': 'Ù…Ù…ØªØ¹',
        'Useful': 'Ù…ÙÙŠØ¯',
        'Grandfather': 'Ø¬Ø¯',
        'Grandmother': 'Ø¬Ø¯Ø©',
        'Uncle': 'Ø¹Ù…/Ø®Ø§Ù„',
        'Aunt': 'Ø¹Ù…Ø©/Ø®Ø§Ù„Ø©',
        'Cousin': 'Ø§Ø¨Ù† Ø¹Ù…/Ø®Ø§Ù„'
      };
      
      const randomAr = translations[randomEn] || 'ØªØ±Ø¬Ù…Ø©';
      
      document.getElementById('newWordEn').value = randomEn;
      document.getElementById('newWordAr').value = randomAr;
      
      showNotification(`ØªÙ… Ø§Ù‚ØªØ±Ø§Ø­: ${randomEn} - ${randomAr}`, 'info');
    }
    
    // Ù…Ø³Ø­ Ø­Ù‚ÙˆÙ„ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    function clearNewWord() {
      document.getElementById('newWordEn').value = '';
      document.getElementById('newWordAr').value = '';
      document.getElementById('newWordCategory').value = 'Ù…ÙØ±Ø¯Ø§Øª';
      document.getElementById('newWordUnit').value = '';
      document.getElementById('newWordExample').value = '';
      delete window.editIndex;
    }
    
    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¯Ø±ÙˆØ³
    function searchLessons() {
      const term = document.getElementById('searchLessons').value.toLowerCase();
      const cards = document.querySelectorAll('.lesson-card');
      cards.forEach(card => {
        const text = card.textContent.toLowerCase();
        card.style.display = text.includes(term) ? 'block' : 'none';
      });
    }
    
    // ==================== Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ====================
    
    // ÙØ­Øµ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
    function checkAchievements() {
      const totalWords = userData.learnedWords.length + userData.customWords.length;
      const challengeWins = userData.challengeScores ? 
        Object.values(userData.challengeScores).filter(score => score >= 8).length : 0;
      
      const achievementsToCheck = [
        {name: "Ø§Ù„Ù…Ø¨ØªØ¯Ø¦", condition: totalWords >= 10},
        {name: "Ø§Ù„Ù…Ø¬ØªÙ‡Ø¯", condition: totalWords >= 25},
        {name: "Ø§Ù„Ù…ØªÙ…ÙƒÙ†", condition: totalWords >= 50},
        {name: "Ù†Ø·Ø§Ù‚ Ø¬ÙŠØ¯", condition: userData.pronunciationScore >= 80},
        {name: "Ù†Ø·Ø§Ù‚ Ù…Ù…ØªØ§Ø²", condition: userData.pronunciationScore >= 90},
        {name: "Ù…Ø«Ø§Ø¨Ø±", condition: userData.streak >= 3},
        {name: "Ù…Ù†ØªØ¸Ù…", condition: userData.streak >= 7},
        {name: "Ø§Ù„Ù…Ø¨Ø¯Ø¹", condition: userData.customWords.length >= 5},
        {name: "Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„ØµØºÙŠØ±", condition: userData.customWords.length >= 10},
        {name: "Ø¨Ø·Ù„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨", condition: challengeWins >= 3}
      ];
      
      achievementsToCheck.forEach(achievement => {
        if (achievement.condition && !userData.achievements.includes(achievement.name)) {
          unlockAchievement(achievement.name);
        }
      });
    }
    
    // ÙØªØ­ Ø¥Ù†Ø¬Ø§Ø² Ø¬Ø¯ÙŠØ¯
    function unlockAchievement(name) {
      if (!userData.achievements.includes(name)) {
        userData.achievements.push(name);
        showNotification(`ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ ÙØ²Øª Ø¨Ø¥Ù†Ø¬Ø§Ø²: ${name}`, 'success');
        saveUserData();
        updateStats();
        updateAchievementsWall();
      }
    }
    
    // ==================== Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© ====================
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
    function showNotification(message, type = 'info') {
      const area = document.getElementById('notificationArea');
      
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.style.background = 
        type === 'error' ? 'var(--error-color)' : 
        type === 'success' ? 'var(--success-color)' : 
        type === 'warning' ? 'var(--warning-color)' : 'var(--primary-color)';
      
      notification.innerHTML = `
        <button class="close-notification" onclick="this.parentElement.remove()">Ã—</button>
        <div>${message}</div>
      `;
      
      area.appendChild(notification);
      setTimeout(() => notification.remove(), 5000);
    }
    
    // ==================== Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ù„Ø© ====================
    
    // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª
    window.startQuiz = function() {
      // Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      let allWords = [];
      for (const grade in allLessons) {
        allWords = allWords.concat(allLessons[grade].lessons);
      }
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©
      allWords = allWords.concat(userData.customWords);
      
      if (allWords.length < 5) {
        document.getElementById('quizArea').innerHTML = `
          <div class="game-container">
            <h3 style="text-align: center; color: var(--primary-color);">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª</h3>
            <p style="text-align: center; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±. Ø£Ø¶Ù ÙƒÙ„Ù…Ø§Øª Ø£ÙˆÙ„Ø§Ù‹.</p>
          </div>
        `;
        return;
      }
      
      // Ø§Ø®ØªÙŠØ§Ø± 10 ÙƒÙ„Ù…Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
      const selectedWords = [];
      const usedIndices = new Set();
      
      while (selectedWords.length < Math.min(10, allWords.length) && selectedWords.length < allWords.length) {
        const randomIndex = Math.floor(Math.random() * allWords.length);
        if (!usedIndices.has(randomIndex)) {
          selectedWords.push(allWords[randomIndex]);
          usedIndices.add(randomIndex);
        }
      }
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø³Ø¦Ù„Ø©
      const quizQuestions = selectedWords.map(word => {
        // Ø¬Ù…Ø¹ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©
        const wrongAnswers = [];
        const wrongIndices = new Set();
        
        while (wrongAnswers.length < 3 && wrongAnswers.length < allWords.length - 1) {
          const randomIndex = Math.floor(Math.random() * allWords.length);
          if (allWords[randomIndex].ar !== word.ar && !wrongIndices.has(randomIndex)) {
            wrongAnswers.push(allWords[randomIndex].ar);
            wrongIndices.add(randomIndex);
          }
        }
        
        return {
          question: `Ù…Ø§ ØªØ±Ø¬Ù…Ø©: "${word.en}"ØŸ`,
          correctAnswer: word.ar,
          wrongAnswers: wrongAnswers
        };
      });
      
      let currentQuestion = 0;
      let score = 0;
      
      function renderQuestion() {
        if (currentQuestion >= quizQuestions.length) {
          // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
          const percentage = Math.round((score / quizQuestions.length) * 100);
          userData.quizScores.push(percentage);
          
          document.getElementById('quizArea').innerHTML = `
            <div class="game-container">
              <h3 style="text-align: center; color: var(--primary-color);">Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±! ğŸ‰</h3>
              <div style="text-align: center; margin: 30px 0;">
                <div style="font-size: 72px; color: ${percentage >= 70 ? 'var(--success-color)' : 'var(--accent-color)'};">
                  ${score}/${quizQuestions.length}
                </div>
                <div style="font-size: 24px; color: ${percentage >= 70 ? 'var(--success-color)' : 'var(--accent-color)'};">
                  ${percentage}%
                </div>
              </div>
              
              <div style="text-align: center; margin: 20px 0;">
                ${percentage >= 90 ? 'Ù…Ù…ØªØ§Ø²! Ø£Ù†Øª Ø±Ø§Ø¦Ø¹! ğŸ†' : 
                  percentage >= 70 ? 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! ÙˆØ§ØµÙ„ Ø§Ù„ØªÙ‚Ø¯Ù…. ğŸ‘' : 
                  'ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨. ğŸ’ª'}
              </div>
              
              <div style="text-align: center;">
                <button class="btn-primary" onclick="startQuiz()">
                  <i class="fas fa-redo"></i> Ø§Ø®ØªÙŠØ§Ø± Ø¬Ø¯ÙŠØ¯
                </button>
                <button class="btn-secondary" onclick="showTab('tab3')">
                  <i class="fas fa-arrow-left"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨
                </button>
              </div>
            </div>
          `;
          
          updateStats();
          saveUserData();
          return;
        }
        
        const q = quizQuestions[currentQuestion];
        const allAnswers = [q.correctAnswer, ...q.wrongAnswers]
          .sort(() => Math.random() - 0.5);
        
        document.getElementById('quizArea').innerHTML = `
          <div class="game-container">
            <h3 style="text-align: center; color: var(--primary-color);">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª</h3>
            <div style="text-align: center; margin: 20px 0;">
              <div class="challenge-word">${q.question}</div>
              <div style="color: #666; margin-top: 10px;">
                Ø§Ù„Ø³Ø¤Ø§Ù„ ${currentQuestion + 1} Ù…Ù† ${quizQuestions.length}
              </div>
            </div>
            
            <div style="margin: 30px 0;">
              ${allAnswers.map((answer, idx) => `
                <div class="game-option" onclick="checkQuizAnswer('${answer.replace(/'/g, "\\'")}', '${q.correctAnswer.replace(/'/g, "\\'")}')">
                  ${idx + 1}. ${answer}
                </div>
              `).join('')}
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
              <div class="score-display">
                Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}/${quizQuestions.length}
              </div>
              <button class="btn-warning" onclick="skipQuizQuestion()">
                <i class="fas fa-forward"></i> ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„
              </button>
            </div>
          </div>
        `;
      }
      
      window.checkQuizAnswer = function(selected, correct) {
        const options = document.querySelectorAll('.game-option');
        options.forEach(option => {
          const optionText = option.textContent.replace(/^\d+\.\s*/, '');
          if (optionText === correct) {
            option.classList.add('correct');
          }
          if (optionText === selected && selected !== correct) {
            option.classList.add('wrong');
          }
          option.style.pointerEvents = 'none';
        });
        
        if (selected === correct) {
          score++;
          showNotification('Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰', 'success');
        } else {
          showNotification('Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰. ğŸ’ª', 'error');
        }
        
        setTimeout(() => {
          currentQuestion++;
          renderQuestion();
        }, 1500);
      };
      
      window.skipQuizQuestion = function() {
        currentQuestion++;
        renderQuestion();
        showNotification('ØªÙ… ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„', 'info');
      };
      
      renderQuestion();
    };
    
    // Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
    window.startMatchingGame = function() {
      // Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
      let allWords = [];
      for (const grade in allLessons) {
        allWords = allWords.concat(allLessons[grade].lessons.slice(0, 8));
      }
      
      if (allWords.length < 4) {
        document.getElementById('quizArea').innerHTML = `
          <div class="game-container">
            <h3 style="text-align: center; color: var(--primary-color);">Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©</h3>
            <p style="text-align: center; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ù„Ø¹Ø¨Ø©. Ø£Ø¶Ù ÙƒÙ„Ù…Ø§Øª Ø£ÙˆÙ„Ø§Ù‹.</p>
          </div>
        `;
        return;
      }
      
      // Ø§Ø®ØªÙŠØ§Ø± 4 ÙƒÙ„Ù…Ø§Øª
      const gameWords = allWords.slice(0, 4);
      const englishWords = gameWords.map(w => ({ text: w.en, type: 'en', match: w.ar }));
      const arabicWords = gameWords.map(w => ({ text: w.ar, type: 'ar', match: w.en }));
      
      const allItems = [...englishWords, ...arabicWords]
        .sort(() => Math.random() - 0.5);
      
      let firstSelection = null;
      let matchesFound = 0;
      let attempts = 0;
      
      document.getElementById('quizArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©</h3>
          <p style="text-align: center; color: #666;">Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø«Ù… Ø¹Ø±Ø¨ÙŠØ© Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù‡Ø§</p>
          
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 30px 0;">
            ${allItems.map((item, index) => `
              <div class="match-item" id="match-${index}" 
                   onclick="handleMatchSelection(${index}, '${item.text.replace(/'/g, "\\'")}', '${item.type}', '${item.match.replace(/'/g, "\\'")}')">
                ${item.type === 'en' ? 'ğŸ‡¬ğŸ‡§' : 'ğŸ‡¸ğŸ‡¦'} ${item.text}
              </div>
            `).join('')}
          </div>
          
          <div style="text-align: center; margin-top: 20px;">
            <div class="score-display">
              Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø§Øª: ${matchesFound}/4
            </div>
            <div style="color: #666; margin: 10px 0;">
              Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: <span id="attemptsCount">${attempts}</span>
            </div>
            <button class="btn-primary" onclick="resetMatchingGame()">
              <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø©
            </button>
            <button class="btn-secondary" onclick="showTab('tab3')">
              <i class="fas fa-arrow-left"></i> Ø§Ù„Ø¹ÙˆØ¯Ø©
            </button>
          </div>
        </div>
      `;
      
      window.handleMatchSelection = function(index, text, type, match) {
        const element = document.getElementById(`match-${index}`);
        if (element.classList.contains('matched') || element.classList.contains('selected')) {
          return;
        }
        
        element.classList.add('selected');
        
        if (!firstSelection) {
          firstSelection = { index, text, type, match };
          return;
        }
        
        attempts++;
        document.getElementById('attemptsCount').textContent = attempts;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
        if ((firstSelection.type === 'en' && type === 'ar' && firstSelection.match === text) ||
            (firstSelection.type === 'ar' && type === 'en' && firstSelection.text === match)) {
          
          // Ù…Ø·Ø§Ø¨Ù‚Ø© ØµØ­ÙŠØ­Ø©
          setTimeout(() => {
            document.getElementById(`match-${firstSelection.index}`).classList.remove('selected');
            document.getElementById(`match-${firstSelection.index}`).classList.add('matched');
            element.classList.remove('selected');
            element.classList.add('matched');
            
            matchesFound++;
            document.querySelector('.score-display').innerHTML = `Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø§Øª: ${matchesFound}/4`;
            
            if (matchesFound === 4) {
              // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©
              const stars = attempts <= 8 ? 'â­â­â­â­â­' : attempts <= 12 ? 'â­â­â­â­' : attempts <= 16 ? 'â­â­â­' : 'â­â­';
              document.getElementById('quizArea').innerHTML = `
                <div class="game-container">
                  <h3 style="text-align: center; color: var(--primary-color);">ğŸ‰ ÙÙˆØ² Ø±Ø§Ø¦Ø¹!</h3>
                  <div style="text-align: center; margin: 30px 0;">
                    <div style="font-size: 48px; color: #FFD700;">${stars}</div>
                    <div style="font-size: 24px; color: var(--success-color); margin: 20px 0;">
                      Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙŠ ${attempts} Ù…Ø­Ø§ÙˆÙ„Ø©
                    </div>
                  </div>
                  
                  <div style="text-align: center;">
                    <button class="btn-primary" onclick="startMatchingGame()">
                      <i class="fas fa-redo"></i> Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                    </button>
                  </div>
                </div>
              `;
            }
            
            firstSelection = null;
          }, 500);
        } else {
          // Ù…Ø·Ø§Ø¨Ù‚Ø© Ø®Ø§Ø·Ø¦Ø©
          setTimeout(() => {
            document.getElementById(`match-${firstSelection.index}`).classList.remove('selected');
            element.classList.remove('selected');
            firstSelection = null;
          }, 1000);
        }
      };
      
      window.resetMatchingGame = function() {
        startMatchingGame();
      };
    };
    
    // Ù„Ø¹Ø¨Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
    window.startListeningGame = function() {
      let allWords = [];
      for (const grade in allLessons) {
        allWords = allWords.concat(allLessons[grade].lessons);
      }
      
      if (allWords.length < 3) {
        document.getElementById('quizArea').innerHTML = `
          <div class="game-container">
            <h3 style="text-align: center; color: var(--primary-color);">Ù„Ø¹Ø¨Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹</h3>
            <p style="text-align: center; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ù„Ø¹Ø¨Ø©.</p>
          </div>
        `;
        return;
      }
      
      // Ø§Ø®ØªÙŠØ§Ø± 3 ÙƒÙ„Ù…Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
      const gameWords = [];
      const usedIndices = new Set();
      
      while (gameWords.length < 3 && gameWords.length < allWords.length) {
        const randomIndex = Math.floor(Math.random() * allWords.length);
        if (!usedIndices.has(randomIndex)) {
          gameWords.push(allWords[randomIndex]);
          usedIndices.add(randomIndex);
        }
      }
      
      let currentRound = 0;
      let score = 0;
      
      function playRound() {
        if (currentRound >= gameWords.length) {
          // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©
          const percentage = Math.round((score / gameWords.length) * 100);
          document.getElementById('quizArea').innerHTML = `
            <div class="game-container">
              <h3 style="text-align: center; color: var(--primary-color);">Ø§Ù†ØªÙ‡Øª Ù„Ø¹Ø¨Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ ğŸ§</h3>
              <div style="text-align: center; margin: 30px 0;">
                <div style="font-size: 48px; color: ${percentage >= 70 ? 'var(--success-color)' : 'var(--accent-color)'};">
                  ${score}/${gameWords.length}
                </div>
                <div style="margin: 20px 0;">
                  ${percentage >= 90 ? 'Ø£Ø°Ù† Ù…Ù…ØªØ§Ø²Ø©! ğŸ‘‚ğŸ¯' : 
                    percentage >= 70 ? 'Ø§Ø³ØªÙ…Ø§Ø¹ Ø¬ÙŠØ¯! ğŸ‘' : 
                    'ØªØ¯Ø±Ø¨ Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹. ğŸ§'}
                </div>
              </div>
              
              <div style="text-align: center;">
                <button class="btn-primary" onclick="startListeningGame()">
                  <i class="fas fa-redo"></i> Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                </button>
              </div>
            </div>
          `;
          return;
        }
        
        const word = gameWords[currentRound];
        
        document.getElementById('quizArea').innerHTML = `
          <div class="game-container">
            <h3 style="text-align: center; color: var(--primary-color);">Ù„Ø¹Ø¨Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹</h3>
            <p style="text-align: center; color: #666;">Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø© Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù†Ù‰ Ø§Ù„ØµØ­ÙŠØ­</p>
            
            <div style="text-align: center; margin: 30px 0;">
              <div style="margin: 20px 0;">
                <button class="btn-primary recording" onclick="playWordForListening('${word.en.replace(/'/g, "\\'")}')" 
                        style="padding: 15px 30px; font-size: 18px;">
                  <i class="fas fa-volume-up"></i> Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø©
                </button>
              </div>
              
              <div style="color: #666; margin: 20px 0;">
                Ø§Ù„Ø¬ÙˆÙ„Ø© ${currentRound + 1} Ù…Ù† ${gameWords.length}
              </div>
            </div>
            
            <div>
              ${getWrongAnswers(word.ar, allWords).map((answer, idx) => `
                <div class="game-option" onclick="checkListeningAnswer('${answer.replace(/'/g, "\\'")}', '${word.ar.replace(/'/g, "\\'")}')">
                  ${idx + 1}. ${answer}
                </div>
              `).join('')}
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
              <div class="score-display">
                Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}/${gameWords.length}
              </div>
              <button class="btn-warning" onclick="skipListeningRound()">
                <i class="fas fa-forward"></i> ØªØ®Ø·ÙŠ
              </button>
            </div>
          </div>
        `;
      }
      
      window.playWordForListening = function(word) {
        speakAdvanced(word, 'en');
      };
      
      window.checkListeningAnswer = function(selected, correct) {
        const options = document.querySelectorAll('.game-option');
        options.forEach(option => {
          const optionText = option.textContent.replace(/^\d+\.\s*/, '');
          if (optionText === correct) {
            option.classList.add('correct');
          }
          if (optionText === selected && selected !== correct) {
            option.classList.add('wrong');
          }
          option.style.pointerEvents = 'none';
        });
        
        if (selected === correct) {
          score++;
          showNotification('Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‘‚âœ…', 'success');
        } else {
          showNotification('Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø­Ø§ÙˆÙ„ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø£ÙƒØ«Ø±. ğŸ‘‚', 'error');
        }
        
        setTimeout(() => {
          currentRound++;
          playRound();
        }, 1500);
      };
      
      window.skipListeningRound = function() {
        currentRound++;
        playRound();
      };
      
      function getWrongAnswers(correctAnswer, allWords) {
        const answers = [correctAnswer];
        const usedIndices = new Set();
        
        // Ø¥ÙŠØ¬Ø§Ø¯ ÙƒÙ„Ù…Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
        const correctIndex = allWords.findIndex(w => w.ar === correctAnswer);
        if (correctIndex !== -1) usedIndices.add(correctIndex);
        
        while (answers.length < 4 && answers.length < allWords.length) {
          const randomIndex = Math.floor(Math.random() * allWords.length);
          if (!usedIndices.has(randomIndex)) {
            answers.push(allWords[randomIndex].ar);
            usedIndices.add(randomIndex);
          }
        }
        return answers.sort(() => Math.random() - 0.5);
      }
      
      playRound();
    };
    
    // Ù„Ø¹Ø¨Ø© Ø§Ù„ØªÙ‡Ø¬Ø¦Ø©
    window.startSpellingGame = function() {
      document.getElementById('quizArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">Ù„Ø¹Ø¨Ø© Ø§Ù„ØªÙ‡Ø¬Ø¦Ø© âœï¸</h3>
          <div style="text-align: center; margin: 20px 0;">
            <p>Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø¹Ø¯ Ø³Ù…Ø§Ø¹Ù‡Ø§:</p>
            <div id="spellingWord" class="challenge-word" style="color: var(--accent-color);">...</div>
          </div>
          
          <div style="text-align: center; margin: 20px 0;">
            <button class="btn-primary recording" onclick="playSpellingWord()" id="playSpellingBtn" 
                    style="padding: 15px 30px; font-size: 18px;">
              <i class="fas fa-volume-up"></i> Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø©
            </button>
          </div>
          
          <div style="margin: 20px 0;">
            <input type="text" id="spellingInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø© Ù‡Ù†Ø§ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©..." 
                   style="width: 100%; padding: 15px; font-size: 18px; text-align: center;">
          </div>
          
          <div style="text-align: center;">
            <button class="btn-success" onclick="checkSpelling()" style="padding: 15px 30px; font-size: 18px;">
              <i class="fas fa-check"></i> ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            </button>
            <button class="btn-warning" onclick="nextSpellingWord()" style="margin-top: 10px;">
              <i class="fas fa-forward"></i> ÙƒÙ„Ù…Ø© Ø£Ø®Ø±Ù‰
            </button>
          </div>
          
          <div id="spellingResult" style="margin-top: 20px;"></div>
          
          <div style="text-align: center; margin-top: 20px;">
            <div class="stats">
              <div class="stat-item">
                <div class="stat-value" id="spellingCorrect">0</div>
                <div class="stat-label">ØµØ­ÙŠØ­Ø©</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="spellingAttempts">0</div>
                <div class="stat-label">Ù…Ø­Ø§ÙˆÙ„Ø§Øª</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="spellingScore">0%</div>
                <div class="stat-label">Ø¯Ù‚Ø©</div>
              </div>
            </div>
          </div>
        </div>
      `;
      
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
      let spellingWords = [];
      let currentSpellingWord = null;
      let correctCount = 0;
      let attemptsCount = 0;
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
      for (const grade in allLessons) {
        spellingWords = spellingWords.concat(allLessons[grade].lessons);
      }
      
      if (spellingWords.length === 0) {
        document.getElementById('spellingWord').textContent = "Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª Ù…ØªØ§Ø­Ø©";
        return;
      }
      
      function getRandomSpellingWord() {
        return spellingWords[Math.floor(Math.random() * spellingWords.length)];
      }
      
      function updateSpellingStats() {
        document.getElementById('spellingCorrect').textContent = correctCount;
        document.getElementById('spellingAttempts').textContent = attemptsCount;
        const accuracy = attemptsCount > 0 ? Math.round((correctCount / attemptsCount) * 100) : 0;
        document.getElementById('spellingScore').textContent = `${accuracy}%`;
      }
      
      window.playSpellingWord = function() {
        if (!currentSpellingWord) {
          currentSpellingWord = getRandomSpellingWord();
          document.getElementById('spellingWord').textContent = currentSpellingWord.ar;
        }
        speakAdvanced(currentSpellingWord.en, 'en', { rate: 0.7 });
      };
      
      window.checkSpelling = function() {
        const userInput = document.getElementById('spellingInput').value.trim().toLowerCase();
        const correctWord = currentSpellingWord.en.toLowerCase();
        
        if (!userInput) {
          showNotification('Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø© Ø£ÙˆÙ„Ø§Ù‹!', 'warning');
          return;
        }
        
        attemptsCount++;
        
        if (userInput === correctWord) {
          correctCount++;
          document.getElementById('spellingResult').innerHTML = `
            <div class="pronunciation-good" style="text-align: center; padding: 15px;">
              <h4>ğŸ‰ ØµØ­ÙŠØ­Ø©!</h4>
              <p>Ø§Ù„ÙƒÙ„Ù…Ø©: <strong>${currentSpellingWord.en}</strong></p>
              <p>Ø§Ù„Ù…Ø¹Ù†Ù‰: ${currentSpellingWord.ar}</p>
              ${currentSpellingWord.ipa ? `<p>Ø§Ù„Ù†Ø·Ù‚: ${currentSpellingWord.ipa}</p>` : ''}
            </div>
          `;
          showNotification('ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø§Ù„ØªÙ‡Ø¬Ø¦Ø© ØµØ­ÙŠØ­Ø©! âœ¨', 'success');
        } else {
          document.getElementById('spellingResult').innerHTML = `
            <div class="pronunciation-needs-work" style="text-align: center; padding: 15px;">
              <h4>âŒ ØªØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†</h4>
              <p>Ø¥Ø¬Ø§Ø¨ØªÙƒ: <strong>${userInput}</strong></p>
              <p>Ø§Ù„ØµØ­ÙŠØ­Ø©: <strong>${currentSpellingWord.en}</strong></p>
              <p>Ø§Ù„Ù…Ø¹Ù†Ù‰: ${currentSpellingWord.ar}</p>
              <button class="btn-primary" onclick="playSpellingWord()" style="margin-top: 10px;">
                <i class="fas fa-volume-up"></i> Ø§Ø³ØªÙ…Ø¹ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
              </button>
            </div>
          `;
          showNotification('Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ’ª', 'error');
        }
        
        updateSpellingStats();
      };
      
      window.nextSpellingWord = function() {
        currentSpellingWord = getRandomSpellingWord();
        document.getElementById('spellingWord').textContent = currentSpellingWord.ar;
        document.getElementById('spellingInput').value = '';
        document.getElementById('spellingResult').innerHTML = '';
        speakAdvanced(currentSpellingWord.en, 'en', { rate: 0.7 });
      };
      
      // Ø¨Ø¯Ø¡ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
      currentSpellingWord = getRandomSpellingWord();
      document.getElementById('spellingWord').textContent = currentSpellingWord.ar;
      setTimeout(() => speakAdvanced(currentSpellingWord.en, 'en', { rate: 0.7 }), 1000);
    };
    
    // Ù„Ø¹Ø¨Ø© Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµØ­ÙŠØ­
    window.startPronunciationGame = function() {
      document.getElementById('quizArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">Ù„Ø¹Ø¨Ø© Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµØ­ÙŠØ­ ğŸ¤</h3>
          <div style="text-align: center; margin: 20px 0;">
            <p>Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø© Ø«Ù… ÙƒØ±Ø±Ù‡Ø§:</p>
            <div id="pronunciationGameWord" class="challenge-word" style="color: var(--primary-color);">Hello</div>
          </div>
          
          <div style="text-align: center; margin: 20px 0;">
            <button class="btn-primary recording" onclick="playPronunciationWord()" 
                    style="padding: 15px 30px; font-size: 18px;">
              <i class="fas fa-volume-up"></i> Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø©
            </button>
          </div>
          
          <div style="text-align: center; margin: 20px 0;">
            <button class="btn-danger" onclick="startPronunciationRecording()" id="pronunciationRecordBtn"
                    style="padding: 15px 30px; font-size: 18px;">
              <i class="fas fa-microphone"></i> Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            </button>
          </div>
          
          <div id="pronunciationGameResult" style="margin-top: 20px;"></div>
          
          <div style="text-align: center; margin-top: 20px;">
            <button class="btn-warning" onclick="nextPronunciationWord()">
              <i class="fas fa-forward"></i> ÙƒÙ„Ù…Ø© Ø£Ø®Ø±Ù‰
            </button>
          </div>
        </div>
      `;
      
      let pronunciationWords = [];
      let currentPronunciationWord = "Hello";
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
      for (const grade in allLessons) {
        pronunciationWords = pronunciationWords.concat(allLessons[grade].lessons.map(l => l.en));
      }
      
      if (pronunciationWords.length > 0) {
        currentPronunciationWord = pronunciationWords[Math.floor(Math.random() * pronunciationWords.length)];
        document.getElementById('pronunciationGameWord').textContent = currentPronunciationWord;
      }
      
      window.playPronunciationWord = function() {
        speakAdvanced(currentPronunciationWord, 'en', { accent: 'british', rate: 0.7 });
      };
      
      window.startPronunciationRecording = function() {
        if (!recognition) {
          showNotification('Ù…ÙŠØ²Ø© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ.', 'error');
          return;
        }
        
        const recordBtn = document.getElementById('pronunciationRecordBtn');
        
        if (isRecording) {
          recognition.stop();
          isRecording = false;
          recordBtn.innerHTML = '<i class="fas fa-microphone"></i> Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ø¬ÙŠÙ„';
          recordBtn.classList.remove('recording');
        } else {
          recognition.start();
          isRecording = true;
          recordBtn.innerHTML = '<i class="fas fa-stop-circle"></i> ØªÙˆÙ‚Ù ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…';
          recordBtn.classList.add('recording');
          
          // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
          recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript;
            evaluatePronunciationGame(currentPronunciationWord, transcript);
          };
        }
      };
      
      function evaluatePronunciationGame(correctWord, spokenWord) {
        const accuracy = calculatePronunciationAccuracy(spokenWord.toLowerCase(), correctWord.toLowerCase());
        const score = Math.max(70, Math.min(95, accuracy));
        
        const resultDiv = document.getElementById('pronunciationGameResult');
        resultDiv.innerHTML = `
          <div class="pronunciation-feedback ${score >= 80 ? 'pronunciation-good' : 'pronunciation-needs-work'}">
            <h4>ğŸ¤ Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ø·Ù‚</h4>
            <div style="font-size: 48px; font-weight: bold; color: ${score >= 85 ? '#2e7d32' : '#ef6c00'};">
              ${score}%
            </div>
            <p><strong>Ø§Ù„ÙƒÙ„Ù…Ø©:</strong> ${correctWord}</p>
            <p><strong>Ù†Ø·Ù‚Ùƒ:</strong> ${spokenWord}</p>
            <p><strong>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</strong> ${getPronunciationFeedback(score)}</p>
          </div>
        `;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø²Ø±
        document.getElementById('pronunciationRecordBtn').innerHTML = '<i class="fas fa-microphone"></i> Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ø¬ÙŠÙ„';
        document.getElementById('pronunciationRecordBtn').classList.remove('recording');
        isRecording = false;
      };
      
      window.nextPronunciationWord = function() {
        if (pronunciationWords.length > 0) {
          currentPronunciationWord = pronunciationWords[Math.floor(Math.random() * pronunciationWords.length)];
          document.getElementById('pronunciationGameWord').textContent = currentPronunciationWord;
          document.getElementById('pronunciationGameResult').innerHTML = '';
          setTimeout(() => speakAdvanced(currentPronunciationWord, 'en', { accent: 'british', rate: 0.7 }), 500);
        }
      };
      
      // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
      setTimeout(() => speakAdvanced(currentPronunciationWord, 'en', { accent: 'british', rate: 0.7 }), 1000);
    };
    
    // Ù„Ø¹Ø¨Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„Ø©
    window.startSentenceBuilder = function() {
      document.getElementById('quizArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">Ù„Ø¹Ø¨Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„Ø© ğŸ§©</h3>
          <div style="text-align: center; margin: 20px 0;">
            <p>Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:</p>
            <div id="sentencePuzzle" class="challenge-word" style="color: var(--accent-color);">
              Ø£Ù†Ø§ | Ø·Ø§Ù„Ø¨ | Ø¬Ø¯ÙŠØ¯ | Ø£Ù†Ø§ | ÙÙŠ | Ø§Ù„Ù…Ø¯Ø±Ø³Ø©
            </div>
          </div>
          
          <div style="margin: 30px 0; padding: 20px; background: #f5f5f5; border-radius: 10px;">
            <div id="wordTiles" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
              <!-- Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; min-height: 60px;" id="sentenceBuilder">
              <p style="text-align: center; color: #666;">Ø§Ø³Ø­Ø¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù‡Ù†Ø§ Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„Ø©</p>
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 20px;">
            <button class="btn-success" onclick="checkSentence()" style="padding: 15px 30px; font-size: 18px;">
              <i class="fas fa-check"></i> ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù…Ù„Ø©
            </button>
            <button class="btn-warning" onclick="resetSentenceBuilder()" style="margin-top: 10px;">
              <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø©
            </button>
          </div>
          
          <div id="sentenceResult" style="margin-top: 20px;"></div>
        </div>
      `;
      
      // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ù…Ù„
      const sentences = [
        {english: "I am a new student at school", arabic: "Ø£Ù†Ø§ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©", words: ["I", "am", "a", "new", "student", "at", "school"]},
        {english: "The book is on the table", arabic: "Ø§Ù„ÙƒØªØ§Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©", words: ["The", "book", "is", "on", "the", "table"]},
        {english: "She has two brothers", arabic: "Ù„Ø¯ÙŠÙ‡Ø§ Ø£Ø®ÙˆØ§Ù†", words: ["She", "has", "two", "brothers"]},
        {english: "We study English every day", arabic: "Ù†Ø­Ù† Ù†Ø¯Ø±Ø³ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙƒÙ„ ÙŠÙˆÙ…", words: ["We", "study", "English", "every", "day"]}
      ];
      
      let currentSentence = sentences[0];
      let selectedWords = [];
      
      function setupSentenceBuilder() {
        const wordTiles = document.getElementById('wordTiles');
        const sentenceBuilder = document.getElementById('sentenceBuilder');
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
        wordTiles.innerHTML = '';
        sentenceBuilder.innerHTML = '<p style="text-align: center; color: #666;">Ø§Ø³Ø­Ø¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù‡Ù†Ø§ Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„Ø©</p>';
        selectedWords = [];
        
        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        const shuffledWords = [...currentSentence.words].sort(() => Math.random() - 0.5);
        
        shuffledWords.forEach((word, index) => {
          const wordTile = document.createElement('div');
          wordTile.className = 'match-item';
          wordTile.textContent = word;
          wordTile.style.cursor = 'pointer';
          wordTile.dataset.word = word;
          wordTile.dataset.index = index;
          
          wordTile.onclick = function() {
            if (!this.classList.contains('used')) {
              this.classList.add('used');
              selectedWords.push(word);
              
              const sentenceDiv = document.getElementById('sentenceBuilder');
              if (sentenceDiv.querySelector('p')) {
                sentenceDiv.innerHTML = '';
              }
              
              const sentenceText = document.createElement('span');
              sentenceText.textContent = selectedWords.join(' ') + ' ';
              sentenceText.style.fontSize = '18px';
              sentenceText.style.fontWeight = 'bold';
              sentenceDiv.appendChild(sentenceText);
            }
          };
          
          wordTiles.appendChild(wordTile);
        });
        
        document.getElementById('sentencePuzzle').textContent = currentSentence.arabic;
      }
      
      window.checkSentence = function() {
        const userSentence = selectedWords.join(' ');
        const correctSentence = currentSentence.words.join(' ');
        
        const resultDiv = document.getElementById('sentenceResult');
        
        if (userSentence === correctSentence) {
          resultDiv.innerHTML = `
            <div class="pronunciation-good" style="text-align: center; padding: 15px;">
              <h4>ğŸ‰ ØµØ­ÙŠØ­Ø©!</h4>
              <p>Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: <strong>${correctSentence}</strong></p>
              <p>Ù…Ø¹Ù†Ø§Ù‡Ø§: ${currentSentence.arabic}</p>
              <button class="btn-primary" onclick="speakAdvanced('${correctSentence.replace(/'/g, "\\'")}', 'en')" style="margin-top: 10px;">
                <i class="fas fa-volume-up"></i> Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ø¬Ù…Ù„Ø©
              </button>
            </div>
          `;
          showNotification('Ù…Ù…ØªØ§Ø²! Ø§Ù„Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©! ğŸ¯', 'success');
        } else {
          resultDiv.innerHTML = `
            <div class="pronunciation-needs-work" style="text-align: center; padding: 15px;">
              <h4>âŒ ØªØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†</h4>
              <p>Ø¬Ù…Ù„ØªÙƒ: <strong>${userSentence || 'Ù„Ù… ØªØ¨Ù†ÙŠ Ø¬Ù…Ù„Ø© Ø¨Ø¹Ø¯'}</strong></p>
              <p>Ø§Ù„ØµØ­ÙŠØ­Ø©: <strong>${correctSentence}</strong></p>
              <p>Ù…Ø¹Ù†Ø§Ù‡Ø§: ${currentSentence.arabic}</p>
              <div style="margin-top: 10px;">
                <button class="btn-primary" onclick="showCorrectSentence()">
                  <i class="fas fa-eye"></i> Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                </button>
                <button class="btn-secondary" onclick="resetSentenceBuilder()" style="margin-left: 10px;">
                  <i class="fas fa-redo"></i> Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                </button>
              </div>
            </div>
          `;
          showNotification('Ø§Ù„Ø¬Ù…Ù„Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ’ª', 'error');
        }
      };
      
      window.showCorrectSentence = function() {
        const correctSentence = currentSentence.words.join(' ');
        const wordTiles = document.querySelectorAll('#wordTiles .match-item');
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª
        wordTiles.forEach(tile => {
          tile.classList.remove('used');
        });
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
        selectedWords = [...currentSentence.words];
        const sentenceDiv = document.getElementById('sentenceBuilder');
        sentenceDiv.innerHTML = '';
        
        const sentenceText = document.createElement('span');
        sentenceText.textContent = selectedWords.join(' ') + ' ';
        sentenceText.style.fontSize = '18px';
        sentenceText.style.fontWeight = 'bold';
        sentenceText.style.color = 'var(--success-color)';
        sentenceDiv.appendChild(sentenceText);
        
        // ØªØ¹Ù„ÙŠÙ… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
        currentSentence.words.forEach(word => {
          const wordTile = Array.from(wordTiles).find(tile => tile.dataset.word === word);
          if (wordTile) {
            wordTile.classList.add('used');
            wordTile.style.backgroundColor = 'var(--success-color)';
            wordTile.style.color = 'white';
          }
        });
        
        document.getElementById('sentenceResult').innerHTML = `
          <div class="pronunciation-good" style="text-align: center; padding: 15px;">
            <h4>Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©</h4>
            <p>Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ø¬Ù…Ù„Ø©:</p>
            <button class="btn-primary" onclick="speakAdvanced('${correctSentence.replace(/'/g, "\\'")}', 'en')">
              <i class="fas fa-volume-up"></i> ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¬Ù…Ù„Ø©
            </button>
          </div>
        `;
      };
      
      window.resetSentenceBuilder = function() {
        // Ø§Ø®ØªÙŠØ§Ø± Ø¬Ù…Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
        currentSentence = sentences[Math.floor(Math.random() * sentences.length)];
        setupSentenceBuilder();
        document.getElementById('sentenceResult').innerHTML = '';
      };
      
      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
      setupSentenceBuilder();
    };
    
    // ØªØ­Ø¯ÙŠ 60 Ø«Ø§Ù†ÙŠØ©
    window.startSpeedChallenge = function() {
      document.getElementById('quizArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">ØªØ­Ø¯ÙŠ 60 Ø«Ø§Ù†ÙŠØ© â±ï¸</h3>
          <div style="text-align: center; margin: 20px 0;">
            <p>Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ 60 Ø«Ø§Ù†ÙŠØ©!</p>
            <div class="challenge-timer" id="challengeTimer">60</div>
            <div class="challenge-word" id="challengeQuestion">Ù…Ø§ ØªØ±Ø¬Ù…Ø©: "Hello"ØŸ</div>
          </div>
          
          <div id="challengeOptions" style="margin: 30px 0;">
            <div class="game-option" onclick="challengeAnswer('Ù…Ø±Ø­Ø¨Ø§')">Ù…Ø±Ø­Ø¨Ø§</div>
            <div class="game-option" onclick="challengeAnswer('Ø´ÙƒØ±Ø§Ù‹')">Ø´ÙƒØ±Ø§Ù‹</div>
            <div class="game-option" onclick="challengeAnswer('Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø©')">Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø©</div>
            <div class="game-option" onclick="challengeAnswer('Ù…Ù† ÙØ¶Ù„Ùƒ')">Ù…Ù† ÙØ¶Ù„Ùƒ</div>
          </div>
          
          <div style="text-align: center; margin-top: 20px;">
            <div class="score-display">
              Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="challengeScore">0</span>
            </div>
            <button class="btn-danger" onclick="startChallengeTimer()" id="startChallengeBtn" 
                    style="padding: 15px 30px; font-size: 18px;">
              <i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠ
            </button>
          </div>
          
          <div id="challengeResult" style="margin-top: 20px;"></div>
        </div>
      `;
      
      let challengeWords = [];
      let currentChallengeWord = null;
      let challengeScore = 0;
      let timeLeft = 60;
      let timerInterval = null;
      let challengeActive = false;
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
      for (const grade in allLessons) {
        challengeWords = challengeWords.concat(allLessons[grade].lessons);
      }
      
      function getRandomChallengeWord() {
        if (challengeWords.length === 0) return null;
        return challengeWords[Math.floor(Math.random() * challengeWords.length)];
      }
      
      function updateChallengeQuestion() {
        currentChallengeWord = getRandomChallengeWord();
        if (!currentChallengeWord) return;
        
        document.getElementById('challengeQuestion').textContent = `Ù…Ø§ ØªØ±Ø¬Ù…Ø©: "${currentChallengeWord.en}"ØŸ`;
        
        // Ø¬Ù…Ø¹ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©
        const wrongAnswers = [];
        const usedIndices = new Set();
        const correctIndex = challengeWords.findIndex(w => w.en === currentChallengeWord.en);
        if (correctIndex !== -1) usedIndices.add(correctIndex);
        
        while (wrongAnswers.length < 3 && wrongAnswers.length < challengeWords.length - 1) {
          const randomIndex = Math.floor(Math.random() * challengeWords.length);
          if (!usedIndices.has(randomIndex)) {
            wrongAnswers.push(challengeWords[randomIndex].ar);
            usedIndices.add(randomIndex);
          }
        }
        
        const allAnswers = [currentChallengeWord.ar, ...wrongAnswers].sort(() => Math.random() - 0.5);
        
        const optionsDiv = document.getElementById('challengeOptions');
        optionsDiv.innerHTML = allAnswers.map(answer => `
          <div class="game-option" onclick="challengeAnswer('${answer.replace(/'/g, "\\'")}')">${answer}</div>
        `).join('');
      }
      
      window.startChallengeTimer = function() {
        if (challengeActive) return;
        
        challengeActive = true;
        challengeScore = 0;
        timeLeft = 60;
        
        document.getElementById('challengeScore').textContent = '0';
        document.getElementById('startChallengeBtn').innerHTML = '<i class="fas fa-play"></i> Ø¬Ø§Ø±ÙŠ...';
        document.getElementById('startChallengeBtn').disabled = true;
        document.getElementById('challengeResult').innerHTML = '';
        
        updateChallengeQuestion();
        
        timerInterval = setInterval(() => {
          timeLeft--;
          document.getElementById('challengeTimer').textContent = timeLeft;
          
          if (timeLeft <= 0) {
            endChallenge();
          }
        }, 1000);
      };
      
      window.challengeAnswer = function(selected) {
        if (!challengeActive || !currentChallengeWord) return;
        
        const options = document.querySelectorAll('#challengeOptions .game-option');
        options.forEach(option => {
          if (option.textContent === currentChallengeWord.ar) {
            option.classList.add('correct');
          }
          if (option.textContent === selected && selected !== currentChallengeWord.ar) {
            option.classList.add('wrong');
          }
          option.style.pointerEvents = 'none';
        });
        
        if (selected === currentChallengeWord.ar) {
          challengeScore++;
          document.getElementById('challengeScore').textContent = challengeScore;
        }
        
        setTimeout(() => {
          // ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙØ¦Ø§Øª
          options.forEach(option => {
            option.classList.remove('correct', 'wrong');
            option.style.pointerEvents = 'auto';
          });
          
          updateChallengeQuestion();
        }, 1000);
      };
      
      function endChallenge() {
        clearInterval(timerInterval);
        challengeActive = false;
        
        document.getElementById('startChallengeBtn').innerHTML = '<i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ø¯ÙŠ';
        document.getElementById('startChallengeBtn').disabled = false;
        
        let message = '';
        if (challengeScore >= 15) {
          message = 'Ù…Ø°Ù‡Ù„! Ø£Ù†Øª Ø³Ø±ÙŠØ¹ Ø¬Ø¯Ø§Ù‹! ğŸš€';
        } else if (challengeScore >= 10) {
          message = 'Ø±Ø§Ø¦Ø¹! Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²! â­';
        } else if (challengeScore >= 5) {
          message = 'Ø¬ÙŠØ¯! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ­Ø³Ù† Ø£ÙƒØ«Ø±. ğŸ’ª';
        } else {
          message = 'ØªØ¯Ø±Ø¨ Ø£ÙƒØ«Ø± ÙˆØ³ØªØªØ­Ø³Ù†! ğŸ“š';
        }
        
        document.getElementById('challengeResult').innerHTML = `
          <div class="pronunciation-good" style="text-align: center; padding: 15px;">
            <h4>Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! â°</h4>
            <div style="font-size: 48px; color: var(--primary-color); margin: 20px 0;">
              ${challengeScore} Ù†Ù‚Ø·Ø©
            </div>
            <p>${message}</p>
            <p>Ø£Ø¬Ø¨Øª Ø¹Ù„Ù‰ ${challengeScore} Ø³Ø¤Ø§Ù„ ÙÙŠ 60 Ø«Ø§Ù†ÙŠØ©</p>
          </div>
        `;
      }
      
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ÙˆÙ„
      updateChallengeQuestion();
    };
    
    // ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ====================
    window.startStoryGame = function() {
      document.getElementById('challengeArea').innerHTML = `
        <div class="story-container">
          <h3 style="text-align: center; color: var(--primary-color);">Ø§Ù„Ù‚ØµØµ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© ğŸ“–</h3>
          <p style="text-align: center; color: #666;">Ø¬Ø±Ø¨ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰!</p>
          <div style="text-align: center; margin-top: 20px;">
            <button class="btn-primary" onclick="showTab('tab1')">
              <i class="fas fa-language"></i> Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØ±Ø¬Ù…Ø©
            </button>
          </div>
        </div>
      `;
    };
    
    window.startPictureGame = function() {
      document.getElementById('challengeArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">ØªØ­Ø¯ÙŠ Ø§Ù„ØµÙˆØ± ğŸ“¸</h3>
          <p style="text-align: center; color: #666;">Ø¬Ø±Ø¨ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰!</p>
          <div style="text-align: center; margin-top: 20px;">
            <button class="btn-primary" onclick="showTab('tab1')">
              <i class="fas fa-language"></i> Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØ±Ø¬Ù…Ø©
            </button>
          </div>
        </div>
      `;
    };
    
    window.startFriendsChallenge = function() {
      document.getElementById('challengeArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">ØªØ­Ø¯ÙŠ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ğŸ¤</h3>
          <p style="text-align: center; color: #666;">Ø¬Ø±Ø¨ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰!</p>
          <div style="text-align: center; margin-top: 20px;">
            <button class="btn-primary" onclick="showTab('tab1')">
              <i class="fas fa-language"></i> Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØ±Ø¬Ù…Ø©
            </button>
          </div>
        </div>
      `;
    };
    
    window.showAchievements = function() {
      document.getElementById('challengeArea').innerHTML = `
        <div class="game-container">
          <h3 style="text-align: center; color: var(--primary-color);">Ø¬Ø¯Ø§Ø± Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ğŸ†</h3>
          <div id="achievementsList"></div>
        </div>
      `;
      updateAchievementsWall();
    };
    
    // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
    window.showLifeCategory = function(categoryId) {
      const category = dailyLifeCategories[categoryId];
      if (!category) return;
      
      const container = document.getElementById('lifeCategoryContent');
      container.innerHTML = `
        <div class="card">
          <h4><i class="${category.icon}"></i> ${category.name}</h4>
          <div class="unit-lessons">
            ${category.phrases.map(phrase => `
              <div class="lesson-card" onclick="speakAdvanced('${phrase.en.replace(/'/g, "\\'")}', 'en')">
                <div style="font-weight: bold; color: var(--primary-color);">${phrase.en}</div>
                <div style="font-size: 14px; color: #666;">${phrase.ar}</div>
                <div class="ipa-transcription">${phrase.pronunciation}</div>
              </div>
            `).join('')}
          </div>
          <div style="text-align: center; margin-top: 15px;">
            <button class="btn-primary" onclick="practiceCategory('${categoryId}')">
              <i class="fas fa-play-circle"></i> ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…
            </button>
          </div>
        </div>
      `;
    };
    
    function practiceCategory(categoryId) {
      const category = dailyLifeCategories[categoryId];
      if (!category) return;
      
      document.getElementById('textInput').value = category.phrases[0].en;
      showNotification(`ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø¬Ù…Ù„Ø©: "${category.phrases[0].en}"`, 'info');
      showTab('tab1');
      speakAdvanced(category.phrases[0].en, 'en');
    }
    
    // Ø¯ÙˆØ§Ù„ Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
    window.generateReport = generateReport;
    
    // Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
    function loadParentDashboard() {
      updateParentDashboard();
    }
    
    function updateParentDashboard() {
      // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ø§Ù„Ø¨
      const levelNames = ['Ù…Ø¨ØªØ¯Ø¦', 'Ù…ØªÙˆØ³Ø·', 'Ù…ØªÙ‚Ø¯Ù…', 'Ù…ØªÙ…ÙŠØ²', 'Ø®Ø¨ÙŠØ±'];
      const levelIndex = Math.min(levelNames.length - 1, Math.floor(userData.avatar.level / 2));
      document.getElementById('parentLevel').textContent = levelNames[levelIndex];
      document.getElementById('parentLevelBar').style.width = `${(userData.avatar.level / 10) * 100}%`;
      
      // Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      document.getElementById('studyTime').textContent = `${userData.studyTime} Ø³Ø§Ø¹Ø©`;
      document.getElementById('lastVisit').textContent = userData.lastVisit ? 
        new Date(userData.lastVisit).toLocaleDateString('ar-SA') : 'Ø§Ù„ÙŠÙˆÙ…';
      
      // Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©
      const achievementsContainer = document.getElementById('recentAchievements');
      if (achievementsContainer) {
        const recentAchievements = userData.achievements.slice(-3).reverse();
        if (recentAchievements.length === 0) {
          achievementsContainer.innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø¨Ø¹Ø¯</p>';
        } else {
          achievementsContainer.innerHTML = recentAchievements.map(achievement => `
            <div class="achievement-badge" style="margin: 2px; font-size: 10px;">
              ${achievement}
            </div>
          `).join('');
        }
      }
      
      // Ø§Ù„ØªÙˆØµÙŠØ§Øª
      const recommendationsContainer = document.getElementById('parentRecommendations');
      if (recommendationsContainer) {
        const recommendations = [];
        
        if (userData.mistakes.grammar.length > 5) {
          recommendations.push('ÙŠØ±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù†Ø­ÙˆÙŠØ©');
        }
        if (userData.pronunciationScore < 70) {
          recommendations.push('ÙŠØªØ¯Ø±Ø¨ Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø·Ù‚');
        }
        if (userData.streak < 3) {
          recommendations.push('ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ø§Ù†ØªØ¸Ø§Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ø¯Ø±Ø§Ø³Ø©');
        }
        if (userData.learnedWords.length < 20) {
          recommendations.push('ÙŠØ²ÙŠØ¯ Ù…Ù† Ù…ÙØ±Ø¯Ø§ØªÙ‡');
        }
        if (recommendations.length === 0) {
          recommendations.push('ÙŠÙˆØ§ØµÙ„ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ù…ØªØ§Ø²');
        }
        
        recommendationsContainer.innerHTML = recommendations.map(rec => `
          <div style="margin: 5px 0; padding: 8px; background: #e8f5e9; border-radius: 5px; border-right: 3px solid var(--success-color);">
            <i class="fas fa-check-circle" style="color: var(--success-color);"></i>
            ${rec}
          </div>
        `).join('');
      }
      
      // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³Ø©
      const scheduleContainer = document.getElementById('studySchedule');
      if (scheduleContainer) {
        const schedule = [
          {day: 'Ø§Ù„Ø£Ø­Ø¯', activity: 'Ù…ÙØ±Ø¯Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© + Ù†Ø·Ù‚', time: '30 Ø¯Ù‚ÙŠÙ‚Ø©'},
          {day: 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', activity: 'Ù‚ÙˆØ§Ø¹Ø¯ + Ù…Ø­Ø§Ø¯Ø«Ø§Øª', time: '30 Ø¯Ù‚ÙŠÙ‚Ø©'},
          {day: 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', activity: 'Ù…Ø±Ø§Ø¬Ø¹Ø© + Ø£Ù„Ø¹Ø§Ø¨', time: '20 Ø¯Ù‚ÙŠÙ‚Ø©'},
          {day: 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', activity: 'Ù‚Ø±Ø§Ø¡Ø© + Ø§Ø³ØªÙ…Ø§Ø¹', time: '30 Ø¯Ù‚ÙŠÙ‚Ø©'},
          {day: 'Ø§Ù„Ø®Ù…ÙŠØ³', activity: 'ÙƒØªØ§Ø¨Ø© + ØªØ­Ø¯ÙŠØ§Øª', time: '30 Ø¯Ù‚ÙŠÙ‚Ø©'},
          {day: 'Ø§Ù„Ø¬Ù…Ø¹Ø©', activity: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©', time: '40 Ø¯Ù‚ÙŠÙ‚Ø©'},
          {day: 'Ø§Ù„Ø³Ø¨Øª', activity: 'Ø±Ø§Ø­Ø© + Ù†Ø´Ø§Ø· Ù…Ù…ØªØ¹', time: '20 Ø¯Ù‚ÙŠÙ‚Ø©'}
        ];
        
        scheduleContainer.innerHTML = schedule.map(item => `
          <div style="display: flex; justify-content: space-between; padding: 8px; margin: 5px 0; background: #f9f9f9; border-radius: 5px;">
            <div><strong>${item.day}</strong></div>
            <div>${item.activity}</div>
            <div style="color: var(--accent-color);">${item.time}</div>
          </div>
        `).join('');
      }
    }
    
    function generateReport() {
      const report = `
        ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨
        =================
        
        Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${document.getElementById('parentLevel').textContent}
        Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆÙ‚Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø©: ${userData.studyTime} Ø³Ø§Ø¹Ø©
        Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©: ${userData.streak} ÙŠÙˆÙ…
        
        Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:
        - Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªØ¹Ù„Ù…Ø©: ${userData.learnedWords.length}
        - Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø·Ù‚: ${userData.pronunciationScore}%
        - Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª: ${userData.achievements.length}
        - Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©: ${userData.customWords.filter(word => word.category === 'Ù…ØªØ±Ø¬Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ').length}
        
        Ø§Ù„ØªÙˆØµÙŠØ§Øª:
        ${getRecommendationsText()}
        
        ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}
      `;
      
      showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±! ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø®Ù‡ ÙˆØ­ÙØ¸Ù‡.', 'success');
      
      // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙŠ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø©
      const reportWindow = window.open('', '_blank');
      reportWindow.document.write(`
        <html dir="rtl">
        <head>
          <title>ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
            h1 { color: #1565c0; }
            pre { background: #f5f5f5; padding: 20px; border-radius: 5px; }
            .print-btn { background: #4caf50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 20px 0; }
          </style>
        </head>
        <body>
          <h1>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨</h1>
          <pre>${report}</pre>
          <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
          <button class="print-btn" onclick="window.close()" style="background: #f44336;">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
        </body>
        </html>
      `);
    }
    
    function getRecommendationsText() {
      const recommendations = [];
      
      if (userData.mistakes.grammar.length > 5) {
        recommendations.push('Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù†Ø­ÙˆÙŠØ©');
      }
      if (userData.pronunciationScore < 70) {
        recommendations.push('Ø§Ù„ØªØ¯Ø±Ø¨ Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø·Ù‚');
      }
      if (userData.streak < 3) {
        recommendations.push('Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù… ÙÙŠ Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹');
      }
      if (userData.learnedWords.length < 20) {
        recommendations.push('Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª');
      }
      if (recommendations.length === 0) {
        recommendations.push('Ù…ÙˆØ§ØµÙ„Ø© Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ù…ØªØ§Ø²');
      }
      
      return recommendations.map(rec => `  â€¢ ${rec}`).join('\n');
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯Ø§Ø± Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
    function updateAchievementsWall() {
      const container = document.getElementById('achievementsContent') || 
                       document.getElementById('achievementsList');
      
      if (!container) return;
      
      const totalWords = userData.learnedWords.length + userData.customWords.length;
      const challengeWins = userData.challengeScores ? 
        Object.values(userData.challengeScores).filter(score => score >= 8).length : 0;
      
      container.innerHTML = achievementsData.map(achievement => {
        let unlocked = false;
        
        if (achievement.requirement.includes('words>=')) {
          const required = parseInt(achievement.requirement.split('>=')[1]);
          unlocked = totalWords >= required;
        } else if (achievement.requirement.includes('pronunciation>=')) {
          const required = parseInt(achievement.requirement.split('>=')[1]);
          unlocked = userData.pronunciationScore >= required;
        } else if (achievement.requirement.includes('streak>=')) {
          const required = parseInt(achievement.requirement.split('>=')[1]);
          unlocked = userData.streak >= required;
        } else if (achievement.requirement.includes('customWords>=')) {
          const required = parseInt(achievement.requirement.split('>=')[1]);
          unlocked = userData.customWords.length >= required;
        } else if (achievement.requirement.includes('challenges>=')) {
          const required = parseInt(achievement.requirement.split('>=')[1]);
          unlocked = challengeWins >= required;
        }
        
        const isInUserAchievements = userData.achievements.includes(achievement.name);
        if (unlocked && !isInUserAchievements) {
          userData.achievements.push(achievement.name);
          saveUserData();
        }
        
        return `
          <div class="achievement-card ${unlocked ? '' : 'locked'}">
            <div class="achievement-icon">
              <i class="${achievement.icon}"></i>
            </div>
            <h4>${achievement.name}</h4>
            <p style="font-size: 12px; color: #666;">${achievement.description}</p>
            <div style="margin-top: 10px;">
              <span style="font-size: 11px; color: ${unlocked ? 'var(--success-color)' : '#999'}">
                ${unlocked ? `ğŸ† ${achievement.reward}` : 'ØºÙŠØ± Ù…ÙØªÙˆØ­'}
              </span>
            </div>
          </div>
        `;
      }).join('');
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†
    function loadLeaderboard() {
      const container = document.getElementById('leaderboardContent');
      if (!container) return;
      
      // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†
      const leaderboardData = [
        {name: "Ø£Ù†Øª", score: userData.pronunciationScore + (userData.learnedWords.length * 2), level: userData.avatar.level}
      ].sort((a, b) => b.score - a.score);
      
      container.innerHTML = leaderboardData.map((player, index) => `
        <div class="leaderboard-item">
          <div class="leaderboard-rank">${index + 1}</div>
          <div style="flex-grow: 1;">
            <strong>${player.name}</strong>
            ${player.name === "Ø£Ù†Øª" ? ' <span class="achievement-badge" style="font-size: 10px; padding: 1px 5px;">Ø£Ù†Øª</span>' : ''}
            <div style="font-size: 12px; color: #666;">
              Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${player.level} | ${player.score} Ù†Ù‚Ø·Ø©
            </div>
          </div>
          <div style="color: ${index < 3 ? '#FFD700' : '#666'}; font-size: 20px;">
            ${index === 0 ? 'ğŸ‘‘' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : 'ğŸ…'}
          </div>
        </div>
      `).join('');
    }
    
    // ==================== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ====================
    
    window.onload = initApp;
    
    // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
    window.showTab = showTab;
    window.speakText = speakText;
    window.speakSlowly = speakSlowly;
    window.translateText = translateText;
    window.translateWithLocalDatabase = translateWithLocalDatabase;
    window.translateLongText = translateLongText;
    window.addTranslationToVocabulary = addTranslationToVocabulary;
    window.analyzeText = analyzeText;
    window.showLessonDetail = showLessonDetail;
    window.speakWithBritishAccent = speakWithBritishAccent;
    window.startSpeechPractice = startSpeechPractice;
    window.startPhoneticsDrill = startPhoneticsDrill;
    window.updateVoiceSettings = updateVoiceSettings;
    window.selectBritishAccent = selectBritishAccent;
    window.comparePronunciation = comparePronunciation;
    window.toggleLearned = toggleLearned;
    window.addToVocabulary = addToVocabulary;
    window.addNewWord = addNewWord;
    window.clearNewWord = clearNewWord;
    window.suggestRandomWord = suggestRandomWord;
    window.editCustomWord = editCustomWord;
    window.deleteCustomWord = deleteCustomWord;
    window.searchLessons = searchLessons;
    window.playConversation = playConversation;
    window.practiceConversation = practiceConversation;
    
    // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    window.startPronunciationTest = startPronunciationTest;
    window.nextTestWord = nextTestWord;
    window.testRandomWord = testRandomWord;
    window.translateIraqi = translateIraqi;
    window.speakIraqiTranslation = speakIraqiTranslation;
    window.explainWord = explainWord;
    window.explainSongWords = explainSongWords;
    window.highlightPronunciation = highlightPronunciation;
    window.selectProfession = selectProfession;
    window.askAI = askAI;
    window.voiceAskAI = voiceAskAI;
    window.askExample = askExample;
    window.askPractice = askPractice;
    
    // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨
    window.startSentenceBuilder = startSentenceBuilder;
    window.startSpeedChallenge = startSpeedChallenge;
    window.startQuiz = startQuiz;
    window.startMatchingGame = startMatchingGame;
    window.startListeningGame = startListeningGame;
    window.startSpellingGame = startSpellingGame;
    window.startPronunciationGame = startPronunciationGame;
    
    // Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª
    window.startStoryGame = startStoryGame;
    window.startPictureGame = startPictureGame;
    window.startFriendsChallenge = startFriendsChallenge;
    window.showAchievements = showAchievements;
    
    // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
    window.showLifeCategory = showLifeCategory;
    
    // Ø¯ÙˆØ§Ù„ Ù„ÙˆØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
    window.generateReport = generateReport;
  </script>
</body>
</html>
